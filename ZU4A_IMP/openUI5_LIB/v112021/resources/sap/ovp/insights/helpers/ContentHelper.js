/*!
 * Copyright (c) 2009-2014 SAP SE, All Rights Reserved
 */
sap.ui.define(["sap/ovp/insights/helpers/Batch"],function(t){"use strict";var r={formatDate:"sap.ovp.cards.AnnotationHelper.formatDate",formatColor:"sap.ovp.cards.AnnotationHelper.formatColor",formatCurrency:"sap.ovp.cards.AnnotationHelper.formatCurrency",formatNumberCalculation:"sap.ovp.cards.AnnotationHelper.formatNumberCalculation"};function e(t){if(t===null||t===undefined){return}if(t.indexOf("{")!==-1){return t}return"{"+t+"}"}function a(r,e){if(!r){return{path:t.getBatchRequestPath("/d/results",e)}}return{path:t.getBatchRequestPath("/content/d/results",e)}}function n(t){if(t&&typeof t==="string"&&t.length>0){return t.startsWith("{")&&t.endsWith("}")}return false}function o(t){if(t&&typeof t==="string"&&t.length>0){return t.startsWith("{=")&&t.endsWith("}")}return false}function i(t,r){var e;if(o(t)){return t}if(n(t)){e="$"+t}else{e="'"+t+"'"}return"{= extension.formatters.formatCriticality("+e+", '"+r+"')}"}function f(t,r,a,n){if(!t||!r){return null}try{var o=t.getBindingInfo(r);var i;if(o){if(o.formatter&&o.formatter.name==="formatCurrency"){var f=t.getBindingInfo("unit");i=u(o,n,f);return a?i:e(i)}if(o.parts&&o.parts.length){i=o.parts.length===1?u(o):u(o,n);return a?i:e(i)}i=t.getBindingPath(r);return a?i:e(i)}else{return t.getProperty(r)}}catch(t){return}}function s(t){var r=[];if(Array.isArray(t)){t.forEach(function(t){r.push("${"+t+"}")})}return r.join()}function u(t,e,a){var n=[],o,i,f,u=false,l=false;var m,c;if(t&&t.parts){t.parts.forEach(function(t){if(t.path){if(t.model==="@i18n"&&e){e[t.path]={value:"{{"+t.path+"}}"};n.push("parameters>/"+t.path+"/value");l=true}else{n.push(t.path)}}if(t.model==="ovpCardProperties"&&t.value){f=t.value.functionName;if(t.value.dateFormat){i=t.value.dateFormat;i.bUTC=t.value.bUTC||false}else{i=t.value}}else if(t.model==="@i18n"){u=true}});if(n.length===1){o=n[0]}if(t.type&&t.type.oFormat){t.formatter={name:"formatter",textFragments:[0]};i=t.type.oFormat.oFormatOptions}if(t.formatter&&t.formatter.textFragments!==true){var p=null;if(i){var h=Object.assign({},i);delete h.functionName;p=JSON.stringify(h).replaceAll('"',"'")}switch(f){case r.formatDate:if(!o){return"{= extension.formatters.formatDate("+s(n)+", "+p+")}"}return"{= extension.formatters.formatDate(${"+o+"}, "+p+")}";case r.formatColor:if(!o){return"{= extension.formatters.formatValueColor("+s(n)+","+JSON.stringify(i)+")}"}return"{= extension.formatters.formatValueColor(${"+o+"},"+JSON.stringify(i)+")}";case r.formatCurrency:a&&a.parts.forEach(function(t){n.push(t.path)});var g=n.length===4;return"{= extension.formatters.formatCurrency("+p+","+g+","+s(n)+")}";case r.formatNumberCalculation:var m=t.formatter.textFragments||[0];c=JSON.stringify(m).replaceAll('"',"'");return"{= extension.formatters.formatNumber("+p+","+c+","+s(n)+")}";default:var c=null;if(t.formatter.textFragments){c=JSON.stringify(t.formatter.textFragments).replaceAll('"',"'");return"{= extension.formatters.formatNumber("+p+","+c+","+s(n)+")}"}}}if(u&&!l){return"{{"+o+"}}"}return o}}function l(r,e){var a="";if(r){a=t.getBatchResultCount("/content/d/__count",e)}else{a=t.getBatchResultCount("/d/__count",e)}return{text:"{= ${"+a+"} === '0' ? '' : extension.formatters.formatHeaderCount( ${"+a+"}) }"}}return{getHeaderStatus:l,addBrackets:e,buildValueStateExpression:i,getBindingPathOrValue:f,getData:a,isAnExpression:o}});
//# sourceMappingURL=ContentHelper.js.map