/*!
 * Copyright (c) 2009-2014 SAP SE, All Rights Reserved
 */
sap.ui.define(["sap/ovp/app/NavigationHelper","sap/ovp/cards/CommonUtils","sap/ovp/cards/NavigationHelper","sap/ovp/app/OVPLogger"],function(e,t,a,r){"use strict";var n=new r("OVP.insights.helpers.CardAction");return{getCardActions:function(r,i){var o={header:{enabled:false,actions:[]},content:{enabled:false,actions:[]}};var s=false,c=false;var m=r.view;var p=m.getController();if(r.cardComponentName==="Analytical"){c=!a.checkHeaderNavigationDisabledForAnalyticalCard(p.getCardPropertiesModel())}s=e.bCheckNavigationForCard(p);if(!s){return Promise.resolve(o)}var l=e.getNavigationParameters(p,r);return l.then(function(e){if(e===undefined){return o}if(r.cardComponentName==="List"||r.cardComponentName==="Table"){c=e["semanticObject"]&&e["action"]}var a={ibnTarget:{},ibnParams:{}};var n={type:"Navigation"};var s={type:"Navigation"};if(e&&e.type==="url"){a={type:"Navigation",parameters:{target:"_self"}};t.updatePropertyValueForObject(a.parameters,e.url,"url")}else{if(e.semanticObject||e.action||e.staticParams){a.ibnTarget={semanticObject:e.semanticObject,action:e.action};if(!i.configuration.parameters.state&&r.cardComponentName==="Analytical"){i.configuration.parameters.state={value:""}}var m=[];if(e.staticParams){if(e.staticParams.sNavPresentationVariant){a.ibnParams.presentationVariant=e.staticParams.sNavPresentationVariant}if(e.staticParams.sensitiveProperties){m=e.staticParams.sensitiveProperties}var p=e.staticParams.staticPropertyMap;var l=p&&Object.keys(p)||[];for(var u=0;u<l.length;u++){if(l[u]&&p[l[u]]&&!m.includes(l[u])){a.ibnParams[l[u]]=p[l[u]]}}}a.sensitiveProps=m}}o.content.enabled=true;o.content.actions.push(s);if(c){o.header.enabled=true;o.header.actions.push(n)}if(r.cardComponentName==="Analytical"){t.updatePropertyValueForObject(n,"{= extension.formatters.getNavigationContext(${parameters>/state/value})}","parameters");t.updatePropertyValueForObject(s,"{= extension.formatters.getNavigationContext(${parameters>/state/value}, ${})}","parameters");i.configuration.parameters.state.value=JSON.stringify(a)}else{if(a.ibnTarget["semanticObject"]&&a.ibnTarget["action"]){t.updatePropertyValueForObject(n,"{= extension.formatters.getNavigationContext(${parameters>/headerState/value})}","parameters");i.configuration.parameters.headerState={value:""};i.configuration.parameters.headerState.value=JSON.stringify(a);e["lineItemSemanticObject"]=e["lineItemSemanticObject"]||a.ibnTarget["semanticObject"];e["lineItemAction"]=e["lineItemAction"]||a.ibnTarget["action"]}if(e["lineItemSemanticObject"]&&e["lineItemAction"]){a.ibnTarget["semanticObject"]=e["lineItemSemanticObject"];a.ibnTarget["action"]=e["lineItemAction"];t.updatePropertyValueForObject(s,"{= extension.formatters.getNavigationContext(${parameters>/lineItemState/value}, ${})}","parameters");i.configuration.parameters.lineItemState={value:""};i.configuration.parameters.lineItemState.value=JSON.stringify(a)}}return o}).catch(function(e){n.error(e)})},checkCustomNavigationForCard:function(e){var t=e&&e.cardComponentData.settings,a=t&&!!t.customParams,r=e&&e.view.getController(),n=r&&r.oCardComponentData&&r.oCardComponentData.mainComponent,i=n&&!!n.doCustomNavigation;return a||i},getOVPDefaultActions:function(e){var t={ibnTarget:{semanticObject:e.semanticObject,action:e.action},ibnParams:{},sensitiveProps:[]};return JSON.stringify(t)}}},true);
//# sourceMappingURL=CardAction.js.map