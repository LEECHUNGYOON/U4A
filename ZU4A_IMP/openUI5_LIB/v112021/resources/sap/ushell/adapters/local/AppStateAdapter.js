// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/services/appstate/AppStatePersistencyMethod","sap/ui/thirdparty/jquery","sap/base/Log"],function(e,jQuery,t){"use strict";var r=function(e,t,r){this._oConfig=r&&r.config};r.prototype._getPersonalizationService=function(){return sap.ushell.Container.getServiceAsync("PersonalizationV2")};r.prototype.saveAppState=function(e,r,n,o,s,a,i){var c=new jQuery.Deferred;this._getPersonalizationService().then(function(r){r.createEmptyContainer(e,{keyCategory:r.constants.keyCategory.GENERATED_KEY,writeFrequency:r.constants.writeFrequency.HIGH,clientStorageAllowed:false}).then(function(e){e.setItemValue("appStateData",n);e.setItemValue("persistencyMethod",a);e.setItemValue("persistencySettings",i);e.setItemValue("createdBy",sap.ushell.Container&&sap.ushell.Container.getUser&&sap.ushell.Container.getUser().getId());e.save().then(function(){c.resolve()}).catch(function(e){c.reject(e);t.error(e)})}).catch(function(e){t.error(e);c.reject(e)})});return c.promise()};r.prototype.loadAppState=function(r){var n=new jQuery.Deferred,o=this;this._getPersonalizationService().then(function(s){s.getContainer(r,{keyCategory:s.constants.keyCategory.GENERATED_KEY,writeFrequency:s.constants.writeFrequency.HIGH,clientStorageAllowed:false}).then(function(t){var s=t.getItemValue("appStateData"),a=t.getItemValue("persistencyMethod"),i=t.getItemValue("persistencySettings"),c=t.getItemValue("createdBy");if(a===undefined){n.resolve(r,s)}else if(a===e.PersonalState){if(o.getCurrentUserForTesting()===""||o.getCurrentUserForTesting()===c){n.resolve(r,s,a,i)}else{n.reject("Unauthorized User ID")}}}).catch(function(e){t.error(e);n.reject(e)})});return n.promise()};r.prototype.deleteAppState=function(e){var r=new jQuery.Deferred;this._getPersonalizationService().then(function(n){n.deleteContainer(e).then(function(){r.resolve()}).catch(function(e){t.error(e);r.reject(e)})});return r.promise()};r.prototype.getCurrentUserForTesting=function(){return""};r.prototype.getSupportedPersistencyMethods=function(){return[]};return r},false);
//# sourceMappingURL=AppStateAdapter.js.map