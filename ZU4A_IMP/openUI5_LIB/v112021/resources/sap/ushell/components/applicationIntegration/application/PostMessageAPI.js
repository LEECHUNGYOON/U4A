// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/i18n/Formatting","sap/base/i18n/Localization","sap/ushell/utils","sap/ui/core/library","sap/ui/thirdparty/jquery","sap/base/Log","sap/ui/core/UIComponent","sap/ushell/services/AppConfiguration","sap/ushell/EventHub","sap/ushell/components/applicationIntegration/application/PostMessageAPIInterface","sap/ui/thirdparty/URI","sap/base/util/deepExtend","sap/ushell/Config","sap/ushell/utils/UrlParsing","sap/ui/core/Core","sap/m/Button","sap/m/library","sap/ui/thirdparty/hasher","sap/ushell/resources","sap/ushell/ui/shell/ShellHeadItem","sap/ui/core/Configuration","sap/base/util/uid"],function(e,t,r,n,jQuery,a,o,s,i,l,c,u,p,d,g,f,v,h,y,C,S,m){"use strict";var D="sap.ushell.";var b=new o;var A=v.URLHelper;var M={"sap.ushell.services.CrossApplicationNavigation":{oServiceCalls:{hrefForExternal:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(r){r.hrefForExternalAsync(e.oMessageData.body.oArgs,undefined,true).then(t.resolve,t.reject)});return t.promise()}},getSemanticObjectLinks:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(r){r.getSemanticObjectLinks(e.oMessageData.body.sSemanticObject,e.oMessageData.body.mParameters,e.oMessageData.body.bIgnoreFormFactors,undefined,undefined,e.oMessageData.body.bCompactIntents).then(t.resolve,t.reject)});return t.promise()}},isIntentSupported:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(r){r.isIntentSupported(e.oMessageData.body.aIntents).then(t.resolve,t.reject)});return t.promise()}},isNavigationSupported:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(r){r.isNavigationSupported(e.oMessageData.body.aIntents).then(t.resolve,t.reject)});return t.promise()}},backToPreviousApp:{executeServiceCallFn:function(){sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(e){e.backToPreviousApp()});return(new jQuery.Deferred).resolve().promise()}},historyBack:{executeServiceCallFn:function(e){sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(t){t.historyBack(e.oMessageData.body.iSteps)});return(new jQuery.Deferred).resolve().promise()}},getAppStateData:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(r){r.getAppStateData(e.oMessageData.body.sAppStateKey).then(t.resolve,t.reject)});return t.promise()}},toExternal:{executeServiceCallFn:function(e){var t=new jQuery.Deferred,n=u({},e.oMessageData.body.oArgs);r.storeSapSystemToLocalStorage(n);sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(e){e.toExternal(n).then(t.resolve,t.reject)});return t.promise()}},registerBeforeAppCloseEvent:{executeServiceCallFn:function(e){e.oContainer.setProperty("beforeAppCloseEvent",{enabled:true,params:e.oMessageData.body},true);return(new jQuery.Deferred).resolve().promise()}},expandCompactHash:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(r){r.expandCompactHash(e.oMessageData.body.sHashFragment).then(t.resolve,t.reject)});return t.promise()}},getDistinctSemanticObjects:{executeServiceCallFn:function(){var e=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(t){t.getDistinctSemanticObjects().then(e.resolve,e.reject)});return e.promise()}},getLinks:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(r){r.getLinks(e.oMessageData.body).then(t.resolve,t.reject)});return t.promise()}},getPrimaryIntent:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(r){r.getPrimaryIntent(e.oMessageData.body.sSemanticObject,e.oMessageData.body.mParameters).then(t.resolve,t.reject)});return t.promise()}},hrefForAppSpecificHash:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(r){r.hrefForAppSpecificHashAsync(e.oMessageData.body.sAppHash).then(t.resolve,t.reject)});return t.promise()}},isInitialNavigation:{executeServiceCallFn:function(){var e=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(t){t.isInitialNavigationAsync().then(function(t){e.resolve(t)})});return e.promise()}},getAppState:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(r){r.getAppState(b,e.oMessageData.body.sAppStateKey).done(function(e){delete e._oServiceInstance;t.resolve(e)})});return t.promise()}},setInnerAppRoute:{executeServiceCallFn:function(e){var t=d.parseShellHash(h.getHash()),r;if(t.appSpecificRoute===e.oMessageData.body.appSpecificRoute){return(new jQuery.Deferred).resolve().promise()}t.appSpecificRoute=e.oMessageData.body.appSpecificRoute;r="#"+d.constructShellHash(t);h.disableBlueBoxHashChangeTrigger=true;if(e.oMessageData.body.writeHistory===true||e.oMessageData.body.writeHistory==="true"){h.setHash(r)}else{h.replaceHash(r)}h.disableBlueBoxHashChangeTrigger=false;return(new jQuery.Deferred).resolve().promise()}},setInnerAppStateData:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;I.prototype._createNewInnerAppState(e).then(t.resolve);return t.promise()}},resolveIntent:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(r){r.resolveIntent(e.oMessageData.body.sHashFragment).then(t.resolve,t.reject)});return t.promise()}}}},"sap.ushell.ui5service.ShellUIService":{oServiceCalls:{setTitle:{executeServiceCallFn:function(e){return(new jQuery.Deferred).resolve(e.oContainer.getShellUIService().setTitle(e.oMessageData.body.sTitle)).promise()}},setBackNavigation:{executeServiceCallFn:function(e){var t;if(e.oMessageData.body&&e.oMessageData.body.callbackMessage&&e.oMessageData.body.callbackMessage.service){t=I.prototype._backButtonPressedCallback.bind(null,e.oMessage.source,e.oMessageData.body.callbackMessage.service,e.oMessage.origin)}e.oContainer.getShellUIService().setBackNavigation(t);return Promise.resolve()}}}},"sap.ushell.services.ShellUIService":{oServiceCalls:{setTitle:{executeServiceCallFn:function(e){return(new jQuery.Deferred).resolve(e.oContainer.getShellUIService().setTitle(e.oMessageData.body.sTitle)).promise()}},setHierarchy:{executeServiceCallFn:function(e){return(new jQuery.Deferred).resolve(e.oContainer.getShellUIService().setHierarchy(e.oMessageData.body.aHierarchyLevels)).promise()}},setRelatedApps:{executeServiceCallFn:function(e){return(new jQuery.Deferred).resolve(e.oContainer.getShellUIService().setRelatedApps(e.oMessageData.body.aRelatedApps)).promise()}},setDirtyFlag:{executeServiceCallFn:function(e){sap.ushell.Container.setDirtyFlag(e.oMessageData.body.bIsDirty);return(new jQuery.Deferred).resolve().promise()}},showShellUIBlocker:{executeServiceCallFn:function(e){var t=e.oMessageData.body.bShow;x(t);sap.ui.getCore().getEventBus().publish("sap.ushell.services.ShellUIService","showShellUIBlocker",{bShow:t});return(new jQuery.Deferred).resolve().promise()}},getFLPUrl:{executeServiceCallFn:function(e){var t=false;if(e.oMessageData.body&&e.oMessageData.body.bIncludeHash===true){t=true}return(new jQuery.Deferred).resolve(sap.ushell.Container.getFLPUrl(t)).promise()}},getShellGroupIDs:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("Bookmark").then(function(r){r.getShellGroupIDs(e.oMessageData.body?e.oMessageData.body.bGetAll:undefined).then(t.resolve,t.reject)});return t.promise()}},addBookmark:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("Bookmark").then(function(r){r.addBookmarkByGroupId(e.oMessageData.body.oParameters,e.oMessageData.body.groupId).then(t.resolve,t.reject)});return t.promise()}},addBookmarkDialog:{executeServiceCallFn:function(e){sap.ui["require"](["sap/ushell/ui/footerbar/AddBookmarkButton"],function(e){var t=new e;t.firePress({})});return(new jQuery.Deferred).resolve().promise()}},getShellGroupTiles:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("LaunchPage").then(function(r){r.getTilesByGroupId(e.oMessageData.body.groupId).then(t.resolve,t.reject)});return t.promise()}},sendUrlAsEmail:{executeServiceCallFn:function(e){var t=p.last("/core/shellHeader/application").title;var r=t===undefined?y.i18n.getText("linkToApplication"):y.i18n.getText("linkTo")+" '"+t+"'";I.prototype._sendEmail("",r,document.URL,"","",document.URL,true);return(new jQuery.Deferred).resolve().promise()}},sendEmailWithFLPButton:{executeServiceCallFn:function(e){var t=p.last("/core/shellHeader/application").title;var r=t===undefined?y.i18n.getText("linkToApplication"):y.i18n.getText("linkTo")+" '"+t+"'";I.prototype._sendEmail("",r,document.URL,"","",document.URL,e.oMessageData.body.bSetAppStateToPublic);return(new jQuery.Deferred).resolve().promise()}},sendEmail:{executeServiceCallFn:function(e){I.prototype._sendEmail(e.oMessageData.body.sTo,e.oMessageData.body.sSubject,e.oMessageData.body.sBody,e.oMessageData.body.sCc,e.oMessageData.body.sBcc,e.oMessageData.body.sIFrameURL,e.oMessageData.body.bSetAppStateToPublic);return(new jQuery.Deferred).resolve().promise()}},processHotKey:{executeServiceCallFn:function(e){var t;try{t=new KeyboardEvent("keydown",e.oMessageData.body)}catch(a){var r=document.createEvent("KeyboardEvent"),n="";if(e.oMessageData.body.altKey){n+="Alt "}if(e.oMessageData.body.ctrlKey){n+="Control "}if(e.oMessageData.body.shiftKey){n+="Shift "}r.initKeyboardEvent("keydown",false,false,null,e.oMessageData.body.key,e.oMessageData.body.keyCode,n,0,false);t=r}document.dispatchEvent(t);return(new jQuery.Deferred).resolve().promise()}}}},"sap.ushell.services.Container":{oServiceCalls:{setDirtyFlag:{executeServiceCallFn:function(e){sap.ushell.Container.setDirtyFlag(e.oMessageData.body.bIsDirty);return(new jQuery.Deferred).resolve().promise()}},registerDirtyStateProvider:{executeServiceCallFn:function(e){if(e.oMessageData.body.bRegister){I.prototype.registerAsyncDirtyStateProvider(e)}else{I.prototype.deregisterAsyncDirtyStateProvider(e)}return(new jQuery.Deferred).resolve().promise()}},getFLPUrl:{executeServiceCallFn:function(e){var t=false;if(e.oMessageData.body&&e.oMessageData.body.bIncludeHash===true){t=true}return(new jQuery.Deferred).resolve(sap.ushell.Container.getFLPUrl(t)).promise()}},getFLPConfig:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getFLPConfig().then(function(e){t.resolve(e)});return t.promise()}},getFLPPlatform:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getFLPPlatform().then(t.resolve);return t.promise()}},attachLogoutEvent:{executeServiceCallFn:function(e){sap.ushell.Container.attachLogoutEvent(function(){return new Promise(function(t,r){sap.ui.require(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"],function(n){n.postMessageToIframeApp(e.oContainer,"sap.ushell.appRuntime","executeLogoutFunctions",{},true).then(t,r)})})},true);return(new jQuery.Deferred).resolve().promise()}}}},"sap.ushell.services.AppState":{oServiceCalls:{getAppState:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("AppState").then(function(r){r.getAppState(e.oMessageData.body.sKey).done(function(e){delete e._oServiceInstance;t.resolve(e)}).fail(function(e){delete e._oServiceInstance;t.resolve(e)})});return t.promise()}},_saveAppState:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("AppState").then(function(r){r._saveAppState(e.oMessageData.body.sKey,e.oMessageData.body.sData,e.oMessageData.body.sAppName,e.oMessageData.body.sComponent,e.oMessageData.body.bTransient,e.oMessageData.body.iPersistencyMethod,e.oMessageData.body.oPersistencySettings).then(t.resolve,t.reject)});return t.promise()}},_loadAppState:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("AppState").then(function(r){r._loadAppState(e.oMessageData.body.sKey).then(t.resolve,t.reject)});return t.promise()}},deleteAppState:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("AppState").then(function(r){r.deleteAppState(e.oMessageData.body.sKey).then(t.resolve,t.reject)});return t.promise()}},makeStatePersistent:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("AppState").then(function(r){r.makeStatePersistent(e.oMessageData.body.sKey,e.oMessageData.body.iPersistencyMethod,e.oMessageData.body.oPersistencySettings).then(t.resolve,t.reject)});return t.promise()}}}},"sap.ushell.services.Bookmark":{oServiceCalls:{addBookmarkUI5:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("AppLifeCycle").then(function(r){r.getCurrentApplication().getSystemContext().then(function(r){I.prototype._stripBookmarkServiceUrlForLocalContentProvider(e.oMessageData.body.oParameters,r);sap.ushell.Container.getServiceAsync("Bookmark").then(function(n){n.addBookmark(e.oMessageData.body.oParameters,e.oMessageData.body.vContainer,r.id).then(t.resolve,t.reject)})})});return t.promise()}},addBookmark:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("Bookmark").then(function(r){r.addBookmarkByGroupId(e.oMessageData.body.oParameters,e.oMessageData.body.groupId).then(t.resolve,t.reject)});return t.promise()}},getShellGroupIDs:{executeServiceCallFn:function(){var e=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("Bookmark").then(function(t){t.getShellGroupIDs().then(e.resolve,e.reject)});return e.promise()}},addCatalogTileToGroup:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("Bookmark").then(function(r){r.addCatalogTileToGroup(e.oMessageData.body.sCatalogTileId,e.oMessageData.body.sGroupId,e.oMessageData.body.oCatalogData).then(t.resolve,t.reject)});return t.promise()}},countBookmarks:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("AppLifeCycle").then(function(r){r.getCurrentApplication().getSystemContext().then(function(r){sap.ushell.Container.getServiceAsync("Bookmark").then(function(n){n.countBookmarks(e.oMessageData.body.sUrl,r.id).then(t.resolve,t.reject)})})});return t.promise()}},deleteBookmarks:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("AppLifeCycle").then(function(r){r.getCurrentApplication().getSystemContext().then(function(r){sap.ushell.Container.getServiceAsync("Bookmark").then(function(n){n.deleteBookmarks(e.oMessageData.body.sUrl,r.id).then(t.resolve,t.reject)})})});return t.promise()}},updateBookmarks:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("AppLifeCycle").then(function(r){r.getCurrentApplication().getSystemContext().then(function(r){sap.ushell.Container.getServiceAsync("Bookmark").then(function(n){n.updateBookmarks(e.oMessageData.body.sUrl,e.oMessageData.body.oParameters,r.id).then(t.resolve,t.reject)})})});return t.promise()}},getContentNodes:{executeServiceCallFn:function(){var e=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("Bookmark").then(function(t){t.getContentNodes().then(e.resolve,e.reject)});return e.promise()}},addCustomBookmark:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("AppLifeCycle").then(function(r){r.getCurrentApplication().getSystemContext().then(function(r){sap.ushell.Container.getServiceAsync("Bookmark").then(function(n){n.addCustomBookmark(e.oMessageData.body.sVizType,e.oMessageData.body.oConfig,e.oMessageData.body.vContentNodes,r.id).then(t.resolve,t.reject)})})});return t.promise()}},countCustomBookmarks:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("AppLifeCycle").then(function(r){r.getCurrentApplication().getSystemContext().then(function(r){e.oMessageData.body.oIdentifier.contentProviderId=r.id;sap.ushell.Container.getServiceAsync("Bookmark").then(function(r){r.countCustomBookmarks(e.oMessageData.body.oIdentifier).then(t.resolve,t.reject)})})});return t.promise()}},updateCustomBookmarks:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("AppLifeCycle").then(function(r){r.getCurrentApplication().getSystemContext().then(function(r){e.oMessageData.body.oIdentifier.contentProviderId=r.id;sap.ushell.Container.getServiceAsync("Bookmark").then(function(r){r.updateCustomBookmarks(e.oMessageData.body.oIdentifier,e.oMessageData.body.oConfig).then(t.resolve,t.reject)})})});return t.promise()}},deleteCustomBookmarks:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("AppLifeCycle").then(function(r){r.getCurrentApplication().getSystemContext().then(function(r){e.oMessageData.body.oIdentifier.contentProviderId=r.id;sap.ushell.Container.getServiceAsync("Bookmark").then(function(r){r.deleteCustomBookmarks(e.oMessageData.body.oIdentifier).then(t.resolve,t.reject)})})});return t.promise()}},addBookmarkToPage:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("AppLifeCycle").then(function(r){r.getCurrentApplication().getSystemContext().then(function(r){sap.ushell.Container.getServiceAsync("Bookmark").then(function(n){n.addBookmarkToPage(e.oMessageData.body.oParameters,e.oMessageData.body.sPageId,r.id).then(t.resolve,t.reject)})})});return t.promise()}}}},"sap.ushell.services.AppLifeCycle":{oServiceCalls:{getFullyQualifiedXhrUrl:{executeServiceCallFn:function(e){var t="",r="",n=new jQuery.Deferred,a=e.oMessageData.body.path;if(a!==""&&a!==undefined&&a!==null){sap.ushell.Container.getServiceAsync("AppLifeCycle").then(function(e){e.getCurrentApplication().getSystemContext().then(function(e){r=e.getFullyQualifiedXhrUrl(a);var o="",s="",i="",l=sap.ushell.Container.getFLPUrl(true),u=new c(l);if(u.protocol()!==null&&u.protocol()!==undefined&&u.protocol()!==""){s=u.protocol()+"://"}if(u.hostname()!==null&&u.hostname()!==undefined&&u.hostname()!==""){o=u.hostname()}if(u.port()!==null&&u.port()!==undefined&&u.port()!==""){i=":"+u.port()}t=s+o+i+r;n.resolve(t)})})}return n.promise()}},getSystemAlias:{executeServiceCallFn:function(e){var t=e.oContainer.getSystemAlias();if(t===null||t===undefined){t=""}return(new jQuery.Deferred).resolve(t).promise()}},setNewAppInfo:{executeServiceCallFn:function(e){sap.ushell.Container.getServiceAsync("AppLifeCycle").then(function(t){t.setAppInfo(e.oMessageData.body,true)});return(new jQuery.Deferred).resolve().promise()}},updateCurrentAppInfo:{executeServiceCallFn:function(e){sap.ushell.Container.getServiceAsync("AppLifeCycle").then(function(t){t.setAppInfo(e.oMessageData.body,false)});return Promise.resolve()}},changeAppKeepAliveStatus:{executeServiceCallFn:function(e){return new Promise(function(t){sap.ui.require(["sap/ushell/components/applicationIntegration/AppLifeCycle"],function(r){r.changeAppKeepAliveStatus(e.oContainer,e.oMessageData.body);t()})})}}}},"sap.ushell.services.AppConfiguration":{oServiceCalls:{setApplicationFullWidth:{executeServiceCallFn:function(e){s.setApplicationFullWidthInternal(e.oMessageData.body.bValue);return(new jQuery.Deferred).resolve().promise()}}}},"sap.ushell.appRuntime":{oRequestCalls:{innerAppRouteChange:{isActiveOnly:true,distributionType:["all"]},keepAliveAppHide:{isActiveOnly:true,distributionType:["all"]},keepAliveAppShow:{isActiveOnly:true,distributionType:["all"]},hashChange:{isActiveOnly:true,distributionType:["URL"]},setDirtyFlag:{isActiveOnly:true,distributionType:["URL"]},getDirtyFlag:{isActiveOnly:true,distributionType:["URL"]},themeChange:{isActiveOnly:false,distributionType:["all"]},uiDensityChange:{isActiveOnly:false,distributionType:["all"]}},oServiceCalls:{hashChange:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;h.disableBlueBoxHashChangeTrigger=true;h.replaceHash(e.oMessageData.body.newHash);h.disableBlueBoxHashChangeTrigger=false;var r=e.oMessageData.body.direction;if(r){sap.ushell.Container.getServiceAsync("ShellNavigation").then(function(e){e.hashChanger.fireEvent("hashReplaced",{hash:e.hashChanger.getHash(),direction:r});a.debug("PostMessageAPI.hashChange :: Informed by the Iframe, to change the "+"History direction property in FLP to: "+r);t.resolve()})}else{t.resolve()}return t.promise()}},iframeIsValid:{executeServiceCallFn:function(e){e.oContainer.setProperty("isIframeValidTime",{time:(new Date).getTime()},true);return(new jQuery.Deferred).resolve().promise()}},iframeIsBusy:{executeServiceCallFn:function(e){return(new jQuery.Deferred).resolve().promise()}},isInvalidIframe:{executeServiceCallFn:function(e){e.oContainer.setProperty("isInvalidIframe",e.oMessageData.body.bValue,true);return(new jQuery.Deferred).resolve().promise()}}}},"sap.ushell.services.UserInfo":{oServiceCalls:{getThemeList:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("UserInfo").then(function(e){e.getThemeList().then(t.resolve,t.reject)});return t.promise()}},getShellUserInfo:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("UserInfo").then(function(e){e.getShellUserInfo().then(t.resolve,t.reject)});return t.promise()}},getLanguageList:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("UserInfo").then(function(e){e.getLanguageList().then(t.resolve,t.reject)});return t.promise()}},updateUserPreferences:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;if(e.oMessageData.body.language){sap.ushell.Container.getUser().setLanguage(e.oMessageData.body.language);sap.ushell.Container.getServiceAsync("UserInfo").then(function(e){e.updateUserPreferences().then(function(){sap.ushell.Container.getUser().resetChangedProperty("language");t.resolve()},t.reject)})}else{t.resolve()}return t.promise()}},openThemeManager:{executeServiceCallFn:function(e){i.emit("openThemeManager",Date.now());return(new jQuery.Deferred).resolve().promise()}},getLocaleData:{executeServiceCallFn:function(r){const n={calendarType:e.getCalendarType(),dateFormatShort:e.getDatePattern("short"),dateFormatMedium:e.getDatePattern("medium"),numberFormatGroup:e.getNumberSymbol("group"),numberFormatDecimal:e.getNumberSymbol("decimal"),timeFormatShort:e.getTimePattern("short"),timeFormatMedium:e.getTimePattern("medium"),calendarMapping:e.getCustomIslamicCalendarData(),timeZone:t.getTimezone(),currencyFormats:e.getCustomCurrencies()};return(new jQuery.Deferred).resolve(n).promise()}}}},"sap.ushell.services.ShellNavigation":{oServiceCalls:{toExternal:{executeServiceCallFn:function(e){sap.ushell.Container.getServiceAsync("ShellNavigation").then(function(t){t.toExternal(e.oMessageData.body.oArgs,undefined,e.oMessageData.body.bWriteHistory)});return(new jQuery.Deferred).resolve().promise()}},toAppHash:{executeServiceCallFn:function(e){sap.ushell.Container.getServiceAsync("ShellNavigation").then(function(t){t.toAppHash(e.oMessageData.body.sAppHash,e.oMessageData.body.bWriteHistory)});return(new jQuery.Deferred).resolve().promise()}}}},"sap.ushell.services.NavTargetResolution":{oServiceCalls:{getDistinctSemanticObjects:{executeServiceCallFn:function(){var e=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("NavTargetResolution").then(function(t){t.getDistinctSemanticObjects().then(e.resolve,e.reject)});return e.promise()}},expandCompactHash:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("NavTargetResolution").then(function(r){r.expandCompactHash(e.oMessageData.body.sHashFragment).then(t.resolve,t.reject)});return t.promise()}},resolveHashFragment:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("NavTargetResolution").then(function(r){r.resolveHashFragment(e.oMessageData.body.sHashFragment).then(t.resolve,t.reject)});return t.promise()}},isIntentSupported:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("NavTargetResolution").then(function(r){r.isIntentSupported(e.oMessageData.body.aIntents).then(t.resolve,t.reject)});return t.promise()}},isNavigationSupported:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("NavTargetResolution").then(function(r){r.isNavigationSupported(e.oMessageData.body.aIntents).then(t.resolve,t.reject)});return t.promise()}}}},"sap.ushell.services.Renderer":{oServiceCalls:{addHeaderItem:{executeServiceCallFn:function(e){k("addHeaderItem",e);return(new jQuery.Deferred).resolve().promise()}},addHeaderEndItem:{executeServiceCallFn:function(e){k("addHeaderEndItem",e);return(new jQuery.Deferred).resolve().promise()}},showHeaderItem:{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").showHeaderItem(e.oMessageData.body.aIds,e.oMessageData.body.bCurrentState||true,e.oMessageData.body.aStates);return(new jQuery.Deferred).resolve().promise()}},showHeaderEndItem:{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").showHeaderEndItem(e.oMessageData.body.aIds,e.oMessageData.body.bCurrentState||true,e.oMessageData.body.aStates);return(new jQuery.Deferred).resolve().promise()}},hideHeaderItem:{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").hideHeaderItem(e.oMessageData.body.aIds,e.oMessageData.body.bCurrentState||true,e.oMessageData.body.aStates);return(new jQuery.Deferred).resolve().promise()}},hideHeaderEndItem:{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").hideHeaderEndItem(e.oMessageData.body.aIds,e.oMessageData.body.bCurrentState||true,e.oMessageData.body.aStates);return(new jQuery.Deferred).resolve().promise()}},setHeaderTitle:{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").setHeaderTitle(e.oMessageData.body.sTitle);return(new jQuery.Deferred).resolve().promise()}},setHeaderVisibility:{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").setHeaderVisibility(e.oMessageData.body.bVisible,e.oMessageData.body.bCurrentState||true,e.oMessageData.body.aStates);return(new jQuery.Deferred).resolve().promise()}},createShellHeadItem:{executeServiceCallFn:function(e){var t=e.oMessageData.body.params;t.press=function(){sap.ui.require(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"],function(r){r.postMessageToIframeApp(e.oContainer,"sap.ushell.appRuntime","buttonClick",{buttonId:t.id})})};new C(t);return(new jQuery.Deferred).resolve().promise()}},showActionButton:{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").showActionButton(e.oMessageData.body.aIds,e.oMessageData.body.bCurrentState,e.oMessageData.body.aStates);return(new jQuery.Deferred).resolve().promise()}},hideActionButton:{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").hideActionButton(e.oMessageData.body.aIds,e.oMessageData.body.bCurrentState,e.oMessageData.body.aStates);return(new jQuery.Deferred).resolve().promise()}},addUserAction:{executeServiceCallFn:function(e){e.oMessageData.body.oParameters.oControlProperties.press=function(){sap.ui.require(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"],function(t){t.postMessageToIframeApp(e.oContainer,"sap.ushell.appRuntime","buttonClick",{buttonId:e.oMessageData.body.oParameters.oControlProperties.id})})};sap.ushell.Container.getRenderer("fiori2").addUserAction(e.oMessageData.body.oParameters);return(new jQuery.Deferred).resolve().promise()}},addOptionsActionSheetButton:{executeServiceCallFn:function(e){var t=Array.isArray(e.oMessageData.body)?e.oMessageData.body:[e.oMessageData.body];t.forEach(function(t){if(g.byId(t.id)){g.byId(t.id).destroy()}new f({id:t.id,text:t.text,icon:t.icon,tooltip:t.tooltip,press:function(){sap.ui.require(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"],function(r){r.postMessageToIframeApp(e.oContainer,"sap.ushell.appRuntime","buttonClick",{buttonId:t.id})})}});sap.ushell.Container.getRenderer("fiori2").showActionButton([t.id],true,t.aStates)});return(new jQuery.Deferred).resolve().promise()}},removeOptionsActionSheetButton:{executeServiceCallFn:function(e){var t=Array.isArray(e.oMessageData.body)?e.oMessageData.body:[e.oMessageData.body];t.forEach(function(e){sap.ushell.Container.getRenderer("fiori2").hideActionButton(e.id,true,e.aStates);if(g.byId(e.id)){g.byId(e.id).destroy()}});return(new jQuery.Deferred).resolve().promise()}},updateHeaderItem:{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").updateHeaderItem(e.oMessageData.body.sId,e.oMessageData.body.oControlProperties);return(new jQuery.Deferred).resolve().promise()}},destroyButton:{executeServiceCallFn:function(e){sap.ushell.Container.getRenderer("fiori2").destroyButton(e.oMessageData.body.aIds);return(new jQuery.Deferred).resolve().promise()}}}},"sap.ushell.services.LaunchPage":{oServiceCalls:{getGroupsForBookmarks:{executeServiceCallFn:function(){var e=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("LaunchPage").then(function(t){t.getGroupsForBookmarks().then(e.resolve,e.reject)});return e.promise()}}}},"sap.ushell.services.Menu":{oServiceCalls:{getSpacesPagesHierarchy:{executeServiceCallFn:function(){var e=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("Menu").then(function(t){t.getSpacesPagesHierarchy().then(function(t){e.resolve(t)})});return e.promise()}}}},"sap.ushell.services.CommonDataModel":{oServiceCalls:{getAllPages:{executeServiceCallFn:function(){var e=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("CommonDataModel").then(function(t){t.getAllPages().then(function(t){e.resolve(t)})});return e.promise()}}}},"sap.ushell.services.UITracer":{oServiceCalls:{trace:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("UITracer").then(function(){i.emit("UITracer.trace",e.oMessageData.body.trace);t.resolve()});return t.promise()}}}},"sap.ushell.services.MessageBroker":{oServiceCalls:{_execute:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;if(p.last("/core/shell/enableMessageBroker")){sap.ushell.Container.getServiceAsync("MessageBroker").then(function(r){sap.ui.require(["sap/ushell/services/_MessageBroker/MessageBrokerEngine"],function(r){r.processPostMessage(e).then(function(e){t.resolve(e)}).catch(function(e){t.reject(e)})})})}else{t.resolve({})}return t.promise()}}}},"sap.ushell.services.SearchableContent":{oServiceCalls:{getApps:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("SearchableContent").then(function(r){var n;try{n=e.oMessageData.body.oOptions}catch(e){n={}}r.getApps(n).then(function(e){t.resolve(e)})});return t.promise()}}}},"sap.ushell.services.ReferenceResolver":{oServiceCalls:{resolveReferences:{executeServiceCallFn:function(e){var t=new jQuery.Deferred;sap.ushell.Container.getServiceAsync("ReferenceResolver").then(function(r){r.resolveReferences(e.oMessageData.body.aReferences).then(t.resolve,t.reject)});return t.promise()}}}}};function I(){this._getBrowserURL=function(){return document.URL};Object.keys(M).forEach(function(e){if(e.indexOf(D)!==0){throw new Error("All Post Message APIs must start with '"+D+"' - "+e)}});l.init(true,I.prototype.registerShellCommunicationHandler.bind(this))}I.prototype.getAPIs=function(){return M};function F(e,t){var r=M[e],n;if(r){if(t.oServiceCalls){Object.keys(t.oServiceCalls).forEach(function(e){r.oServiceCalls[e]=t.oServiceCalls[e]})}if(!r.oRequestCalls){r.oRequestCalls={}}if(t.oRequestCalls){Object.keys(t.oRequestCalls).forEach(function(e){r.oRequestCalls[e]=t.oRequestCalls[e]})}return}n={oRequestCalls:{},oServiceCalls:{}};if(t.oServiceCalls){Object.keys(t.oServiceCalls).forEach(function(e){n.oServiceCalls[e]=t.oServiceCalls[e]})}if(t.oRequestCalls){Object.keys(t.oRequestCalls).forEach(function(e){n.oRequestCalls[e]=t.oRequestCalls[e]})}M[e]=n}I.prototype._getPostMesageInterface=function(e,t){var r,n=this.getAPIs();if(n[e]){r=n[e];if(r&&r.oRequestCalls&&r.oRequestCalls[t]){return r.oRequestCalls[t]}}return undefined};I.prototype.registerShellCommunicationHandler=function(e){Object.keys(e).forEach(function(t){F(t,e[t])})};I.prototype.isActiveOnly=function(e,t){var r=this._getPostMesageInterface(e,t);if(r){return r.isActiveOnly}return undefined};I.prototype._createNewInnerAppState=function(e){return new Promise(function(t){var r,n,a,o,s;sap.ushell.Container.getServiceAsync("AppState").then(function(i){r=i.createEmptyAppState();if(e.oMessageData.body.sData!==undefined){try{s=JSON.parse(e.oMessageData.body.sData)}catch(t){s=e.oMessageData.body.sData}}else{s=""}r.setData(s);r.save();o=r.getKey();n=h.getHash();if(n.indexOf("&/")>0){if(n.indexOf("sap-iapp-state=")>0){a=/(?:sap-iapp-state=)([^&/]+)/.exec(n)[1];n=n.replace(a,o)}else{n=n+"/sap-iapp-state="+o}}else{n=n+"&/sap-iapp-state="+o}h.disableBlueBoxHashChangeTrigger=true;h.replaceHash(n);h.disableBlueBoxHashChangeTrigger=false;t(o)})})};function x(e){if(e===true){if(g.byId("shell-header")){g.byId("shell-header").setBlocked(true);var t=jQuery("#shell-header-blockedLayer");t.addClass("sapUshellShellBlocked")}if(g.byId("menuBar")){g.byId("menuBar").setBlocked(true);var r=jQuery("#menuBar-blockedLayer");r.addClass("sapUshellMenuBarBlocked")}}else if(e===false){if(g.byId("shell-header")){g.byId("shell-header").setBlocked(false)}if(g.byId("menuBar")){g.byId("menuBar").setBlocked(false)}}}function k(e,t){sap.ushell.Container.getRenderer("fiori2")[e]("sap.ushell.ui.shell.ShellHeadItem",{id:t.oMessageData.body.sId,tooltip:t.oMessageData.body.sTooltip,icon:t.oMessageData.body.sIcon,floatingNumber:t.oMessageData.body.iFloatingNumber,press:function(){sap.ui.require(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"],function(e){e.postMessageToIframeApp(t.oContainer,"sap.ushell.appRuntime","buttonClick",{buttonId:t.oMessageData.body.sId})})}},t.oMessageData.body.bVisible,t.oMessageData.body.bCurrentState||true,t.oMessageData.body.aStates)}I.prototype.registerAsyncDirtyStateProvider=function(e){sap.ushell.Container.setAsyncDirtyStateProvider(function(t){return new Promise(function(r){var n;sap.ui.require(["sap/ushell/components/applicationIntegration/application/PostMessageUtils"],function(a){a.postMessageToIframeApp(e.oContainer,"sap.ushell.appRuntime","handleDirtyStateProvider",{oNavigationContext:t},true).then(function(e){if(n){clearTimeout(n)}r(e&&e.body&&e.body.result||false)});n=setTimeout(function(){r(false)},2500)})})})};I.prototype.deregisterAsyncDirtyStateProvider=function(e){sap.ushell.Container.setAsyncDirtyStateProvider(undefined)};I.prototype._sendEmail=function(e,t,r,n,o,s,i){var l=this._getBrowserURL&&this._getBrowserURL()||document.URL;function c(e,n,a,o,s,i){t=t&&t.includes(e)?t.replace(e,n):t;r=r&&r.includes(e)?r.replace(e,n):r;t=t&&a&&s&&t.includes(a)?t.replace(a,s):t;t=t&&o&&i&&t.includes(o)?t.replace(o,i):t;r=r&&a&&s&&r.includes(a)?r.replace(a,s):r;r=r&&o&&i&&r.includes(o)?r.replace(o,i):r}if(i){sap.ushell.Container.getServiceAsync("AppState").then(function(i){i.setAppStateToPublic(s).done(function(a,i,u,p,d){if(p!==undefined){l=l.replace(i,p)}if(d!==undefined){l=l.replace(u,d)}c(s,l,i,u,p,d);A.triggerEmail(e,t,r,n,o)}).fail(a.error)})}else{c(s,l);A.triggerEmail(e,t,r,n,o)}};I.prototype._stripBookmarkServiceUrlForLocalContentProvider=function(e,t){if(!e||!e.serviceUrl||!t){return}if(t.id===""||t.id==="saas_approuter"){e.serviceUrl=undefined;a.warning("Dynamic data bookmarks tiles are not supported for local content providers",null,"sap/ushell/components/applicationIntegration/application/PostMessageAPI")}};I.prototype._backButtonPressedCallback=function(e,t,r){var n=JSON.stringify({type:"request",service:t,request_id:m(),body:{}});a.debug("Sending post message request to origin ' "+r+"': "+n,null,"sap.ushell.components.container.ApplicationContainer");e.postMessage(n,r)};return new I});
//# sourceMappingURL=PostMessageAPI.js.map