// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/Configuration","sap/ushell/utils/HttpClient","sap/base/util/ObjectPath","sap/ushell/Config","sap/base/Log"],function(e,t,a,r,s){"use strict";var i=function(){this.httpClient=new t;this._sBaseUrl=r.last("/core/workPages/contentApiUrl")};i.prototype._validateData=function(e){s.debug("cep/editMode: load Page: validate","Work Page service");if(e.errors&&e.errors.length>0){return Promise.reject(e.errors.map(function(e){return e.message}).join(",\n"))}if(!a.get("data.workPage",e)){s.debug("cep/editMode: load Page: validate: reject: data is empty","Work Page service");return Promise.reject("Work Page data is empty")}return Promise.resolve(e)};i.prototype.loadWorkPageAndVisualizations=function(e,t){var r="{"+"workPage("+'siteId:"'+e+'",'+'workPageId:"'+t+'"'+") {"+"id,"+"contents,"+"editable,"+"usedVisualizations{"+"nodes{"+"id,"+"type,"+"descriptor{"+"value"+"},"+"descriptorResources{"+"baseUrl,"+"descriptorPath"+"}"+"}"+"}"+"}"+"}";return this._doRequest(r).then(this._validateData).then(function(e){var t=a.get("data.workPage.contents",e);var r=a.get("data.workPage.usedVisualizations.nodes",e)||[];var s=a.get("data.workPage.editable",e)===true;return{workPage:{contents:t,usedVisualizations:{nodes:r},editable:s}}})};i.prototype._doRequest=function(t){return this.httpClient.get(this._sBaseUrl+"?query="+t,{headers:{"Content-Type":"application/json",Accept:"application/json","Accept-Language":e.getLanguageTag()}}).then(function(e){if(e.status<200||e.status>=300){return Promise.reject("HTTP request failed with status: "+e.status+" - "+e.statusText)}return JSON.parse(e.responseText||"{}")})};return i},true);
//# sourceMappingURL=WorkPage.js.map