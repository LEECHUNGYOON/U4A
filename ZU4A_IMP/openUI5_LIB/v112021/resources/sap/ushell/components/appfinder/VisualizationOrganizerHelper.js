// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/m/library","sap/ui/core/Core","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/resources"],function(t,n,e,i,o){"use strict";var r=t.ButtonType;var u;function s(){return n.byId("catalogView")}function a(){return n.byId("appFinderView")}function l(){var t,n,u=null;function l(){return e.last("/core/spaces/enabled")}function f(){if(t){return Promise.resolve(t)}n=n||new Promise(function(n){sap.ui.require(["sap/ushell/components/visualizationOrganizer/Component"],function(e){t=new e;n(t)})});return n}function c(){var n=s();if(!n){return}n.setBusy(true);return f().then(function(t){return t.requestData()}).then(function(){if(this.oModel){this.oModel.updateBindings(true)}var n=a();if(n&&t.getPersonalizablePages().length===1){var e=o.i18n.getText("VisualizationOrganizer.PageContextTitle",[t.getPersonalizablePages()[0].title]);n.getController()._updateShellHeader(e)}}.bind(this)).finally(function(){n.setBusy(false)})}if(l()){this.oDoable=i.on("trackHashChange").do(function(t){if(l()&&t==="Shell-appFinder"){c.call(this)}}.bind(this))}this.setModel=function(t){this.oModel=t};this.loadAndUpdate=function(){if(!l()){return Promise.resolve()}return c.call(this)};this.formatPinButtonTooltip=function(n,e,i){if(!l()){return this.formatPinButtonTooltip(n,e)}return t.formatPinButtonTooltip(i,u)};this.formatPinButtonSelectState=function(){if(!l()){return this.formatPinButtonSelectState.apply(this,arguments)}return false};this.formatPinButtonIcon=function(n){if(!l()){return"sap-icon://pushpin-off"}return t.formatPinButtonIcon(n,!!u)};this.formatPinButtonType=function(n){if(!l()){return r.Default}return t.formatPinButtonType(n,!!u)};this.onTilePinButtonClick=function(n){if(!l()){this.getController().onTilePinButtonClick(n);return}t.onTilePinButtonClick(n,u)};this.getNavigationContext=function(){if(!l()){return this.getGroupContext.apply(this,arguments)}if(u){return{pageID:encodeURIComponent(u.pageID),sectionID:encodeURIComponent(u.sectionID)}}return null};this.getNavigationContextAsText=function(){if(!l()){return this.getGroupNavigationContext.apply(this,arguments)}if(u){return JSON.stringify({pageID:encodeURIComponent(u.pageID),sectionID:encodeURIComponent(u.sectionID)})}return null};this.updateModelWithContext=function(n){if(!l()){this._updateModelWithGroupContext.apply(this,arguments);return Promise.resolve()}return f().then(function(){return t.loadSectionContext(n)}).then(function(t){u=t;this.oView.getModel().updateBindings(true);if(u){var n=u.sectionTitle?o.i18n.getText("VisualizationOrganizer.AppFinderSectionContextTitle",[u.sectionTitle]):o.i18n.getText("VisualizationOrganizer.AppFinderSectionContextTitle",[u.pageTitle]);this.oView.oPage.setTitle(n);if(this._updateShellHeader){return new Promise(function(t){setTimeout(function(){this._updateShellHeader(n);t()}.bind(this),0)}.bind(this))}}return Promise.resolve()}.bind(this))};this._loadVisualizationOrganizer=f;this._setSectionContext=function(t){u=t};this.exit=function(){if(this.oDoable){this.oDoable.off();this.oDoable=null}};this.onHierarchyAppsPinButtonClick=function(n){if(!l()){this.showGroupListPopover(n);return Promise.resolve(false)}return t.onHierarchyAppsPinButtonClick(n,u)};this.formatBookmarkPinButtonTooltip=function(n,e,i,o,r){if(!l()){return this.formatPinButtonTooltip(n,e,i,o,r)}return t.formatBookmarkPinButtonTooltip(e,u)};this.formatBookmarkPinButtonSelectState=function(t){if(!l()){return!!t}return false};this.formatBookmarkPinButtonIcon=function(t){if(!l()){return"sap-icon://pushpin-off"}return t>0?"sap-icon://accept":"sap-icon://add"};this.formatBookmarkPinButtonType=function(t){if(!l()){return r.Default}return t>0?r.Emphasized:r.Default};this.updateBookmarkCount=function(n){if(!l()){return this.updateBookmarkCount(n)}return t.updateBookmarkCount(n,u)};this.shouldPinButtonBeVisible=function(){return new Promise(function(t){var n=e.last("/core/shell/enablePersonalization");if(!l()||n){t(n)}else if(!e.last("/core/spaces/myHome/enabled")){t(false)}else{sap.ushell.Container.getServiceAsync("UserInfo").then(function(n){t(n.getUser().getShowMyHome())})}})}}return{getInstance:function(){if(!u){u=new l}return u},_getConstructor:function(){return l},destroy:function(){if(u){u.exit()}u=null}}});
//# sourceMappingURL=VisualizationOrganizerHelper.js.map