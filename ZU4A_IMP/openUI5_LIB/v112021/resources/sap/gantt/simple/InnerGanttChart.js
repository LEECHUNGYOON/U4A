/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/core/Core","sap/ui/core/Control","sap/ui/table/library","sap/ui/table/utils/TableUtils","sap/gantt/simple/GanttExtension","sap/ui/table/rowmodes/Fixed","./GanttUtils","sap/gantt/simple/InnerGanttChartRenderer"],function(e,t,n,a,r,o,i){"use strict";var s=t.extend("sap.gantt.simple.InnerGanttChart",{metadata:{library:"sap.gantt",events:{ganttReady:{parameters:{hasRenderedShapes:{type:"boolean"},totalRenderedShapes:{type:"int"},supressEvent:{type:"boolean"}}},_afterGanttRendered:{}}}});s.prototype.getDomRef=function(e){var t=this.getParent(),n;if(e){n="-"+e}else{n="-cnt"}if(t){return window.document.getElementById(t.getId()+n)}return null};s.prototype.invalidate=function(){var e=this.getParent();e._oInnerGanttRenderPromise.then(function(){e._bInnerGanttRenderPromiseResolved=true;var t=this.getUIArea();if(t){t.addInvalidatedControl(this)}}.bind(this))};s.prototype.hasRenderedShapes=function(){return this.$("svg").find(".sapGanttChartShapes").children().length>0};s.prototype.getTotalRenderedShapes=function(){return this.$("svg").find(".sapGanttChartShapes").children().length};s.prototype.resolveWhenReady=function(e){return new Promise(function(t){var r=function s(d){var h=this.getParent(),g=h.getTable();i.setTableRowMode(g);if(h._enableOptimisation&&!h.getTable().getRowMode().isA("sap.ui.table.rowmodes.Fixed")){h.getTable().setRowMode(new o)}var l;if(g.getRowMode()){l=h.getTable().getRowMode().isA("sap.ui.table.rowmodes.Auto")&&h.getSyncedControl().getRowStates().length<h.getTable().getRows().length-1+a.getHeaderRowCount(h.getTable())}else{l=h.getTable().getVisibleRowCountMode()===n.VisibleRowCountMode.Auto&&h.getSyncedControl().getRowStates().length<h.getTable().getVisibleRowCount()+a.getHeaderRowCount(h.getTable())}if(e&&!d.getParameter("hasRenderedShapes")||l){this.attachEventOnce("ganttReady",r)}else{t()}}.bind(this);var s=Object.keys(this.getUIArea().mInvalidatedControls);if(s.indexOf(this.getParent().getId())>-1||s.indexOf(this.getParent().getTable().getId())>-1){this.attachEventOnce("ganttReady",r)}else if(!e&&this.getDomRef("svg")||e&&this.hasRenderedShapes()){t()}else{this.attachEventOnce("ganttReady",r)}}.bind(this))};s.prototype._updateRowsHoverState=function(){var e=this.getParent();setTimeout(function(){e.$("svg").find("rect.sapGanttBackgroundSVGRow:hover").each(function(){var t=e._getPointerExtension(),n=t._getRowIndexFromElement(this);e.getSyncedControl().syncRowHover(n,true)});e.$("svg").find("rect.sapGanttBackgroundSVGRow:not(:hover)").each(function(){var t=e._getPointerExtension(),n=t._getRowIndexFromElement(this);e.getSyncedControl().syncRowHover(n,false)})},0)};s.prototype.onBeforeRendering=function(e){performance.mark("InnerGanttChart--start");if(!this.getParent()._bPreventInitialRender||this.getParent()._bRenderGanttClone||this.getParent()._bRenderFullScreenGantt){this.getParent()._bRenderFullScreenGantt=false;this.getParent()._getScrollExtension().jumpToVisibleHorizon("initialRender")}};s.prototype.onAfterRendering=function(t){var n=this.getParent();n._updateVsbContainers();n._syncContainerGanttCharts("initialRender",t);var a=e.createRenderManager();this.getRenderer().renderRelationships(a,n);a.destroy();this.fireEvent("_afterGanttRendered");n._updateShapeSelections(n.getSelectedShapeUid(),[]);n.updateShapeHighlights(n.getHighlightedShapeUid(),[]);n._getConnectExtension().updateShapeConnectEffect(n);this._updateRowsHoverState();r.attachEvents(n);this.fireGanttReady({hasRenderedShapes:this.hasRenderedShapes(),totalRenderedShapes:this.getTotalRenderedShapes()});performance.mark("InnerGanttChart--end")};return s},true);
//# sourceMappingURL=InnerGanttChart.js.map