/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/gantt/library","sap/ui/thirdparty/jquery","sap/ui/core/Element","sap/ui/core/Core","sap/ui/core/format/NumberFormat","sap/m/Label","sap/m/Text","sap/m/Title","sap/m/Dialog","sap/m/ProgressIndicator","sap/m/Button","sap/m/Input","sap/m/FlexBox","sap/m/library","sap/m/FlexItemData","sap/m/ScrollContainer","sap/m/ComboBox","sap/m/RadioButton","sap/m/RadioButtonGroup","sap/m/CheckBox","sap/m/Slider","sap/m/ResponsiveScale","sap/m/StepInput","sap/m/DatePicker","sap/m/DateTimePicker","sap/m/BusyDialog","sap/m/MessageStrip","sap/m/Switch","sap/m/Panel","sap/m/TextArea","sap/gantt/misc/Format","sap/gantt/simple/GanttChartContainer","sap/gantt/config/TimeHorizon","sap/gantt/axistime/FullScreenStrategy","sap/ui/core/Item","sap/ui/core/HTML","sap/ui/core/InvisibleText","sap/ui/layout/VerticalLayout","sap/ui/layout/HorizontalLayout","sap/ui/layout/GridData","sap/ui/layout/form/SimpleForm","sap/ui/model/json/JSONModel","sap/ui/core/theming/Parameters","sap/ui/core/ResizeHandler","sap/gantt/thirdparty/jspdf","sap/gantt/thirdparty/html2canvas","sap/gantt/thirdparty/svg2pdf","./RenderUtils","sap/m/PDFViewer","sap/ui/Device","sap/gantt/simple/GanttRowSettings","sap/gantt/simple/AggregationUtils","../simple/GanttUtils","sap/ui/core/date/UI5Date","sap/ui/core/format/DateFormat","sap/ui/table/rowmodes/Fixed","sap/ui/core/library","sap/ui/model/FilterType"],function(t,e,i,a,n,o,r,s,h,l,g,p,_,d,u,c,C,P,T,m,f,y,v,b,x,G,w,S,R,N,D,M,E,B,I,A,L,H,O,F,k,z,W,V,U,j,K,X,Z,Q,J,Y,$,q,tt,et,it,at){"use strict";var nt=d.FlexDirection,ot=t.simple.GanttChartWithTableDisplayType;j=window.html2canvas;U=window.jsPDF;K=window.svg2pdf;var rt=it.ValueState;var st=i.extend("sap.gantt.simple.GanttPrinting",{metadata:{library:"sap.gantt",associations:{ganttChart:{type:"sap.gantt.simple.GanttChartWithTable",multiple:false}}}});st._oPaperSizes={A5:{width:ut(148),height:ut(210)},A4:{width:ut(210),height:ut(297)},A3:{width:ut(297),height:ut(420)},A2:{width:ut(420),height:ut(594)},A1:{width:ut(594),height:ut(841)},A0:{width:ut(841),height:ut(1189)},Letter:{width:Ct(8.5),height:Ct(11)},Legal:{width:Ct(8.5),height:Ct(14)},Tabloid:{width:Ct(11),height:Ct(17)},Custom:{width:undefined,height:undefined}};var ht="9px Arial, Helvetica, sans-serif";var lt="12px Arial, Helvetica, sans-serif";var gt="16384";var pt=190;var _t=1.85;var dt=.56;st.prototype.init=function(){this._oRb=a.getLibraryResourceBundle("sap.gantt");var t={multiplePage:true,qualityWarning:false,showOrientationMessage:false,orientationMessage:this._oRb.getText("GNT_PRNTG_SINGLE_PAGE_LANDSCAPE"),portrait:true,paperSize:"A4",paperWidth:st._oPaperSizes.A4.width,paperHeight:st._oPaperSizes.A4.height,unit:"mm",repeatSelectionPanel:false,scale:100,duration:"all",startDate:new Date,endDate:new Date,showPageNumber:false,showHeaderText:false,headerText:"",showFooterText:false,footerText:"",exportAll:true,exportRange:"",exportAsJPEG:true,compressionQuality:75,previewPageNumber:1,lastPageNumber:undefined,marginType:"default",marginLocked:false,marginTop:ut(5),marginRight:ut(5),marginBottom:ut(5),marginLeft:ut(5),cropMarks:false,cropMarksWeight:.25,cropMarksOffset:ut(3)};this._oModel=new z(t);this._oGanttCanvas=undefined;this._iHeaderAndFooterHeight=ut(8);this._ganttChartContainer=new M;this.sFont=null;this._oPdfPreview=null};st.prototype.export=function(){this._savePdf()};st.prototype.exportSinglePage=function(){var t=new Date;this.oSinglePagePdf.save("GanttChartExport-"+t.toISOString()+".pdf")};st.prototype.renderGanttClone=function(t){if(a.getConfiguration().getRTL()&&!t){return Promise.resolve()}return new Promise(function(t){this._ganttChartClone.getTable().attachEventOnce("_rowsUpdated",t,this);this._ganttChartClone.invalidate()}.bind(this))};st.prototype.mergeCanvases=function(t){var e=document.createElement("canvas"),i=e.getContext("2d"),a=t[0].width,n=[],o=t.reduce(function(t,e,i,a){n.push({cnv:e,y:t});t+=a[i].height;return t},0);e.width=a;e.height=o;n.forEach(function(t){i.beginPath();i.drawImage(t.cnv,0,t.y,a,t.cnv.height)});if(e.width>gt||e.height>gt){this._oClonedGanttDiv.style.height=e.height+"px";this._oClonedGanttDiv.style.width=e.width+"px";return undefined}return e};st.prototype.generateCanvasAsync=function(t){var e=0;var i=this._getOriginalGanttChart().getTable()._getTotalRowCount()/this.iThreshold;this.bLast=i>1?false:true;var n=this;var o=[];var r=0;var s=25/Math.ceil(i);function h(){if(n._bMultipleBatches){r+=s;n._oProgressIndicator.setPercentValue(r)}}function l(t){if(n._bCancel){return Promise.reject()}n._oClonedGanttDiv.style.height=gt+"px";var o=t*n.iThreshold;var r=n._getOriginalGanttChart().getTable()._getTotalRowCount();n.iThreshold=Math.min(n.iThreshold,r-o);n.bLast=e+1>=i?true:false;n._ganttChartClone.getTable().setRowMode(new et({rowCount:n.iThreshold}));n.bFirst=t===0?true:false;n._ganttChartClone.getTable().setFirstVisibleRow(o);if(a.getConfiguration().getRTL()){n._ganttChartClone._bRenderGanttClone=true}return n._ganttChartClone.getInnerGantt().resolveWhenReady(n._originalHasRenderedShapes)}function g(t){h();return l(t).then(function(){h();n._bExpandCollapse=true;return n._expandAndCollapse()}).then(function(){n._ganttChartClone._bExpandRows=true;h();return n._expandRowSettings()}).then(function(){n._ganttChartClone._bExpandRows=false;n._setCloneDivHeight();document.getElementById(n._ganttChartClone.getId()+"-sapGanttBackgroundTableContent").style.height=n._iContentHeight;document.getElementById(n._ganttChartClone.getTable().getId()+"-tableCCnt").style.height=n._iContentHeight;if(!n.bLast){h()}return n._createGanttCanvas()}).then(function(t){return o.push(t)}).then(function(){if(t===0){n._ganttChartClone.setShowGanttHeader(false)}e=e+1;if(e<i){g(e)}else if(!n._bCancel){n._oGanttCanvas=n.mergeCanvases(o);n._updateDialogPreview();n._oDialog.getContent()[0].setBusy(false);n._oFlexBoxPreview.setBusy(false);n._oButtonExport.setEnabled(true);if(n._bMultipleBatches){n._oProgressIndicator.setPercentValue(100);setTimeout(function(){n._closeProgressIndicator(true)},500)}}else{return Promise.reject()}}).catch(function(){})}return g(t)};st.prototype.generatePdfAsync=function(t){var e=0;var i=this._getOriginalGanttChart().getTable()._getTotalRowCount()/this.iThreshold;this.bLast=i>1?false:true;var n=this;var o=0;var r=25/Math.ceil(i);function s(){if(n._bMultipleBatches){o+=r;n._oProgressIndicator.setPercentValue(o)}}function h(t){if(n._bCancel){return Promise.reject()}n._oClonedGanttDiv.style.height=gt+"px";var o=t*n.iThreshold;var r=n._getOriginalGanttChart().getTable()._getTotalRowCount();n.iThreshold=Math.min(n.iThreshold,r-o);n.bLast=e+1>=i?true:false;n._ganttChartClone.getTable().setRowMode(new et({rowCount:n.iThreshold}));n.bFirst=t===0?true:false;n._ganttChartClone.getTable().setFirstVisibleRow(o);if(a.getConfiguration().getRTL()){n._ganttChartClone._bRenderGanttClone=true}return n._ganttChartClone.getInnerGantt().resolveWhenReady(n._originalHasRenderedShapes)}function l(t){s();return h(t).then(function(){s();n._bExpandCollapse=true;return n._expandAndCollapse()}).then(function(){n._ganttChartClone._bExpandRows=true;s();return n._expandRowSettings()}).then(function(){n._ganttChartClone._bExpandRows=false;n._setCloneDivHeight();document.getElementById(n._ganttChartClone.getId()+"-sapGanttBackgroundTableContent").style.height=n._iContentHeight;document.getElementById(n._ganttChartClone.getTable().getId()+"-tableCCnt").style.height=n._iContentHeight;if(!n.bLast){s()}return n._createBatchList()}).then(function(t){return n._oDomToPrint.push(t)}).then(function(){if(t===0){n._ganttChartClone.setShowGanttHeader(false)}e=e+1;if(e<i){l(e)}else if(!n._bCancel){if(n._bMultipleBatches){n._oProgressIndicator.setPercentValue(100);setTimeout(function(){n._closeProgressIndicator(true)},500)}return n._generateSvgToPdf()}else{return Promise.reject()}}).catch(function(){})}return l(t)};st.prototype.open=function(t){if(!this.getGanttChart()||!this._getOriginalGanttChart().isA("sap.gantt.simple.GanttChartWithTable")){throw new Error("Association 'ganttChart' of type 'sap.gantt.simple.GanttChartWithTable' is not set")}var e=this;if(t){t(this._ganttChartClone.getTable())}this._createAndOpenDialog();this._oDialog.getContent()[0].setBusy(true);this._oButtonExport.setEnabled(false);if(this._ganttChartClone._enableOptimisation){this._ganttChartClone.setShowGanttHeader(true);return this._drawClonedGantt(false).then(function(){if(e._bMultipleBatches){e._openProgressDialog()}return e.generateCanvasAsync(0)}).catch(function(t){if(t&&t.bMaxCanvasSizeExceeded){e._updateDialogPreviewCanvas();e._oDialog.getContent()[0].setBusy(false)}})}else{if(a.getConfiguration().getRTL()){e._ganttChartClone._bRenderGanttClone=true}return this._drawClonedGantt(false).then(function(){e._bExpandCollapse=true;return e._expandAndCollapse()}).then(function(){e._ganttChartClone._bExpandRows=true;return e._expandRowSettings()}).then(function(){e._ganttChartClone._bExpandRows=false;e._setCloneDivHeightNonOptimised();document.getElementById(e._ganttChartClone.getId()+"-sapGanttBackgroundTableContent").style.height=e._iContentHeight;document.getElementById(e._ganttChartClone.getTable().getId()+"-tableCCnt").style.height=e._iContentHeight;return e._createGanttCanvas()}).then(function(t){e._oGanttCanvas=t;e._updateDialogPreview();e._oDialog.getContent()[0].setBusy(false);e._oButtonExport.setEnabled(true)}).catch(function(t){if(t&&t.bMaxCanvasSizeExceeded){e._updateDialogPreviewCanvas();e._oDialog.getContent()[0].setBusy(false)}})}};st.prototype.openPdfPreview=function(t){if(!this.getGanttChart()||!this._getOriginalGanttChart().isA("sap.gantt.simple.GanttChartWithTable")){throw new Error("Association 'ganttChart' of type 'sap.gantt.simple.GanttChartWithTable' is not set")}this._oDomToPrint=[];this._oDomToPrintHeight=0;this._oDomToPrintWidth=0;var e=this;if(t){t(this._ganttChartClone.getTable())}this._createAndOpenDialog(true);this._oDialog.getContent()[0].setBusy(true);this._oButtonExport.setEnabled(false);this._ganttChartClone.setShowGanttHeader(true);return this._drawClonedGantt(true).then(function(){if(e._bMultipleBatches){e._openProgressDialog()}return e.generatePdfAsync(0)}).catch(function(t){if(t){e._oDialog.getContent()[0].setBusy(false)}})};st.prototype.close=function(){var t=this._getOriginalGanttChart();if(this._initialDisplayType===ot.Table){t.setSelectionPanelSize(this._initialSelectionPanelSize);t.setDisplayType(this._initialDisplayType);if(t.getParent()&&t.getParent().isA("sap.gantt.simple.GanttChartContainer")&&t.getParent().getToolbar()){t.getParent().getToolbar()._oDisplayTypeSegmentedButton.setSelectedKey(ot.Table)}}this._ganttChartClone.destroy();this._ganttChartClone=null;this._ganttChartContainer.destroy();this._ganttChartContainer=null;document.body.removeChild(this._oClonedGanttDiv);V.deregister(this._sResizeHandlerId);if(this._oPdfPreview){this._oPdfPreview.destroy()}this._oDialog.close();this._oDialog.destroy();if(Q.browser.safari){t.getInnerGantt().invalidate()}};st.prototype._closeProgressIndicator=function(t){this._oProgressDialog.close();this._oProgressDialog.destroy();this._bCancel=true;if(!this._bUpdateGanttCanvas&&!t){this.close()}};st.prototype.setGanttChart=function(t){this.setAssociation("ganttChart",t);this._initialDisplayType=t.getDisplayType();this._initialSelectionPanelSize=t._iLastTableAreaSize?t._iLastTableAreaSize:t.getSelectionPanelSize();var e=this._initialDisplayType===ot.Table?true:false;if(e){t.setSelectionPanelSize("100%");t.setDisplayType(ot.Both)}this._ganttChartClone=t.clone();this._ganttChartClone._enableOptimisation=t.getPrintingBatchSize()>0?true:false;this._bUpdateGanttCanvas=false;this._bCancel=false;this._ganttChartClone.setEnableChartOverflowToolbar(false);this.canvasScale=2;if(this._ganttChartClone._enableOptimisation){this._ganttChartClone.getTable().destroyExtension();var i=e?1:Math.max(t.getAxisTimeStrategy().getZoomLevel(),1);this.iThreshold=Math.min(Math.round(t.getPrintingBatchSize()/i),t.getTable()._getTotalRowCount());this._bMultipleBatches=t.getTable()._getTotalRowCount()>this.iThreshold;this.bFirst=true;this._ganttChartClone.getTable().setRowMode(new et({rowCount:this.iThreshold}));this._ganttChartClone.getTable().setThreshold(this.iThreshold);this._ganttChartClone.setParent(this._getOriginalGanttChart(),"originalGanttChart",true)}else{this._ganttChartContainer.setParent(this._getOriginalGanttChart(),"originalGanttChart",true)}this._addBackOriginalGanttRowBinding(this._ganttChartClone,t);this._originalHasRenderedShapes=t.getInnerGantt().hasRenderedShapes();this._ganttChartClone.mEventRegistry={};this._ganttChartClone.setHeight("100%");var a=t._oSplitter._calculatedSizes[0];if(this._initialDisplayType===ot.Chart){this._ganttChartClone.setProperty("selectionPanelSize","1px",true)}else{this._ganttChartClone.setProperty("selectionPanelSize",a.toString()+"px",true)}var n=t.getAxisTimeStrategy();if(!n.isA("sap.gantt.axistime.FullScreenStrategy")&&!e){t.isPrint=true;t._getScrollExtension()._updateVisibleHorizonForce();var o=this._ganttChartClone.getAxisTimeStrategy();o.setTotalHorizon(n.getTotalHorizon());o.setVisibleHorizon(n.getTotalHorizon())}var r=n.getVisibleHorizon();var s=this._getHorizonDates(r);var h=this._horizonWidthInSec(s);this._fPixelsBySec=t.getVisibleWidth()/h;this._ganttChartClone.isPrint=true;this._ganttChartClone._bClonedGantt=true;if(!this._ganttChartClone._enableOptimisation){this._ganttChartContainer.addGanttChart(this._ganttChartClone)}return this};st.prototype._expandAndCollapse=function(){var t=this;return this._expandAndCollapseRow().then(function(){if(t._bExpandCollapse){return t._expandAndCollapse()}else{return Promise.resolve()}})};st.prototype._expandAndCollapseRow=function(){if(this._bCancel){this._bExpandCollapse=false;return Promise.reject()}var t=this._getOriginalGanttChart().getTable();if(!t.isA("sap.ui.table.TreeTable")){this._bExpandCollapse=false;return this._ganttChartClone.getInnerGantt().resolveWhenReady(this._originalHasRenderedShapes)}var e=t.getBinding("rows"),i=this._ganttChartClone.getTable().getBinding("rows");for(var a=0;a<e.getLength();a++){if(i.findNode(a)!==undefined&&e.isExpanded(a)&&!i.isExpanded(a)){i.expand(a);return this.renderGanttClone(true)}else if(i.findNode(a)!==undefined&&!e.isExpanded(a)&&i.isExpanded(a)){i.collapse(a);return this.renderGanttClone(true)}}this._bExpandCollapse=false;return Promise.resolve()};st.prototype._expandRowSettings=function(){if(this._bCancel){return Promise.reject()}var t=this._ganttChartClone.getUseParentShapeOnExpand();var e=this._ganttChartClone.getShapeSchemes().find(function(e){return t?e.getPrimary():!e.getPrimary()});var i=this._getOriginalGanttChart();var a=i.oOverlapShapeIds;var n=i._aExpandedIndices,o=[];var r=this._ganttChartClone.getEnablePseudoShapes();if(r){for(var s in a){if(a[s].length>0){o.push(parseInt(s,10))}}if(o.length>0){n=n.filter(function(t){return o.indexOf(t)==-1})}}if(n){var h;var l=0,g=Object.keys(i._oExpandModel.mExpanded);var p=g.length;while(!h&&l!=p){var _=g[l];if(!i._oExpandModel.mExpanded[_][1].expandSchemeShape){h=i._oExpandModel.mExpanded[_]}l++}h=h?h:[];var d=[];h.forEach(function(t){d.push(t.scheme)})}var u=d&&d.length?d:e&&e.getKey();if(u){if(!this._ganttChartClone._aExpandedIndices||this._ganttChartClone._aExpandedIndices.length===0){this._ganttChartClone.expand(u,n)}}if(r&&!this._ganttChartClone.oOverlapShapeIds){o.forEach(function(t){this._oPseudoShape=null;this._expandPseudoShapeInRow(t)}.bind(this))}return this._ganttChartClone.getInnerGantt().resolveWhenReady(this._originalHasRenderedShapes)};st.prototype._expandPseudoShapeInRow=function(t){if(this._bCancel){return Promise.reject()}var e=this._ganttChartClone.getTable();var i=e.getRows()[t];var a=i?i.getAggregation("_settings"):null;var n=this._getOriginalGanttChart().oOverlapShapeIds[t];if(a){var o=Y.getAllNonLazyAggregations(a);var r=Object.keys(o).filter(function(t){return t.indexOf("calendars")===-1&&t!=="relationships"}).map(function(t){return a.getAggregation(t)||[]});r.forEach(function(t){if(t&&t.length>0&&!this._oPseudoShape){var e=0;while(e<t.length&&!this._oPseudoShape){var i=t[e];if(i.isPseudoShape){var a=i.aShapeIds;if(n.indexOf(a[0])!==-1){this._oPseudoShape=i;i.onclick()}}e++}}}.bind(this))}};st.prototype._onResize=function(){var t=this._oHTMLDialogPreview.getDomRef();t.style.overflow="hidden";this._resizePrintingPreviewPage();t.style.overflow="visible"};function ut(t){return t*3.78}function ct(t){return t/3.78}function Ct(t){return t/.01042}function Pt(t){return t*.01042}st.prototype._convertUnitToPx=function(t){var e=this._oModel.getProperty("/unit");if(!e){return undefined}switch(e){case"mm":return ut(t);case"cm":return ut(t)*10;case"in":return Ct(t);default:return undefined}};st.prototype._convertPxToUnit=function(t){var e=this._oModel.getProperty("/unit");if(!e){return undefined}switch(e){case"mm":return ct(t);case"cm":return ct(t)/10;case"in":return Pt(t);default:return undefined}};st.prototype._onChangeUnitComboBox=function(){this._updatePaperSizeInputs();this._updateMarginInputs()};st.prototype._updatePaperSizeInputs=function(){var t=this._oModel.getProperty("/paperWidth"),e=this._oModel.getProperty("/paperHeight");this._setPaperSizeInputs(t,e)};st.prototype._setPaperSizeInputs=function(t,e){if(this._oInputPaperWidth){this._oInputPaperWidth.setValue(this._convertPxToUnit(t))}if(this._oInputPaperHeight){this._oInputPaperHeight.setValue(this._convertPxToUnit(e))}};st.prototype._setPaperSizesToModel=function(t,e){this._oModel.setProperty("/paperWidth",t);this._oModel.setProperty("/paperHeight",e)};st.prototype._updatePaperSizeValues=function(t,e){var i=this._oModel.getProperty("/paperSize"),a=this._oModel.getProperty("/portrait"),n,o;if(!i||i==="Custom"){return}var r=st._oPaperSizes[i];if(a){n=r.width;o=r.height}else{n=r.height;o=r.width}this._setPaperSizeInputs(n,o);this._setPaperSizesToModel(n,o);if(i==="Letter"||i==="Legal"||i==="Tabloid"){this._oComboBoxUnit.setSelectedKey("in")}else{this._oComboBoxUnit.setSelectedKey("mm")}this._onChangeUnitComboBox();if(t){this._generateSvgToPdf()}else{this._updateDialogPreview()}};st.prototype._updatePaperOrientation=function(t){var e=this._oModel.getProperty("/paperWidth"),i=this._oModel.getProperty("/paperHeight");if(i>e){this._oModel.setProperty("/portrait",true);this._radioGroupOrientation.setSelectedIndex(0)}else{this._oModel.setProperty("/portrait",false);this._radioGroupOrientation.setSelectedIndex(1)}};st.prototype._onChangePaperSizeInput=function(t,e){var i=e.getSource();var a=this._convertUnitToPx(n.getFloatInstance({groupingSeparator:",",decimalSeparator:"."}).parse(i.getValue()));if(i===this._oInputPaperWidth){this._oModel.setProperty("/paperWidth",a)}else{this._oModel.setProperty("/paperHeight",a)}this._oComboBoxPaperSizes.setSelectedKey("Custom");this._updatePaperOrientation();if(t){this._generateSvgToPdf()}else{this._updateDialogPreview()}};st.prototype._onChangeCompressionSlider=function(t){var e=t.getSource();var i=e.getValue();this._setCompressionComboBoxItem(i)};st.prototype._setCompressionComboBoxItem=function(t){if(t===100){this._oComboBoxCompression.setSelectedKey("maximum")}else if(t>=75){this._oComboBoxCompression.setSelectedKey("high")}else if(t>=50){this._oComboBoxCompression.setSelectedKey("medium")}else{this._oComboBoxCompression.setSelectedKey("low")}};st.prototype._onChangeCompressionComboBox=function(t){var e=t.getSource().getSelectedKey();var i={maximum:100,high:75,medium:50,low:25};this._oModel.setProperty("/compressionQuality",i[e])};st.prototype._onChangeOrientation=function(t,e){var i=this._oModel.getProperty("/paperWidth"),a=this._oModel.getProperty("/paperHeight");this._setPaperSizeInputs(a,i);this._setPaperSizesToModel(a,i);if(t){this._generateSvgToPdf()}else{this._updateDialogPreview()}};st.prototype._onChangeExportTypes=function(){this._updateDialogPreview()};st.prototype._setMarginInputs=function(t,e,i,a){this._oInputMarginTop.setValue(this._convertPxToUnit(t));this._oInputMarginRight.setValue(this._convertPxToUnit(e));this._oInputMarginBottom.setValue(this._convertPxToUnit(i));this._oInputMarginLeft.setValue(this._convertPxToUnit(a))};st.prototype._setMarginsToModel=function(t,e,i,a){if(t!==undefined){this._oModel.setProperty("/marginTop",t)}if(e!==undefined){this._oModel.setProperty("/marginRight",e)}if(i!==undefined){this._oModel.setProperty("/marginBottom",i)}if(a!==undefined){this._oModel.setProperty("/marginLeft",a)}};st.prototype._onChangeMarginComboBox=function(t,e){var i=e.getSource().getSelectedKey();var a=ut(5);if(i==="none"){a=0}this._setMarginsToModel(a,a,a,a);this._setMarginInputs(a,a,a,a);if(t){this._generateSvgToPdf()}else{this._updateDialogPreview()}};st.prototype._updateModelFromMarginInputs=function(){var t,e,i,a;if(this._oInputMarginTop.getValueState()!=="Error"){t=this._convertUnitToPx(this._oInputMarginTop.getValue())}if(this._oInputMarginRight.getValueState()!=="Error"){e=this._convertUnitToPx(this._oInputMarginRight.getValue())}if(this._oInputMarginBottom.getValueState()!=="Error"){i=this._convertUnitToPx(this._oInputMarginBottom.getValue())}if(this._oInputMarginLeft.getValueState()!=="Error"){a=this._convertUnitToPx(this._oInputMarginLeft.getValue())}this._setMarginsToModel(t,e,i,a)};st.prototype._updateMarginInputs=function(){var t=this._oModel.getProperty("/marginTop");var e=this._oModel.getProperty("/marginRight");var i=this._oModel.getProperty("/marginBottom");var a=this._oModel.getProperty("/marginLeft");this._setMarginInputs(t,e,i,a)};st.prototype._updateCropMarksOffsetInput=function(){var t=this._oModel.getProperty("/cropMarksOffset");this._oInputCropMarksOffset.setValue(this._convertPxToUnit(t))};st.prototype._onChangeMarginInput=function(t,e){var i=e.getSource();if(i.getValueState()==="Error"){return}if(this._oModel.getProperty("/marginLocked")){var a=this._convertUnitToPx(i.getValue());this._setMarginInputs(a,a,a,a);this._setMarginsToModel(a,a,a,a)}else{this._updateModelFromMarginInputs()}if(t){this._generateSvgToPdf()}else{this._updateDialogPreview()}};st.prototype._onChangeCropMarksInput=function(t){var e=t.getSource();var i=this._convertUnitToPx(e.getValue());this._oInputCropMarksOffset.setValue(this._convertPxToUnit(i));this._oModel.setProperty("/cropMarksOffset",i)};st.prototype._allRange=function(){this._oModel.setProperty("/startDate",this._oDatePickerFrom.getMinDate());this._oModel.setProperty("/endDate",this._oDatePickerTo.getMaxDate())};st.prototype._getFirstDayOfNextWeek=function(t){var e=this._getOriginalGanttChart().getAxisTimeStrategy().getFirstDayOfWeek();var i=(e+7-t.getDay())%7;return new Date(t.getFullYear(),t.getMonth(),t.getDate()+(i===0?7:i))};st.prototype._nextWeekRange=function(){var t=new Date;var e=this._getFirstDayOfNextWeek(t);this._oModel.setProperty("/startDate",this._validateDate(e));this._oModel.setProperty("/endDate",this._validateDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+7)))};st.prototype._getFirstDayOfNextMonth=function(t){return new Date(t.getFullYear(),t.getMonth()+1,1)};st.prototype._nextMonthRange=function(){var t=new Date;this._oModel.setProperty("/startDate",this._validateDate(this._getFirstDayOfNextMonth(t)));this._oModel.setProperty("/endDate",this._validateDate(new Date(t.getFullYear(),t.getMonth()+2,1)))};st.prototype._validateDate=function(t){var e=this._oDatePickerTo.getMaxDate(),i=this._oDatePickerFrom.getMinDate();if(t.getTime()>e.getTime()){return e}if(t.getTime()<i.getTime()){return i}return t};st.prototype._onChangeDurationComboBox=function(t){var e=this._oModel.getProperty("/duration");switch(e){case"all":{this._allRange()}break;case"week":{this._nextWeekRange()}break;case"month":{this._nextMonthRange()}break;case"custom":default:return}if(t){this._updateGanttPdf()}else{this._updateGanttCanvas()}};st.prototype._onChangeDurationDatePicker=function(t){this._oComboBoxDuration.setSelectedKey("custom");if(this._oDatePickerFrom.isValidValue()&&this._oDatePickerTo.isValidValue()){if(this._oDatePickerFrom.getDateValue().getTime()<=this._oDatePickerTo.getDateValue().getTime()){this._oDatePickerFrom.setValueState(rt.None);this._oDatePickerTo.setValueState(rt.None);if(t){this._updateGanttPdf()}else{this._updateGanttCanvas()}}else{this._oDatePickerFrom.setValueState(rt.Error);this._oDatePickerTo.setValueState(rt.Error)}}else{var e=this._oDatePickerFrom.isValidValue()?rt.None:rt.Error;var i=this._oDatePickerTo.isValidValue()?rt.None:rt.Error;this._oDatePickerFrom.setValueState(e);this._oDatePickerTo.setValueState(i)}};st.prototype._setEnabledPreviousButtons=function(t){this._oButtonFirst.setEnabled(t);this._oButtonPrevious.setEnabled(t)};st.prototype._setEnabledNextButtons=function(t){this._oButtonNext.setEnabled(t);this._oButtonLast.setEnabled(t)};st.prototype._updatePageNumberButtons=function(){if(!this._oGanttCanvas){this._setEnabledNextButtons(false);this._setEnabledPreviousButtons(false);return}var t=this._oModel.getProperty("/previewPageNumber"),e=this._oModel.getProperty("/lastPageNumber");if(!e){e=Number.MAX_SAFE_INTEGER}if(t<=1){this._setEnabledPreviousButtons(false)}if(t>=e){this._setEnabledNextButtons(false)}if(t>1){this._setEnabledPreviousButtons(true)}if(t<e){this._setEnabledNextButtons(true)}};st.prototype._getHeaderHeight=function(){var t=this._oModel.getProperty("/showHeaderText");if(t){return this._iHeaderAndFooterHeight}return 0};st.prototype._isFooterMultiline=function(){if(!this._oModel.getProperty("/multiplePage")){return false}var t=this._oModel.getProperty("/showPageNumber"),e=this._oModel.getProperty("/showFooterText");if(!e||!t){return false}var i=this._oModel.getProperty("/footerText"),n=this._oModel.getProperty("/paperWidth"),o;var r=a.getConfiguration().getRTL();if(r){o=this._oModel.getProperty("/marginRight")}else{o=this._oModel.getProperty("/marginLeft")}var s=7;var h=this._oGanttCanvas.getContext("2d");h.font=ht;var l=h.measureText(i).width;if(n/2>o+ut(4)+l+ut(10)+s){return false}else{return true}};st.prototype._getFooterHeight=function(){var t=this._oModel.getProperty("/showPageNumber"),e=this._oModel.getProperty("/showFooterText");if(e&&t){return this._isFooterMultiline()?2*this._iHeaderAndFooterHeight:this._iHeaderAndFooterHeight}if(e||t){return this._iHeaderAndFooterHeight}return 0};st.prototype._isShrinkableToOnePageByWidth=function(){var t=this._getPaperContentWidth()/this._getPaperContentHeight(),e=this._oGanttCanvas.width/this._oGanttCanvas.height;return t<=e};st.prototype._isDomShrinkableToOnePageByWidth=function(t,e){var i=this._getPaperContentWidth()/this._getPaperContentHeight(),a=e/t;return i<=a};st.prototype._getPaperContentWidth=function(){var t=this._oModel.getProperty("/paperWidth"),e=this._oModel.getProperty("/marginLeft"),i=this._oModel.getProperty("/marginRight");return t-e-i};st.prototype._getPaperContentHeight=function(){var t=this._oModel.getProperty("/paperHeight"),e=this._oModel.getProperty("/marginTop"),i=this._oModel.getProperty("/marginBottom");return t-e-this._getHeaderHeight()-i-this._getFooterHeight()};st.prototype._getScale=function(){return 100/this._oModel.getProperty("/scale")*2};st.prototype._getCroppingWidth=function(){return this._getScale()*this._getPaperContentWidth()};st.prototype._getCroppingHeight=function(){return this._getScale()*this._getPaperContentHeight()};st.prototype._getPagesInARow=function(){return Math.ceil(this._oGanttCanvas.width/this._getCroppingWidth())};st.prototype._getPagesInAColumn=function(){return Math.ceil(this._oGanttCanvas.height/this._getCroppingHeight())};st.prototype._updateLastPageNumber=function(){if(!this._oGanttCanvas){return}var t=this._getPagesInARow()*this._getPagesInAColumn();this._oModel.setProperty("/lastPageNumber",t);var e=this._oModel.getProperty("/previewPageNumber");if(e>t){this._oModel.setProperty("/previewPageNumber",t)}};st.prototype._onPressButtonFirst=function(){this._oModel.setProperty("/previewPageNumber",1);this._updatePageNumberButtons();this._updateDialogPreviewCanvas()};st.prototype._onPressButtonPrevious=function(){var t=this._oModel.getProperty("/previewPageNumber");this._oModel.setProperty("/previewPageNumber",t-1);this._updatePageNumberButtons();this._updateDialogPreviewCanvas()};st.prototype._onPressButtonNext=function(){var t=this._oModel.getProperty("/previewPageNumber");this._oModel.setProperty("/previewPageNumber",t+1);this._updatePageNumberButtons();this._updateDialogPreviewCanvas()};st.prototype._onPressButtonLast=function(){var t=this._oModel.getProperty("/lastPageNumber");if(!t){return}this._oModel.setProperty("/previewPageNumber",t);this._updatePageNumberButtons();this._updateDialogPreviewCanvas()};st.prototype._getOriginalGanttChart=function(){return a.byId(this.getAssociation("ganttChart"))};st.prototype._getGanttCloneDivWidth=function(t){var e=this._getOriginalGanttChart(),i=this._getHorizonDates(t),a=this._horizonWidthInSec(i),n=Math.ceil(this._fPixelsBySec*a);var o=e.getDisplayType()===ot.Both?e.getTable().getDomRef().offsetWidth:0;return o+n+10};st.prototype._setGanttCloneDivWidth=function(t){this._oClonedGanttDiv.style.width=this._getGanttCloneDivWidth(t).toString()+"px"};st.prototype._setGanttCloneDivHeight=function(){this._oClonedGanttDiv.style.height=this._getGanttCloneDivHeight().toString()+"px"};st.prototype._getGanttCloneDivHeight=function(){var t=this._getOriginalGanttChart().getTable();var e=t._getTotalRowCount(),i=t._aRowHeights;var a=i.reduce(function(t,e){return t+e});var n=Math.ceil(a/i.length*e);this._iGanttHeight=n+102;return this._iGanttHeight};st.prototype._setCloneDivHeight=function(){var t=this.bFirst?document.getElementById(this._ganttChartClone.getId()+"-header-svg").height.baseVal.value:0;var e=this._ganttChartClone.getTable().getRowMode().getRowCount();var i=0;var a=this.bLast?3:0;var n=this._ganttChartClone.getTable().getRows()[0].getIndex();var o=this._ganttChartClone.getTable().getFirstVisibleRow();var r=Math.abs(n-o);var s=this._ganttChartClone.getTable()._aRowHeights;for(var h=r;h<e+r;h++){i=i+s[h]}this._iContentHeight=i+"px";this._oClonedGanttDiv.style.height=(i+t+a).toString()+"px"};st.prototype._setCloneDivHeightNonOptimised=function(){var t=document.getElementById(this._ganttChartClone.getId()+"-header-svg").height.baseVal.value;var e=this._ganttChartClone.getTable()._getTotalRowCount();var i=1;var a=this._ganttChartClone.getTable()._aRowHeights;for(var n=0;n<e;n++){var o=a[n]?a[n]:0;i=i+o}this._iContentHeight=i.toString()+"px";this._oClonedGanttDiv.style.height=(i+t).toString()+"px"};st.prototype._createImgElementsFromSvgImages=function(){var t=this._ganttChartClone.$().find("svg.sapGanttChartSvg");if(!t.length){return}var e=this._ganttChartClone.$().find(".sapGanttChartCnt")[0];if(!e){return}e.style.position="relative";var i=t.find("image");for(var a=0;a<i.length;a++){var n=i[a];var o=document.createElement("img");o.src=n.getAttribute("href");o.style.position="absolute";o.style.top=n.getAttribute("y")+"px";o.style.left=n.getAttribute("x")+"px";o.style.width=n.getAttribute("width")+"px";o.style.height=n.getAttribute("height")+"px";e.appendChild(o)}};st.prototype._createGanttCanvas=function(){if(this._bCancel){return Promise.reject()}this._setStyleToGanttChartSvg(this._ganttChartClone);this._createImgElementsFromSvgImages();return j(this._oClonedGanttDiv,{allowTaint:true,scale:this.canvasScale,logging:false})};st.prototype._createBatchList=function(){if(this._bCancel){return Promise.reject()}this._setStyleToGanttChartSvg(this._ganttChartClone);this._oDomToPrintHeight+=Number(this._oClonedGanttDiv.style.height.slice(0,-2));this._oDomToPrintWidth=Number(this._oClonedGanttDiv.style.width.slice(0,-2));return this._oClonedGanttDiv.cloneNode(true)};st.prototype._updateGanttPdf=function(){if(this._initialDisplayType===ot.Table){return}var t=this._oModel;var e=this._ganttChartClone.getAxisTimeStrategy();var i=e.getVisibleHorizon().clone();var a=e.getTotalHorizon().clone();i.setStartTime(t.getProperty("/startDate"));i.setEndTime(t.getProperty("/endDate"));a.setStartTime(t.getProperty("/startDate"));a.setEndTime(t.getProperty("/endDate"));this._bCancel=false;this._oDomToPrint=[];this._oDomToPrintHeight=0;this._oDomToPrintWidth=0;if(!this._bMultipleBatches){this._oFlexBoxPreview.setBusy(true);this._oButtonExport.setEnabled(false)}this._setGanttCloneDivWidth(a);this._setGanttCloneDivHeight();e.setTotalHorizon(a);e.setVisibleHorizon(i);if(!this._ganttChartClone._enableOptimisation){this._ganttChartClone.invalidate()}this._ganttChartClone._bRenderGanttClone=true;var n=this._getOriginalGanttChart();var o=Math.max(n.getAxisTimeStrategy().getZoomLevel(),1);this.iThreshold=Math.min(Math.round(n.getPrintingBatchSize()/o),n.getTable()._getTotalRowCount());this._ganttChartClone.setShowGanttHeader(true);if(this._bMultipleBatches){this._openProgressDialog()}this._ganttChartClone._bRenderGanttClone=false;return this.generatePdfAsync(0)};st.prototype._updateGanttCanvas=function(){if(this._initialDisplayType===ot.Table){return}var t=this._oModel;var e=this._ganttChartClone.getAxisTimeStrategy();var i=e.getVisibleHorizon().clone();var a=e.getTotalHorizon().clone();i.setStartTime(t.getProperty("/startDate"));i.setEndTime(t.getProperty("/endDate"));a.setStartTime(t.getProperty("/startDate"));a.setEndTime(t.getProperty("/endDate"));var n=this._getGanttCloneDivHeight();var o=this._getGanttCloneDivWidth(a);if(o*this.canvasScale>gt||n*this.canvasScale>gt){this._oClonedGanttDiv.error=true;this._oGanttCanvas=undefined;this._updateDialogPreviewCanvas();this._oFlexBoxPreview.setBusy(false);return undefined}this._bUpdateGanttCanvas=true;this._bCancel=false;if(!this._bMultipleBatches){this._oFlexBoxPreview.setBusy(true);this._oButtonExport.setEnabled(false)}var r;if(!this._oClonedGanttDiv.id){this._oClonedGanttDiv.id="clonedGanttDiv";r=true;if(this._getOriginalGanttChart().$().closest(".sapUiSizeCompact").length>0){this._oClonedGanttDiv.classList.add("sapUiSizeCompact")}this._oClonedGanttDiv.style.position="absolute";this._oClonedGanttDiv.style.top="-17000px";this._oClonedGanttDiv.style.left="-17000px";if(this._ganttChartClone._enableOptimisation){this._ganttChartClone.placeAt("clonedGanttDiv")}else{this._ganttChartContainer.placeAt("clonedGanttDiv")}}this._setGanttCloneDivWidth(a);this._setGanttCloneDivHeight();if(r){r=false;this._addBackOriginalGanttRowBinding(this._ganttChartClone,this._getOriginalGanttChart())}e.setTotalHorizon(a);e.setVisibleHorizon(i);if(!this._ganttChartClone._enableOptimisation){this._ganttChartClone.invalidate()}this._ganttChartClone._bRenderGanttClone=true;if(this._ganttChartClone._enableOptimisation){var s=this._getOriginalGanttChart();var h=Math.max(s.getAxisTimeStrategy().getZoomLevel(),1);this.iThreshold=Math.min(Math.round(s.getPrintingBatchSize()/h),s.getTable()._getTotalRowCount());this._ganttChartClone.setShowGanttHeader(true);if(this._bMultipleBatches){this._openProgressDialog()}this._ganttChartClone._bRenderGanttClone=false;return this.generateCanvasAsync(0)}else{this._oClonedGanttDiv.style.height=this._iGanttHeight*2+"px";return this._ganttChartClone.getInnerGantt().resolveWhenReady(this._originalHasRenderedShapes).then(function(){this._ganttChartClone._bRenderGanttClone=false;return this.renderGanttClone().then(function(){this._setCloneDivHeightNonOptimised();document.getElementById(this._ganttChartClone.getId()+"-sapGanttBackgroundTableContent").style.height=this._iContentHeight;document.getElementById(this._ganttChartClone.getTable().getId()+"-tableCCnt").style.height=this._iContentHeight;this._createGanttCanvas().then(function(t){this._oGanttCanvas=t;this._updateDialogPreview();this._oFlexBoxPreview.setBusy(false)}.bind(this)).catch(function(){this._oFlexBoxPreview.setBusy(false)}.bind(this))}.bind(this))}.bind(this)).catch(function(){this._oFlexBoxPreview.setBusy(false)}.bind(this))}};st.prototype._drawClonedGantt=function(t){if(this._oClonedGanttDiv){return Promise.reject()}this._oClonedGanttDiv=document.createElement("div");document.body.appendChild(this._oClonedGanttDiv);var e=this._getGanttCloneDivHeight();var i=this._getGanttCloneDivWidth(this._ganttChartClone.getAxisTimeStrategy().getTotalHorizon());if(!t&&(i*this.canvasScale>gt||e*this.canvasScale>gt)){this._oClonedGanttDiv.error=true;return Promise.reject({bMaxCanvasSizeExceeded:true})}this._oClonedGanttDiv.id="clonedGanttDiv";if(this._getOriginalGanttChart().$().closest(".sapUiSizeCompact").length>0){this._oClonedGanttDiv.classList.add("sapUiSizeCompact")}this._oClonedGanttDiv.style.position="absolute";this._oClonedGanttDiv.style.top="-17000px";this._oClonedGanttDiv.style.left="-17000px";this._setGanttCloneDivWidth(this._ganttChartClone.getAxisTimeStrategy().getTotalHorizon());this._setGanttCloneDivHeight();var a=this._oModel;var n=this._ganttChartClone.getAxisTimeStrategy();n.getVisibleHorizon().setStartTime(a.getProperty("/startDate"));n.getVisibleHorizon().setEndTime(a.getProperty("/endDate"));if(this._ganttChartClone._enableOptimisation){this._ganttChartClone.placeAt("clonedGanttDiv")}else{this._ganttChartContainer.placeAt("clonedGanttDiv")}this._addBackOriginalGanttRowBinding(this._ganttChartClone,this._getOriginalGanttChart());if(this._ganttChartClone._enableOptimisation){return Promise.resolve()}else{this._oClonedGanttDiv.style.height=this._iGanttHeight*2+"px";return this._ganttChartClone.getInnerGantt().resolveWhenReady(this._originalHasRenderedShapes)}};st.prototype._addBackOriginalGanttRowBinding=function(t,e){var i=t.getTable();if(i.getBindingInfo("rows").binding==null){t.oPropagatedProperties=e._getPropertiesToPropagate();t.propagateProperties(true)}if(t.getEnablePseudoShapes()){var a=i.getRowSettingsTemplate();var n=e.getTable().getRowSettingsTemplate();if(a&&n.getBindingInfo("tasks")&&!a.getBindingInfo("tasks")){var o=J.prototype.clone.call(n);a.bindAggregation("tasks",o.getBindingInfo("tasks"))}}if(this._ganttChartClone._enableOptimisation){i.setRowMode(new et({rowCount:this.iThreshold}));i.setThreshold(this.iThreshold)}var r=e.getTable().getBinding("rows"),s=i.getBinding("rows");if(r){if(r.sCustomParams){s.sCustomParams=r.sCustomParams}if(r.aFilters&&r.aFilters.length>0){s.filter(r.aFilters)}if(r.aApplicationFilters&&r.aApplicationFilters.length>0){s.filter(r.aApplicationFilters,at.Application)}if(r.aSorters&&r.aSorters.length>0){s.sort(r.aSorters)}}};st.prototype._resizePrintingPreviewPage=function(){var t=this._oHTMLDialogPreview.getDomRef(),e=this._oHTMLDialogPreview.$().find(".sapGanttPrintingPreviewPageDiv")[0],i=t.offsetHeight,a=this._oModel.getProperty("/paperHeight"),n=this._oModel.getProperty("/paperWidth"),o=this._oModel.getProperty("/portrait"),r,s;if(o){r=i/a;s=n*r}else{r=i/n;s=i;i=a*r}e.style.width=s.toString()+"px";e.style.height=i.toString()+"px"};st.prototype._updateSinglePageMessages=function(t,e){if(e>t){this._oModel.setProperty("/orientationMessage",this._oRb.getText("GNT_PRNTG_SINGLE_PAGE_PORTRAIT"))}else{this._oModel.setProperty("/orientationMessage",this._oRb.getText("GNT_PRNTG_SINGLE_PAGE_LANDSCAPE"))}if(this._getPagesInARow()>3||this._getPagesInAColumn()>3){this._oModel.setProperty("/qualityWarning",true)}else{this._oModel.setProperty("/qualityWarning",false)}if(e>=t&&this._oModel.getProperty("/portrait")||e<=t&&!this._oModel.getProperty("/portrait")){this._oModel.setProperty("/showOrientationMessage",false)}else{this._oModel.setProperty("/showOrientationMessage",true)}};st.prototype._getCanvasOfPageN=function(t,e){var i=this._oModel.getProperty("/lastPageNumber");if(t>i){return null}var n=document.createElement("canvas");var o=n.getContext("2d");o.imageSmoothingEnabled=false;var r=this._getCroppingWidth(),s=this._getCroppingHeight();var h=this._getPagesInARow();var l=this._oModel.getProperty("/paperWidth"),g=this._oModel.getProperty("/paperHeight");var p=this._oModel.getProperty("/marginTop"),_=this._oModel.getProperty("/marginBottom"),d=this._oModel.getProperty("/marginLeft");var u=(t-1)%h,c=Math.floor((t-1)/h);n.width=l;n.height=g;if(!e){n.style.height="100%";n.style.width="auto"}o.fillStyle="white";o.fillRect(0,0,n.width,n.height);o.fillStyle=W.get("sapUiBaseText");o.textBaseline="middle";o.font=ht;var C;var P=a.getConfiguration().getRTL();if(P){o.textAlign="right";C=l-ut(4)}else{o.textAlign="left";C=ut(4)}var T=o.measureText("...").width;var m=l-ut(4)-T;var f,y,v,b;if(this._oModel.getProperty("/showHeaderText")){f=this._oModel.getProperty("/headerText");var x=o.measureText(f).width;if(x>l-ut(4)){v=$.geNumberOfTruncatedCharacters(x,m,f,o,o.measureText,true);if(P){b=f.length-v;f="..."+f.slice(b,f.length).trim()}else{f=f.slice(0,v).trim()+"..."}}o.fillText(f,C,this._iHeaderAndFooterHeight/2)}if(this._oModel.getProperty("/showFooterText")){y=this._oModel.getProperty("/footerText");var G=o.measureText(y).width;if(G>l-ut(4)){v=$.geNumberOfTruncatedCharacters(G,m,y,o,o.measureText,true);if(P){b=y.length-v;y="..."+y.slice(b,y.length).trim()}else{y=y.slice(0,v).trim()+"..."}}o.fillText(y,C,g-this._iHeaderAndFooterHeight/2-(this._isFooterMultiline()?this._iHeaderAndFooterHeight:0))}this._mHeaderFooterInfo={headerText:f,footerText:y,position:C};var w=this._oModel.getProperty("/showPageNumber"),S=this._oModel.getProperty("/multiplePage"),R;if(S&&w){o.font=lt;o.textAlign="center";o.fillText(t.toString(),l/2,g-_-this._iHeaderAndFooterHeight/2)}if(S){var N=u*r,D=c*s,M=0,E=0;var B=false;if(N+r>this._oGanttCanvas.width){B=true;r=this._oGanttCanvas.width-N;E=r/this._getScale()}var I=false;if(D+s>this._oGanttCanvas.height){I=true;s=this._oGanttCanvas.height-D;M=s/this._getScale()}R=(B?E:this._getPaperContentWidth())/r;if(R<.5&&e){var A=document.createElement("canvas");A.width=r;A.height=s;var L=A.getContext("2d");L.drawImage(this._oGanttCanvas,N,D,r,s,0,0,r,s);this._downScaleCanvas(A,o,R,0,0,A.width,A.height,d,p+this._getHeaderHeight())}else{o.drawImage(this._oGanttCanvas,N,D,r,s,d,p+this._getHeaderHeight(),B?E:this._getPaperContentWidth(),I?M:this._getPaperContentHeight())}}else{var H=this._getPaperContentWidth(),O=this._getPaperContentHeight();var F=this._isShrinkableToOnePageByWidth();var k;if(F){k=H/this._oGanttCanvas.width;O=this._oGanttCanvas.height*k}else{k=O/this._oGanttCanvas.height;H=this._oGanttCanvas.width*k}this._updateSinglePageMessages(H,O);R=H/this._oGanttCanvas.width;if(R<1&&e){this._downScaleCanvas(this._oGanttCanvas,o,R,0,0,this._oGanttCanvas.width,this._oGanttCanvas.height,d,p+this._getHeaderHeight())}else{o.drawImage(this._oGanttCanvas,0,0,this._oGanttCanvas.width,this._oGanttCanvas.height,d,p+this._getHeaderHeight(),H,O)}}return n};st.prototype._getFXTextPosition=function(){var t;var e=this._oModel.getProperty("/paperWidth");var i=a.getConfiguration().getRTL();if(i){t=e-ut(4)}else{t=ut(4)}return t/(i?Math.trunc(_t*10)/10:_t)};st.prototype._downScaleCanvas=function(t,e,i,a,n,o,r,s,h){var l=document.createElement("canvas");l.width=o;l.height=r;var g=l.getContext("2d");g.drawImage(t,a,n,o,r,0,0,o,r);var p=i*i;var _=Math.floor(o*i);var d=Math.floor(r*i);var u=0,c=0,C=0;var P=0,T=0,m=0,f=0;var y=0,v=0;var b=0,x=0,G=0;var w=0,S=0,R=0;var N=false,D=false;var M=l.getContext("2d").getImageData(0,0,o,r).data;var E=new Float32Array(3*_*d);var B=0,I=0,A=0;for(c=0;c<r;c++){T=c*i;v=0|T;m=3*v*_;D=v!==(0|T+i);if(D){G=v+1-T;R=T+i-v-1}for(u=0;u<o;u++,C+=4){P=u*i;y=0|P;f=m+y*3;N=y!==(0|P+i);if(N){x=y+1-P;S=P+i-y-1}B=M[C];I=M[C+1];A=M[C+2];if(!N&&!D){E[f]+=B*p;E[f+1]+=I*p;E[f+2]+=A*p}else if(!N&&D){b=G*i;E[f]+=B*b;E[f+1]+=I*b;E[f+2]+=A*b;w=R*i;E[f+3*_]+=B*w;E[f+3*_+1]+=I*w;E[f+3*_+2]+=A*w}else if(N&&!D){b=x*i;E[f]+=B*b;E[f+1]+=I*b;E[f+2]+=A*b;w=S*i;E[f+3]+=B*w;E[f+4]+=I*w;E[f+5]+=A*w}else{b=x*G;E[f]+=B*b;E[f+1]+=I*b;E[f+2]+=A*b;w=S*G;E[f+3]+=B*w;E[f+4]+=I*w;E[f+5]+=A*w;w=x*R;E[f+3*_]+=B*w;E[f+3*_+1]+=I*w;E[f+3*_+2]+=A*w;w=S*R;E[f+3*_+3]+=B*w;E[f+3*_+4]+=I*w;E[f+3*_+5]+=A*w}}}var L=document.createElement("canvas");L.width=_;L.height=d;var H=L.getContext("2d");var O=H.getImageData(0,0,_,d);var F=O.data;var k=0;for(C=0,f=0;k<_*d;C+=3,f+=4,k++){F[f]=0|E[C];F[f+1]=0|E[C+1];F[f+2]=0|E[C+2];F[f+3]=255}e.putImageData(O,s,h);return};function Tt(t){while(t.firstChild){t.removeChild(t.firstChild)}}st.prototype._createPreviewErrorMessageStrip=function(t){return new w({text:this._oRb.getText(t?"GNT_PRNTG_ERROR_TOOHIGHCHART":"GNT_PRNTG_ERROR_BIGCHART"),showIcon:true,type:"Error"})};st.prototype._updateDialogPreviewCanvas=function(){var t=this._oHTMLDialogPreview.$().find(".sapGanttPrintingPreviewPageDiv");var e=t[0];if(this._oGanttCanvas){this._oButtonExport.setEnabled(true);var i=this._oModel.getProperty("/multiplePage");if(i){this._oModel.setProperty("/qualityWarning",false);this._oModel.setProperty("/showOrientationMessage",false)}var a=this._getCanvasOfPageN(i?this._oModel.getProperty("/previewPageNumber"):1,false);Tt(e);this._resizePrintingPreviewPage();e.appendChild(a)}else if(!this._oGanttCanvas&&(this._oClonedGanttDiv.offsetWidth>gt||this._oClonedGanttDiv.offsetHeight>gt||this._oClonedGanttDiv.error)){this._oClonedGanttDiv.error=false;this._resizePrintingPreviewPage();this._oModel.setProperty("/qualityWarning",false);this._oModel.setProperty("/showOrientationMessage",false);if(!this._oHTMLDialogPreview.$().find("#"+this.getId()+"-previewErrorMessageStrip").length){Tt(e);if(!this._oPreviewErrorMessageStrip){this._oPreviewErrorMessageStrip=this._createPreviewErrorMessageStrip(this._oClonedGanttDiv.offsetHeight>gt)}var n=document.createElement("div");n.id=this.getId()+"-previewErrorMessageStrip";n.style.width="80%";e.appendChild(n);this._oPreviewErrorMessageStrip.placeAt(this.getId()+"-previewErrorMessageStrip")}}else{throw new Error("Gantt chart canvas does not exist.")}t.addClass("sapGanttPrintingPreviewPageDivBorder")};st.prototype._updateDialogPreview=function(){this._updateLastPageNumber();this._updatePageNumberButtons();this._updateDialogPreviewCanvas()};st.prototype._setStylesToDom=function(t){function e(t){if(t.style.fill.indexOf('url("#')===0){return}var e=getComputedStyle(t);var i,a,n,o;var r=["height","width","min-height","min-width"];var s="";for(i=0,a=e.length;i<a;i++){n=e[i];if(!(t instanceof SVGElement&&r.indexOf(n)>=0)){o=e.getPropertyValue(n);s+=n+":"+o+";"}}t.style=s}function i(t){e(t);i(t);function i(t){if(t&&t.hasChildNodes()){var a=t.firstChild;while(a){if(a.nodeType===1&&a.nodeName!="SCRIPT"){e(a);i(a)}a=a.nextSibling}}}}i(t)};st.prototype._setStyleToGanttChartSvg=function(t){var e=t.$().find("svg.sapGanttChartSvg")[0];var i=t.$().find("svg.sapGanttChartHeaderSvg")[0];if(e){this._setStylesToDom(e)}if(i){this._setStylesToDom(i)}};st.prototype._setStyleToGanttChartTable=function(t){var e=t.getElementsByClassName("sapUiTable")[0];if(e){this._setStylesToDom(e)}};st.prototype._getHorizonDates=function(t){var e=t.getStartTime();var i=t.getEndTime();return{startTime:new Date(D.abapTimestampToDate(e)),endTime:new Date(D.abapTimestampToDate(i))}};st.prototype._horizonWidthInSec=function(t){if(t&&t.startTime&&t.endTime){return t.endTime.getTime()-t.startTime.getTime()}return 0};st.prototype._pageToBeExported=function(){if(!this._oModel.getProperty("/multiplePage")){return[1]}var t=this._oModel.getProperty("/lastPageNumber"),e=this._oModel.getProperty("/exportAll"),i=[];if(e){for(var a=1;a<=t;a++){i.push(a)}return i}else{var o=this._oModel.getProperty("/exportRange");o=o.replace(/\s/g,"");var r=n.getIntegerInstance();var s=o.split(",");s.forEach(function(t){if(t.indexOf("-")!==-1){var e=t.split("-");var a=r.parse(e[0]);var n=r.parse(e[1]);for(var o=a;o<=n;o++){i.push(o)}}else{i.push(r.parse(t))}});return i}};st.prototype._validateFields=function(){var t=true;t&=this._validateExportRangeInput();t&=this._oInputMarginTop.getValueState()!=="Error";t&=this._oInputMarginRight.getValueState()!=="Error";t&=this._oInputMarginBottom.getValueState()!=="Error";t&=this._oInputMarginLeft.getValueState()!=="Error";return t};st.prototype._setStyleToPath=function(t){var e=["fill","fillOpacity","stroke","strokeWidth","strokeDasharray","strokeOpacity","opacity","transform"];var i=[];e.forEach(function(e){i.push(t.style[e])});t.removeAttribute("style");e.forEach(function(e,a){t.style[e]=i[a]})};st.prototype._updatePdfPreview=function(t){if(!this._oPdfPreview){var e=this._oPdfDialogPreview.getParent().getDomRef().offsetHeight-100;this._oPdfPreview=new Z({source:t,width:"94%",height:e.toString()+"px",showDownloadButton:false});jQuery.sap.addUrlWhitelist("blob");this._oPdfPreview.placeAt("sapGanttPdfPreviewDiv")}else{this._oPdfPreview.setSource(t)}this._oDialog.getContent()[0].setBusy(false);this._oFlexBoxPreview.setBusy(false);this._oButtonExport.setEnabled(true)};st.prototype._addClipRectDefs=function(t,e,i,a,n){var o=document.createElement("defs");t.appendChild(o);var r=document.createElement("clipPath");r.setAttribute("id","printClipRect");o.appendChild(r);var s=document.createElement("rect");s.setAttribute("x",e);s.setAttribute("y",i);s.setAttribute("width",a);s.setAttribute("height",n);r.appendChild(s)};st.prototype._generateSvgToPdf=function(){if(!this._validateFields()){return}this._oDialog.getContent()[0].setBusy(true);this._oFlexBoxPreview.setBusy(true);this._oButtonExport.setEnabled(false);var t=this;var e=this._oModel.getProperty("/portrait")?"p":"l",i=this._oModel.getProperty("/paperWidth"),n=this._oModel.getProperty("/paperHeight"),o=this._oModel.getProperty("/marginTop")*dt,r=this._oModel.getProperty("/marginRight")*dt,s=this._oModel.getProperty("/marginBottom")*dt,h=this._oModel.getProperty("/marginLeft")*dt,l=this._oModel.getProperty("/paperSize");var g=this._ganttChartClone;var p=g.getDisplayType()===ot.Both?g.getTable().getDomRef().offsetWidth:0;var _=new U({orientation:e,unit:"px",format:l==="Custom"?[i*dt,n*dt]:l.toLowerCase()});function d(){var e=document.createElement("svg");e.setAttribute("id","mergedSvg");var i=Number(this._oDomToPrint[0].style.width.slice(0,-2))-Number(this._oDomToPrint[0].getElementsByTagName("section")[0].style.width.slice(0,-2))-16;if(u===0){var a=this._oDomToPrint[u].getElementsByClassName("sapGanttChartHeaderSvg")[0].cloneNode(true);a.children[0].setAttribute("style","fill: "+W.get("sapUiListHeaderBackground")+";width: "+i);a.getElementsByTagName("rect")[1].setAttribute("width",i+"px");if(a.getElementById("inner-header-g")){a.getElementById("inner-header-g").children[0].setAttribute("width",i+"px")}var n=a.height.baseVal.value}var o=this._oDomToPrint[u].getElementsByClassName("sapGanttChartSvg")[0].cloneNode(true);var r=this._getOriginalGanttChart().getDomRef()?this._getOriginalGanttChart().getDomRef().getElementsByClassName("sapGanttChartSvgDefs"):null;var s=r&&r.length>0?r[0].cloneNode(true):null;if(o.getElementsByClassName("sapGanttChartVerticalLine")&&o.getElementsByClassName("sapGanttChartVerticalLine").length){var l=this._generateVerticalLines(this._ganttChartClone,o.height.baseVal.value);if(l){o.getElementsByClassName("sapGanttChartVerticalLine")[0].setAttribute("d",l);o.getElementsByClassName("sapGanttChartVerticalLine")[0].removeAttribute("style")}else{return}}o.removeAttribute("style");if(u===0){Array.prototype.slice.call(a.getElementsByTagName("path")).forEach(function(e){t._setStyleToPath(e)})}Array.prototype.slice.call(o.getElementsByClassName("sapGanttChartShapes")[0].getElementsByTagName("path")).forEach(function(e){t._setStyleToPath(e)});Array.prototype.slice.call(o.getElementsByClassName("sapGanttChartRls")[0].getElementsByTagName("path")).forEach(function(e){t._setStyleToPath(e)});if(o.getElementsByClassName("sapGanttBackgroundSVGRowBorder").length){Array.prototype.slice.call(o.getElementsByClassName("sapGanttBackgroundSVGRowBorder")).forEach(function(t){t.setAttribute("x2",i);t.setAttribute("y1",t.getAttribute("y1"));t.setAttribute("y2",t.getAttribute("y2"))})}if(o.getElementsByClassName("sapGanttBackgroundSVGRow").length){Array.prototype.slice.call(o.getElementsByClassName("sapGanttBackgroundSVGRow")).forEach(function(t){t.setAttribute("style","fill: "+W.get("sapUiListBackground")+";width: "+i)})}this._setLinesHeight(o);if(u===0){this._setCalenderDefsPosition(s,N,p);e.appendChild(a);o.setAttribute("y",n)}else{o.setAttribute("y",0)}e.appendChild(o);e.appendChild(s);this._addClipRectDefs(e,0,0,i,this._oDomToPrintHeight);e.setAttribute("clip-path","url(#printClipRect)");this._mHeaderFooterInfo["mergedSVG"]=e;var g=document.createElement("div");var c=this._oDomToPrint[u].getElementsByTagName("section")[0].cloneNode(true);g.appendChild(c);if(u===0){var C=this._oDomToPrint[u].getElementsByClassName("sapUiLoSplitterBar")[0].cloneNode(true);while(C.children.length>0){C.removeChild(C.firstChild)}var P=window.getComputedStyle(this._getOriginalGanttChart().getDomRef().getElementsByClassName("sapUiLoSplitterBar")[0]);var T=P.backgroundColor?P.backgroundColor:"#c9d8e7";C.setAttribute("style","background-color: "+T+";width: 1rem;display: inline-block; height: "+this._oDomToPrintHeight+"px");C.style.transform="translate("+p+"px, -"+this._oDomToPrint[u].style.height+")";g.appendChild(C)}_.html(g,{callback:function(i){var a=i.internal.getNumberOfPages();while(a>1){i.deletePage(a);a--}K(e,i,{xOffset:(p+16)*N+h,yOffset:D,scale:N});u++;if(u>=t._oDomToPrint.length){t.oSinglePagePdf=i;t._updatePdfPreview(i.output("bloburl"))}else{D=D+Number(t._oDomToPrint[u-1].style.height.slice(0,-2))*N;d.call(t)}},html2canvas:{scale:N,allowTaint:true},x:h,y:D})}var u=0;var c=0;var C=this._oDomToPrintHeight*2;var P=this._oDomToPrintWidth*2;_.setFontSize(6.5);var T=_.getTextWidth("...")*_t;var m=i-ut(4)-T;var f,y,v,b;var x=a.getConfiguration().getRTL();var G=x?"right":"left";if(this._oModel.getProperty("/showHeaderText")){f=this._oModel.getProperty("/headerText");c=c+this._iHeaderAndFooterHeight;var w=_.getTextWidth(f)*_t;if(w>i-ut(4)){v=$.geNumberOfTruncatedCharacters(w,m,f,_,_.getTextWidth,false,_t);if(x){b=f.length-v;f="..."+f.slice(b,f.length).trim()}else{f=f.slice(0,v).trim()+"..."}}_.text(f,this._getFXTextPosition(),this._iHeaderAndFooterHeight/(2*_t),G)}if(this._oModel.getProperty("/showFooterText")){y=this._oModel.getProperty("/footerText");c=c+this._iHeaderAndFooterHeight;var S=_.getTextWidth(y)*_t;if(S>i-ut(4)){v=$.geNumberOfTruncatedCharacters(S,m,y,_,_.getTextWidth,false,_t);if(x){b=y.length-v;y="..."+y.slice(b,y.length).trim()}else{y=y.slice(0,v).trim()+"..."}}_.text(y,this._getFXTextPosition(),_.getPageHeight()-this._iHeaderAndFooterHeight/(2*_t)-(this._isFooterMultiline()?this._iHeaderAndFooterHeight/_t:0),G)}this._mHeaderFooterInfo={oPdf:_,headerText:f,footerText:y,position:this._getFXTextPosition()};var R=this._isDomShrinkableToOnePageByWidth(C,P);var N=R?(i*dt-r-h)/this._oDomToPrintWidth:(n*dt-o-s-c)/this._oDomToPrintHeight;var D=o+t._getHeaderHeight();this._pageMargin=[o,r,s,h];if(this.sFont){_.addFileToVFS("SAP-icons.ttf",this.sFont);_.addFont("SAP-icons.ttf","SAP-icons","normal");_.setFont("SAP-icons");_.setFontSize(9);d.call(this)}else{var M=a.getConfiguration().getTheme(),E="base";if(M.indexOf("sap_horizon")>-1){E=M}var B=sap.ui.require.toUrl("sap/ui/core/themes/"+E+"/fonts/SAP-icons.ttf");this._fetchFontAndGeneratePdf(B,_,d)}};st.prototype._fetchFontAndGeneratePdf=function(t,e,i){var a=this;fetch(t).then(function(t){return t.blob()}).then(function(t){var n=new FileReader;n.onload=function(){if(n.readyState===n.DONE){a.sFont=n.result;e.addFileToVFS("SAP-icons.ttf",a.sFont);e.addFont("SAP-icons.ttf","SAP-icons","normal");e.setFont("SAP-icons");e.setFontSize(9);i.call(a)}};n.readAsBinaryString(t)}).catch(function(t){})};st.prototype._setLinesHeight=function(t){var e=t.height.baseVal.value;if(t.getElementsByClassName("sapGanttNowLineBodySvgLine").length){t.getElementsByClassName("sapGanttNowLineBodySvgLine")[0].getElementsByTagName("line")[0].setAttribute("y2",e)}if(t.getElementsByClassName("sapGanttChartAdhocLine").length){Array.prototype.slice.call(t.getElementsByClassName("sapGanttChartAdhocLine")[0].getElementsByTagName("line")).forEach(function(t){t.setAttribute("y2",e)})}if(t.getElementsByClassName("sapGanttChartDeltaLine").length){Array.prototype.slice.call(t.getElementsByClassName("sapGanttChartDeltaLine")[0].getElementsByTagName("line")).forEach(function(t){t.setAttribute("y2",e)})}if(t.getElementsByClassName("sapGanttChartAreaDeltaLine").length){Array.prototype.slice.call(t.getElementsByClassName("sapGanttChartAreaDeltaLine")[0].getElementsByTagName("rect")).forEach(function(t){t.setAttribute("height",e)})}};st.prototype._setCalenderDefsPosition=function(t,e,i){var a=this._oModel.getProperty("/marginRight"),n=this._oModel.getProperty("/marginLeft");Array.prototype.slice.call(t.getElementsByTagName("rect")).forEach(function(t){t.setAttribute("x",(Number(t.getAttribute("x"))+i)*e+(a+n)+32);t.setAttribute("width",Number(t.getAttribute("width"))*e)})};st.prototype._savePdf=function(){if(!this._validateFields()){return}var t=this._oModel.getProperty("/portrait")?"p":"l",e=this._oModel.getProperty("/paperWidth"),i=this._oModel.getProperty("/paperHeight"),a=this._oModel.getProperty("/exportAsJPEG"),n=this._oModel.getProperty("/compressionQuality")/100,o=this._oModel.getProperty("/paperSize");var r=new U({orientation:t,unit:"px",format:o==="Custom"?[e*dt,i*dt]:o.toLowerCase()});var s=this._pageToBeExported();for(var h=0;h<s.length;h++){var l=this._getCanvasOfPageN(s[h],true);if(!l){continue}if(h!==0){r.addPage()}if(a){r.addImage(l.toDataURL("image/jpeg",n),"JPEG",0,0)}else{r.addImage(l.toDataURL("image/png"),"PNG",0,0)}}this._downloadPdf(r)};st.prototype._downloadPdf=function(t){var e=new Date;t.save("GanttChartExport-"+e.toISOString()+".pdf")};st.prototype._generateVerticalLines=function(t,e){var i=Number(this._oDomToPrint[0].style.width.slice(0,-2))-Number(this._oDomToPrint[0].getElementsByTagName("section")[0].style.width.slice(0,-2)),a=t.getAxisTime();var n="";if(a){var o=a.getZoomStrategy();var r=a.getTickTimeIntervalLabel(o.getTimeLineOption(),null,[0,i]);var s=r[1];for(var h=0;h<s.length;h++){n+=" M"+" "+(s[h].value-1/2)+" 0"+" v "+e}}return n};st.prototype._createPaperComboBox=function(t){this._oComboBoxPaperSizes=new C({selectedKey:"{setting>/paperSize}",change:this._updatePaperSizeValues.bind(this,t),items:[new I({key:"A5",text:"A5"}),new I({key:"A4",text:"A4"}),new I({key:"A3",text:"A3"}),new I({key:"A2",text:"A2"}),new I({key:"A1",text:"A1"}),new I({key:"A0",text:"A0"}),new I({key:"Letter",text:this._oRb.getText("GNT_PRNTG_PAPER_SIZE_LETTER")}),new I({key:"Legal",text:this._oRb.getText("GNT_PRNTG_PAPER_SIZE_LEGAL")}),new I({key:"Tabloid",text:this._oRb.getText("GNT_PRNTG_PAPER_SIZE_TABLOID")}),new I({key:"Custom",text:this._oRb.getText("GNT_PRNTG_PAPER_SIZE_CUSTOM")})]});return this._oComboBoxPaperSizes};st.prototype._createPaperSizeFields=function(t){this._oUnitLabel=new L({text:this._oRb.getText("GNT_PRNTG_UNITS")});this._oUnitLabel.toStatic();this._oHeightLabel=new L({text:this._oRb.getText("GNT_PRNTG_HEIGHT")});this._oHeightLabel.toStatic();this._oWidthLabel=new L({text:this._oRb.getText("GNT_PRNTG_WIDTH")});this._oWidthLabel.toStatic();this._oInputPaperWidth=new p({type:"Number",change:this._onChangePaperSizeInput.bind(this,t),ariaLabelledBy:this._oWidthLabel});this._oInputPaperHeight=new p({type:"Number",change:this._onChangePaperSizeInput.bind(this,t),ariaLabelledBy:this._oHeightLabel});this._updatePaperSizeInputs();this._oComboBoxUnit=new C({selectedKey:"{setting>/unit}",change:this._onChangeUnitComboBox.bind(this),ariaLabelledBy:this._oUnitLabel,items:[new I({key:"mm",text:this._oRb.getText("GNT_PRNTG_MILLIMETERS")}),new I({key:"cm",text:this._oRb.getText("GNT_PRNTG_CENTIMETERS")}),new I({key:"in",text:this._oRb.getText("GNT_PRNTG_INCHES")})]});var e=new _({renderType:"Bare",direction:nt.Column,items:[new o({text:this._oRb.getText("GNT_PRNTG_WIDTH"),showColon:true}),this._oInputPaperWidth]}).addStyleClass("sapGanttPrintingSmallRightMargin");var i=new _({renderType:"Bare",direction:nt.Column,items:[new o({text:this._oRb.getText("GNT_PRNTG_HEIGHT"),showColon:true}),this._oInputPaperHeight]}).addStyleClass("sapGanttPrintingSmallLeftMargin");var a=new _({renderType:"Bare",direction:nt.Column,items:[new o({text:this._oRb.getText("GNT_PRNTG_UNITS"),showColon:true}),this._oComboBoxUnit]}).addStyleClass("sapGanttPrintingLeftMargin");var n=new _({renderType:"Bare",alignItems:"Center",justifyContent:"SpaceBetween",items:[e,new r({text:""}).addStyleClass("sapGanttPrintingTopMargin"),i]});return new _({renderType:"Bare",alignItems:"Center",justifyContent:"SpaceBetween",items:[n,a]})};st.prototype._createDurationComboBox=function(t){var e=this._getOriginalGanttChart().getAxisTimeStrategy(),i=e.getTotalHorizon(),a=new Date(D.abapTimestampToDate(i.getEndTime())),n=new Date;this._oComboBoxDuration=new C({selectedKey:"{setting>/duration}",change:this._onChangeDurationComboBox.bind(this,t),items:[new I({key:"all",text:this._oRb.getText("GNT_PRNTG_DURATION_ALL")}),new I({key:"week",enabled:this._getFirstDayOfNextWeek(n).getTime()<a.getTime(),text:this._oRb.getText("GNT_PRNTG_DURATION_NEXT_WEEK")}),new I({key:"month",enabled:this._getFirstDayOfNextMonth(n).getTime()<a.getTime(),text:this._oRb.getText("GNT_PRNTG_DURATION_NEXT_MONTH")}),new I({key:"custom",text:this._oRb.getText("GNT_PRNTG_DURATION_CUSTOM")})]});return this._oComboBoxDuration};st.prototype._createDatePicker=function(t){var e=this._getOriginalGanttChart().getAxisTimeStrategy();var i=this._getOriginalGanttChart().getLocale();var a=e.getTotalHorizon();var n=D.abapTimestampToDate(a.getStartTime());var s=D.abapTimestampToDate(a.getEndTime());this._oModel.setProperty("/startDate",n);this._oModel.setProperty("/endDate",s);this._oModel.setProperty("/timezone",i.getTimeZone());this._oStartDateLabel=new L({text:this._oRb.getText("GNT_PRNTG_START_DATE")});this._oEndDateLabel=new L({text:this._oRb.getText("GNT_PRNTG_END_DATE")});this._oStartDateLabel.toStatic();this._oEndDateLabel.toStatic();if(D._getEnableDateTimezoneFormatter()){this._oDatePickerFrom=new b({minDate:q.getInstance(n),maxDate:q.getInstance(s),dateValue:"{setting>/startDate}",change:this._onChangeDurationDatePicker.bind(this,t),enabled:true,ariaLabelledBy:this._oStartDateLabel});this._oDatePickerTo=new b({minDate:q.getInstance(n),maxDate:q.getInstance(s),dateValue:"{setting>/endDate}",change:this._onChangeDurationDatePicker.bind(this,t),enabled:true,ariaLabelledBy:this._oEndDateLabel})}else{this._oDatePickerFrom=new x({minDate:q.getInstance(n),maxDate:q.getInstance(s),value:{parts:[{path:"setting>/startDate",type:"sap.ui.model.odata.type.DateTimeOffset"},{path:"setting>/timezone",type:"sap.ui.model.odata.type.String"}],type:"sap.ui.model.odata.type.DateTimeWithTimezone"},change:this._onChangeDurationDatePicker.bind(this,t),enabled:true,timezone:i.getTimeZone(),showTimezone:false,ariaLabelledBy:this._oStartDateLabel});this._oDatePickerTo=new x({minDate:q.getInstance(n),maxDate:q.getInstance(s),value:{parts:[{path:"setting>/endDate",type:"sap.ui.model.odata.type.DateTimeOffset"},{path:"setting>/timezone",type:"sap.ui.model.odata.type.String"}],type:"sap.ui.model.odata.type.DateTimeWithTimezone"},change:this._onChangeDurationDatePicker.bind(this,t),enabled:true,ariaLabelledBy:this._oEndDateLabel,timezone:i.getTimeZone(),showTimezone:false})}var h=new _({renderType:"Bare",direction:nt.Column,items:[new o({text:this._oRb.getText("GNT_PRNTG_START_DATE"),showColon:true}),this._oDatePickerFrom]}).addStyleClass("sapGanttPrintingSmallRightMargin");var l=new _({renderType:"Bare",direction:nt.Column,items:[new o({text:this._oRb.getText("GNT_PRNTG_END_DATE"),showColon:true}),this._oDatePickerTo]}).addStyleClass("sapGanttPrintingSmallLeftMargin");return new _({renderType:"Bare",alignItems:"Center",justifyContent:"SpaceBetween",items:[h,new r({text:"~"}).addStyleClass("sapGanttPrintingTopMargin"),l]})};st.prototype._createScale=function(){return new f({min:50,max:200,step:1,width:"25rem",value:"{setting>/scale}",visible:"{setting>/multiplePage}",liveChange:this._updateDialogPreview.bind(this),showAdvancedTooltip:true,inputsAsTooltips:true})};st.prototype._validateExportRangeInput=function(){if(this._oModel.getProperty("/exportAll")){return true}var t=this._oModel.getProperty("/exportRange").replace(/\s/g,"");if(/^((\d+),|(\d+-\d+),)*((\d+)|(\d+-\d+))+$/.test(t)){this._oInputRange.setValueState("None");return true}this._oInputRange.setValueState("Error");this._oInputRange.setValueStateText(this._oRb.getText("GNT_PRNTG_PAGE_RANGE_ERROR"));return false};st.prototype._createPageRange=function(){this._oRangeLabel=new L({text:this._oRb.getText("GNT_PRNTG_PAGE_RANGE")});this._oRangeLabel.toStatic();var t=function(t){var e=t.getSource().getSelectedIndex();if(e===0){this._oButtonExport.setEnabled(true);this._oInputRange.setValueState("None")}};return new _({renderType:"Bare",alignItems:"Center",visible:"{setting>/multiplePage}",justifyContent:"SpaceBetween",items:[new T({layoutData:new u({shrinkFactor:0,growFactor:1}),selectedIndex:this._oModel.getProperty("/exportAll")?0:1,columns:2,select:t.bind(this),buttons:[new P({id:"all",text:this._oRb.getText("GNT_PRNTG_PAGE_RANGE_ALL"),selected:"{setting>/exportAll}",ariaLabelledBy:this._oRangeLabel}),new P({id:"range",text:this._oRb.getText("GNT_PRNTG_PAGE_RANGE_RANGE")+" ",ariaLabelledBy:this._oRangeLabel})]}),this._oInputRange=new p({layoutData:new u({growFactor:1}),value:"{setting>/exportRange}",change:this._validateExportRangeInput.bind(this),enabled:{path:"setting>/exportAll",formatter:function(t){return!t}},ariaLabelledBy:this._oRangeLabel}).addStyleClass("sapGanttPrintingPageRangeInput")]})};st.prototype._createLabelWithSwitch=function(t,e){this._oLabelWithSwitchLabel=new L({text:t});this._oLabelWithSwitchLabel.toStatic();this._oSwitch=new S({state:e,change:this._updateDialogPreview.bind(this),ariaLabelledBy:this._oLabelWithSwitchLabel});return new _({renderType:"Bare",visible:"{setting>/multiplePage}",alignItems:"Center",items:[new o({text:t,showColon:true}),this._oSwitch.addStyleClass("sapGanttPrintingSwitchPadding")]})};st.prototype._createCheckBoxWithInput=function(t,e,i,a){var n=a?this._generateSvgToPdf:this._updateDialogPreview;var o=this._onLiveChange.bind(this);var r=new p({width:"65%",value:i,enabled:e,valueLiveUpdate:true,valueStateText:this._oRb.getText("GNT_PRNTG_HEADER_FOOTER_TEXT_ERROR"),liveChange:function(){o(a,r,false)}});this._oHeaderFooterLabel=new L({text:this._oRb.getText("GNT_PRNTG_HEADER_AND_FOOTER")});this._oHeaderFooterLabel.toStatic();r.onsapfocusleave=function(){o(a,r,true)};return new _({renderType:"Bare",alignItems:"Start",justifyContent:"SpaceBetween",items:[new m({selected:e,text:t+":",select:n.bind(this),ariaLabelledBy:this._oHeaderFooterLabel}),r]})};st.prototype._onLiveChange=function(t,e,i){if(e.getValue().length>pt){e.setValue(e.getValue().slice(0,pt));e.setValueState("Error")}else{e.setValueState("None")}if(i){if(t){this._generateSvgToPdf()}else{this._updateDialogPreview()}}return};st.prototype._createPanel=function(t,e){return new R({expandable:true,expanded:false,headerText:t,content:[new _({renderType:"Bare",direction:nt.Column,items:[e]})]})};st.prototype._createCompressionSlider=function(){return new f({min:1,max:100,step:1,change:this._onChangeCompressionSlider.bind(this),value:{path:"setting>/compressionQuality",type:"sap.ui.model.type.Integer"},visible:"{setting>/exportAsJPEG}",showAdvancedTooltip:true,inputsAsTooltips:true})};st.prototype._createCompressionComboBox=function(){this._oComboBoxCompression=new C({visible:"{setting>/exportAsJPEG}",change:this._onChangeCompressionComboBox.bind(this),items:[new I({key:"maximum",text:this._oRb.getText("GNT_PRNTG_COMPRESSION_MAXIMUM")}),new I({key:"high",text:this._oRb.getText("GNT_PRNTG_COMPRESSION_HIGH")}),new I({key:"medium",text:this._oRb.getText("GNT_PRNTG_COMPRESSION_MEDIUM")}),new I({key:"low",text:this._oRb.getText("GNT_PRNTG_COMPRESSION_LOW")})]});var t=this._oModel.getProperty("/compressionQuality");this._setCompressionComboBoxItem(t);return this._oComboBoxCompression};st.prototype._updateInputsStep=function(t){var e=.1;if(t==="mm"){e=1}return e};st.prototype._createMargin=function(t){this._oMargin=new L({text:this._oRb.getText("GNT_PRNTG_MARGIN")});this._oMargin.toStatic();this._oMarginTop=new L({text:this._oRb.getText("GNT_PRNTG_MARGIN_TOP")});this._oMarginTop.toStatic();this._oMarginLeft=new L({text:this._oRb.getText("GNT_PRNTG_MARGIN_LEFT")});this._oMarginLeft.toStatic();this._oMarginBottom=new L({text:this._oRb.getText("GNT_PRNTG_MARGIN_BOTTOM")});this._oMarginBottom.toStatic();this._oMarginRight=new L({text:this._oRb.getText("GNT_PRNTG_MARGIN_RIGHT")});this._oMarginRight.toStatic();function e(t){return Math.round(this._convertPxToUnit(t/3))}return[new o({text:this._oRb.getText("GNT_PRNTG_MARGIN"),showColon:true}),this._oMarginComboBox=new C({change:this._onChangeMarginComboBox.bind(this,t),selectedKey:"{setting>/marginType}",ariaLabelledBy:this._oMargin,items:[new I({key:"default",text:this._oRb.getText("GNT_PRNTG_MARGIN_DEFAULT")}),new I({key:"none",text:this._oRb.getText("GNT_PRNTG_MARGIN_NONE")}),new I({key:"custom",text:this._oRb.getText("GNT_PRNTG_MARGIN_CUSTOM")})]}),new _({renderType:"Bare",alignItems:"Center",visible:{path:"setting>/marginType",formatter:function(t){return t==="custom"}},items:[new _({direction:nt.Column,layoutData:new u({shrinkFactor:0,growFactor:0,baseSize:"8rem"}),items:[new o({text:this._oRb.getText("GNT_PRNTG_MARGIN_TOP"),showColon:true}),this._oInputMarginTop=new v({min:0,step:{path:"setting>/unit",formatter:this._updateInputsStep},displayValuePrecision:1,change:this._onChangeMarginInput.bind(this,t),value:this._convertPxToUnit(this._oModel.getProperty("/marginTop")),fieldWidth:"7rem",validationMode:"LiveChange",valueStateText:this._oRb.getText("GNT_PRNTG_MARGIN_HEIGHT_ERROR"),max:{parts:[{path:"setting>/paperHeight"},{path:"setting>/unit"}],formatter:e.bind(this)},description:"{setting>/unit}",ariaLabelledBy:this._oMarginTop}).addStyleClass("sapGanttPrintingBottomMargin"),new o({text:this._oRb.getText("GNT_PRNTG_MARGIN_LEFT"),showColon:true}),this._oInputMarginLeft=new v({min:0,step:{path:"setting>/unit",formatter:this._updateInputsStep},displayValuePrecision:1,change:this._onChangeMarginInput.bind(this,t),value:this._convertPxToUnit(this._oModel.getProperty("/marginLeft")),fieldWidth:"7rem",validationMode:"LiveChange",valueStateText:this._oRb.getText("GNT_PRNTG_MARGIN_WIDTH_ERROR"),max:{parts:[{path:"setting>/paperWidth"},{path:"setting>/unit"}],formatter:e.bind(this)},description:"{setting>/unit}",ariaLabelledBy:this._oMarginLeft})]}),new _({direction:nt.Column,layoutData:new u({shrinkFactor:0,growFactor:0,baseSize:"8rem"}),items:[new o({text:this._oRb.getText("GNT_PRNTG_MARGIN_BOTTOM"),showColon:true}),this._oInputMarginBottom=new v({min:0,step:{path:"setting>/unit",formatter:this._updateInputsStep},displayValuePrecision:1,change:this._onChangeMarginInput.bind(this,t),value:this._convertPxToUnit(this._oModel.getProperty("/marginBottom")),fieldWidth:"7rem",validationMode:"LiveChange",valueStateText:this._oRb.getText("GNT_PRNTG_MARGIN_HEIGHT_ERROR"),max:{parts:[{path:"setting>/paperHeight"},{path:"setting>/unit"}],formatter:e.bind(this)},description:"{setting>/unit}",ariaLabelledBy:this._oMarginBottom}).addStyleClass("sapGanttPrintingBottomMargin"),new o({text:this._oRb.getText("GNT_PRNTG_MARGIN_RIGHT"),showColon:true}),this._oInputMarginRight=new v({min:0,step:{path:"setting>/unit",formatter:this._updateInputsStep},displayValuePrecision:1,change:this._onChangeMarginInput.bind(this,t),value:this._convertPxToUnit(this._oModel.getProperty("/marginRight")),fieldWidth:"7rem",validationMode:"LiveChange",valueStateText:this._oRb.getText("GNT_PRNTG_MARGIN_WIDTH_ERROR"),max:{parts:[{path:"setting>/paperWidth"},{path:"setting>/unit"}],formatter:e.bind(this)},description:"{setting>/unit}",ariaLabelledBy:this._oMarginRight})]}).addStyleClass("sapGanttPrintingLeftMargin"),new g({icon:{path:"setting>/marginLocked",formatter:function(t){if(t){return"sap-icon://chain-link"}return"sap-icon://broken-link"}},press:function(){var t=this._oModel.getProperty("/marginLocked");this._oModel.setProperty("/marginLocked",!t)}.bind(this),type:"Transparent"}).addStyleClass("sapGanttPrintingLockButton sapGanttPrintingLeftMargin")]}).addStyleClass("sapGanttPrintingTopMargin sapGanttPrintingTopMargin")]};st.prototype._createCropMarks=function(){return[new S({state:"{setting>/cropMarks}"}),new _({renderType:"Bare",visible:"{setting>/cropMarks}",items:[new _({direction:nt.Column,layoutData:new u({shrinkFactor:0,growFactor:0,baseSize:"8rem"}),items:[new o({text:"Weight:"}),new v({min:0,step:.05,displayValuePrecision:2,value:"{setting>/cropMarksWeight}",fieldWidth:"7rem",description:"pt"})]}),new _({direction:nt.Column,layoutData:new u({shrinkFactor:0,growFactor:0,baseSize:"8rem"}),items:[new o({text:"Offset:"}),this._oInputCropMarksOffset=new v({min:0,step:{path:"setting>/unit",formatter:this._updateInputsStep},displayValuePrecision:1,change:this._onChangeCropMarksInput.bind(this),value:this._convertPxToUnit(this._oModel.getProperty("/cropMarksOffset")),fieldWidth:"7rem",description:"{setting>/unit}"})]}).addStyleClass("sapGanttPrintingLeftMargin")]}).addStyleClass("sapGanttPrintingTopMargin")]};st.prototype._createCompression=function(){var t=this._oModel.getProperty("/exportAsJPEG");this._oCompressExportType=new L({text:this._oRb.getText("GNT_PRNTG_EXPORT_TYPES")});this._oCompressExportType.toStatic();this._oCompressQuality=new L({text:this._oRb.getText("GNT_PRNTG_COMPRESSION_QUALITY")});this._oCompressQuality.toStatic();return[new o({text:this._oRb.getText("GNT_PRNTG_EXPORT_TYPES"),showColon:true}),this._oCompressExportTypeRadio=new T({columns:2,selectedIndex:t?0:1,buttons:[new P({id:"jpeg",text:"JPEG",selected:"{setting>/exportAsJPEG}",ariaLabelledBy:this._oCompressExportType}),new P({id:"png",text:"PNG",ariaLabelledBy:this._oCompressExportType})]}).addStyleClass("sapGanttPrintingBottomMargin"),new o({text:this._oRb.getText("GNT_PRNTG_COMPRESSION_QUALITY"),visible:"{setting>/exportAsJPEG}",showColon:true}),this._createCompressionComboBox().addAriaLabelledBy(this._oCompressQuality),this._createCompressionSlider().addAriaLabelledBy(this._oCompressQuality).addStyleClass("sapGanttPrintingTopMargin sapGanttPrintingBottomMargin"),new w({text:this._oRb.getText("GNT_PRNTG_COMPRESSION_PNG_WARNING"),showIcon:true,type:"Warning",visible:{path:"setting>/exportAsJPEG",type:"sap.ui.model.type.Boolean",formatter:function(t){return!t}}}).addStyleClass("sapGanttPrintingBottomMargin")]};st.prototype._createOptionsForm=function(){this._oOrientationLabell=new L({text:this._oRb.getText("GNT_PRNTG_ORIENTATION")});this._oExportType=new L({text:this._oRb.getText("GNT_PRNTG_EXPORT_TYPES")});this._oPaperSizeLabel=new L({text:this._oRb.getText("GNT_PRNTG_PAPER_SIZE")});this._oDurationComboLabel=new L({text:this._oRb.getText("GNT_PRNTG_DURATION")});this._oScaleLabel=new L({text:this._oRb.getText("GNT_PRNTG_SCALE")});this._oOrientationLabell.toStatic();this._oExportType.toStatic();this._oPaperSizeLabel.toStatic();this._oDurationComboLabel.toStatic();this._oScaleLabel.toStatic();return new _({renderType:"Bare",direction:nt.Column,items:[new o({text:this._oRb.getText("GNT_PRNTG_EXPORT_TYPES"),showColon:true}),this._radioGroupPage=new T({columns:2,selectedIndex:this._oModel.getProperty("/multiplePage")?0:1,select:this._onChangeExportTypes.bind(this),buttons:[new P({id:"Multiple",text:this._oRb.getText("GNT_PRNTG_MULTIPLE_PAGE"),selected:"{setting>/multiplePage}",ariaLabelledBy:this._oExportType}),new P({id:"Single",text:this._oRb.getText("GNT_PRNTG_SINGLE_PAGE"),ariaLabelledBy:this._oExportType})]}).addStyleClass("sapGanttPrintingBottomMargin"),new o({text:this._oRb.getText("GNT_PRNTG_ORIENTATION"),showColon:true}),this._radioGroupOrientation=new T({columns:2,selectedIndex:this._oModel.getProperty("/portrait")?0:1,select:this._onChangeOrientation.bind(this,false),buttons:[new P({id:"Portrait",text:this._oRb.getText("GNT_PRNTG_PORTRAIT"),selected:"{setting>/portrait}",ariaLabelledBy:this._oOrientationLabell}),new P({id:"Landscape",text:this._oRb.getText("GNT_PRNTG_LANDSCAPE"),ariaLabelledBy:this._oOrientationLabell})]}).addStyleClass("sapGanttPrintingBottomMargin"),new w({text:"{setting>/orientationMessage}",type:"Information",showIcon:true,visible:"{setting>/showOrientationMessage}"}).addStyleClass("sapGanttPrintingSinglePageMessage"),new o({text:this._oRb.getText("GNT_PRNTG_PAPER_SIZE"),showColon:true}),this._createPaperComboBox(false).addAriaLabelledBy(this._oPaperSizeLabel).addStyleClass("sapGanttPrintingBottomMargin"),this._createPaperSizeFields(false).addStyleClass("sapGanttPrintingBottomMargin"),new w({text:this._oRb.getText("GNT_PRNTG_SINGLE_PAGE_QUALITY"),type:"Information",showIcon:true,visible:"{setting>/qualityWarning}"}).addStyleClass("sapGanttPrintingSinglePageMessage"),new o({text:this._oRb.getText("GNT_PRNTG_DURATION"),showColon:true}),this._createDurationComboBox(false).addAriaLabelledBy(this._oDurationComboLabel).addStyleClass("sapGanttPrintingBottomMargin"),this._createDatePicker(false).addStyleClass("sapGanttPrintingBottomMargin"),new o({text:this._oRb.getText("GNT_PRNTG_SCALE"),visible:"{setting>/multiplePage}",showColon:true}),this._createScale().addAriaLabelledBy(this._oScaleLabel).addStyleClass("sapGanttPrintingBottomMargin"),new o({text:this._oRb.getText("GNT_PRNTG_PAGE_RANGE"),visible:"{setting>/multiplePage}",showColon:true}),this._createPageRange().addStyleClass("sapGanttPrintingBottomMargin"),new o({text:this._oRb.getText("GNT_PRNTG_HEADER_AND_FOOTER"),showColon:true}),this._createCheckBoxWithInput(this._oRb.getText("GNT_PRNTG_HEADER"),"{setting>/showHeaderText}","{setting>/headerText}"),this._createCheckBoxWithInput(this._oRb.getText("GNT_PRNTG_FOOTER"),"{setting>/showFooterText}","{setting>/footerText}").addStyleClass("sapGanttPrintingBottomMargin"),this._createLabelWithSwitch(this._oRb.getText("GNT_PRNTG_SHOW_PAGE_NUMBER"),"{setting>/showPageNumber}").addStyleClass("sapGanttPrintingBottomMargin"),this._createPanel(this._oRb.getText("GNT_PRNTG_MARGIN"),this._createMargin(false)),this._createPanel(this._oRb.getText("GNT_PRNTG_COMPRESSION"),this._createCompression())]})};st.prototype._createSinglePageForm=function(){this._oOrientationLabel=new L({text:this._oRb.getText("GNT_PRNTG_ORIENTATION")});this._oPaperSizeLabel=new L({text:this._oRb.getText("GNT_PRNTG_PAPER_SIZE")});this._oDurationComboLabel=new L({text:this._oRb.getText("GNT_PRNTG_DURATION")});this._oOrientationLabel.toStatic();this._oDurationComboLabel.toStatic();this._oPaperSizeLabel.toStatic();return new _({renderType:"Bare",direction:nt.Column,items:[new o({text:this._oRb.getText("GNT_PRNTG_ORIENTATION"),showColon:true}),this._radioGroupOrientation=new T({columns:2,selectedIndex:this._oModel.getProperty("/portrait")?0:1,select:this._onChangeOrientation.bind(this,true),buttons:[new P({id:"Portrait",text:this._oRb.getText("GNT_PRNTG_PORTRAIT"),selected:"{setting>/portrait}",ariaLabelledBy:this._oOrientationLabel}),new P({id:"Landscape",text:this._oRb.getText("GNT_PRNTG_LANDSCAPE"),ariaLabelledBy:this._oOrientationLabel})]}).addStyleClass("sapGanttPrintingBottomMargin"),new o({text:this._oRb.getText("GNT_PRNTG_PAPER_SIZE"),showColon:true}),this._createPaperComboBox(true).addStyleClass("sapGanttPrintingBottomMargin").addAriaLabelledBy(this._oPaperSizeLabel),this._createPaperSizeFields(true).addStyleClass("sapGanttPrintingBottomMargin"),new o({text:this._oRb.getText("GNT_PRNTG_DURATION"),showColon:true}),this._createDurationComboBox(true).addAriaLabelledBy(this._oDurationComboLabel).addStyleClass("sapGanttPrintingBottomMargin"),this._createDatePicker(true).addStyleClass("sapGanttPrintingBottomMargin"),new o({text:this._oRb.getText("GNT_PRNTG_HEADER_AND_FOOTER"),showColon:true}),this._createCheckBoxWithInput(this._oRb.getText("GNT_PRNTG_HEADER"),"{setting>/showHeaderText}","{setting>/headerText}",true),this._createCheckBoxWithInput(this._oRb.getText("GNT_PRNTG_FOOTER"),"{setting>/showFooterText}","{setting>/footerText}",true).addStyleClass("sapGanttPrintingBottomMargin"),this._createPanel(this._oRb.getText("GNT_PRNTG_MARGIN"),this._createMargin(true))]})};st.prototype._createDialogContent=function(t){var e;if(t){e=new _({renderType:"Bare",fitContainer:true,items:[this._oFlexBoxPreview=new _({renderType:"Bare",layoutData:new u({shrinkFactor:1,growFactor:1,baseSize:"auto"}),direction:nt.Column,items:[new _({renderType:"Bare",layoutData:new u({shrinkFactor:0,growFactor:0,baseSize:"3.5rem"})}),this._oPdfDialogPreview=new A({content:'<div class="sapGanttPdfPreviewContentDiv"><div id="sapGanttPdfPreviewDiv"class="sapGanttPdfPreviewPageDiv"></div></div>'})]}).addStyleClass("sapGanttPrintingPreviewContent"),new c({horizontal:false,vertical:true,layoutData:new u({shrinkFactor:0,growFactor:0,baseSize:"27rem"}),content:[this._createSinglePageForm().addStyleClass("sapGanttPrintingDialogSettings")]})]})}else{e=new _({renderType:"Bare",fitContainer:true,items:[this._oFlexBoxPreview=new _({renderType:"Bare",layoutData:new u({shrinkFactor:1,growFactor:1,baseSize:"auto"}),direction:nt.Column,items:[new _({renderType:"Bare",layoutData:new u({shrinkFactor:0,growFactor:0,baseSize:"3.5rem"})}),this._oHTMLDialogPreview=new A({content:'<div class="sapGanttPrintingPreviewContentDiv"><div class="sapGanttPrintingPreviewPageDiv"></div></div>'}),new _({renderType:"Bare",justifyContent:"Center",alignItems:"Center",layoutData:new u({shrinkFactor:0,growFactor:0,baseSize:"6rem"}),items:[this._oButtonFirst=new g({icon:"sap-icon://close-command-field",visible:"{setting>/multiplePage}",press:this._onPressButtonFirst.bind(this),type:"Transparent",tooltip:this._oRb.getText("GNT_PRNTG_FIRST_PAGE_BUTTON")}).addStyleClass("sapGanttPrintingPreviewIconMarginRight"),this._oButtonPrevious=new g({icon:"sap-icon://navigation-left-arrow",visible:"{setting>/multiplePage}",press:this._onPressButtonPrevious.bind(this),type:"Transparent",tooltip:this._oRb.getText("GNT_PRNTG_PREVIOUS_PAGE_BUTTON")}),new r({textAlign:"Center",visible:"{setting>/multiplePage}",width:"7.25rem",text:{parts:[{path:"setting>/previewPageNumber"},{path:"setting>/lastPageNumber"}],formatter:function(t,e){return e?this._oRb.getText("GNT_PRNTG_OF",[t,e]):t.toString()}.bind(this)}}).addStyleClass("sapGanttPrintingPreviewText"),this._oButtonNext=new g({icon:"sap-icon://navigation-right-arrow",visible:"{setting>/multiplePage}",press:this._onPressButtonNext.bind(this),type:"Transparent",tooltip:this._oRb.getText("GNT_PRNTG_NEXT_PAGE_BUTTON")}).addStyleClass("sapGanttPrintingPreviewIconMarginRight"),this._oButtonLast=new g({icon:"sap-icon://open-command-field",visible:"{setting>/multiplePage}",press:this._onPressButtonLast.bind(this),type:"Transparent",tooltip:this._oRb.getText("GNT_PRNTG_LAST_PAGE_BUTTON")})]}).addStyleClass("sapGanttPrintingPreviewFooter")]}).addStyleClass("sapGanttPrintingPreviewContent"),new c({horizontal:false,vertical:true,layoutData:new u({shrinkFactor:0,growFactor:0,baseSize:"27rem"}),content:[this._createOptionsForm().addStyleClass("sapGanttPrintingDialogSettings")]})]});this._updatePageNumberButtons()}return e};st.prototype._createAndOpenDialog=function(t){var e=t?this.exportSinglePage:this.export;this._oDialog=new h({title:this._oRb.getText("GNT_PRNTG_PDF_EXPORT_TITLE"),contentWidth:"100%",contentHeight:"100%",horizontalScrolling:false,verticalScrolling:false,content:[this._createDialogContent(t)],buttons:[this._oButtonExport=new g({text:this._oRb.getText("GNT_PRNTG_EXPORT"),type:d.ButtonType.Emphasized,press:e.bind(this)}),this._oButtonClose=new g({text:this._oRb.getText("GNT_PRNTG_CANCEL"),press:function(){this.close()}.bind(this)})]}).addStyleClass("sapGanttPrintingDialog");this._oDialog.onsapescape=function(t){this.close();t.preventDefault();t.stopPropagation()}.bind(this);this._oDialog.setModel(this._oModel,"setting");this._oDialog.open();this._sResizeHandlerId=V.register(this._oDialog,this._onResize.bind(this))};st.prototype._openProgressDialog=function(){this._oProgressIndicator=new l({state:"Information",percentValue:0});this._oProgressText=new r({text:this._oRb.getText("GNT_PRNTG_PDF_PREVIEW"),textAlign:"Center"}).addStyleClass("sapGanttPrintingProgressText");this._oProgressIndicatorBox=new _(this.getId()+"-progressFlexBox",{direction:"Column",alignItems:"Center",items:[this._oProgressText,this._oProgressIndicator],renderType:"Bare"}).addStyleClass("sapGanttPrintingProgressBox");this._oProgressDialog=new h(this.getId()+"-progressDialog",{contentWidth:"25%",showHeader:false,content:[this._oProgressIndicatorBox],buttons:[new g({text:this._oRb.getText("GNT_PRNTG_CANCEL"),press:function(){this._closeProgressIndicator()}.bind(this)})]});this._oProgressDialog.open()};return st});
//# sourceMappingURL=GanttPrinting.js.map