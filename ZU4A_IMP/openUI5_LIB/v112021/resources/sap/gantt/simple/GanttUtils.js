/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/base/Log","sap/ui/base/Object","sap/ui/core/Core","sap/ui/core/CalendarType","sap/gantt/misc/Utility","sap/ui/core/format/DateFormat","sap/ui/core/Locale","sap/m/OverflowToolbar","sap/ui/core/theming/Parameters","./CoordinateUtils","./MarkerType","sap/gantt/misc/Format","sap/gantt/library","sap/ui/table/rowmodes/Auto","sap/ui/table/rowmodes/Fixed","sap/ui/table/rowmodes/Interactive"],function(jQuery,e,t,r,a,n,i,s,o,l,g,c,u,f,h,d,p){"use strict";var m={};var S={};var v=false;var y=false;var T={SHAPE_ID_DATASET_KEY:"data-sap-gantt-shape-id",ROW_ID_DATASET_KEY:"data-sap-gantt-row-id",CONNECTABLE_DATASET_KEY:"data-sap-gantt-connectable",SELECT_FOR_DATASET_KEY:"sap-gantt-select-for",SHAPE_CONNECT_FOR_DATASET_KEY:"sap-gantt-shape-connect-for",SHAPE_CONNECT_INDICATOR_WIDTH:10,oDateFormat:i.getDateInstance({pattern:"yyyyMMddHHmmss",calendarType:a.Gregorian}),shapeElementById:function(e,t){var r=window.document.getElementById(t),a=r.querySelector("g.sapGanttChartShapes");var n=a.querySelectorAll("["+T.SHAPE_ID_DATASET_KEY+"='"+e+"']");var i=n[0];if(i){return jQuery(i).control(0)}return null},isRelationshipConnectedToPseudoShapes:function(e,t){var a=r.byId(t);var n=a.getTable().getRows();var i=false,s;n.forEach(function(t){if(!i){var r=t.getAggregation("_settings");s=r.getPseudoShapes&&r.getPseudoShapes().filter(function(t){return t.aShapeIds.indexOf(e)>-1})[0];if(s){i=true}}});if(i&&document.getElementById(s.getId())){return s}},getValueX:function(t){var a;var i=t.getMetadata().getProperty("x");if(i){a=t.getProperty(i.name);if(a!==null&&a!==undefined){return a}}var s=r.getConfiguration().getRTL(),o=s?t.getEndTime()||t.getTime():t.getTime();if(o){a=t.getXByTime(o)}if(!n.isNumeric(a)){e.warning("couldn't convert timestamp to x with value: "+o)}return a},getRowInstance:function(e,t){var r=jQuery(e.target).closest("rect.sapGanttBackgroundSVGRow").data("sapUiIndex");if(r!=null){return t.getRows()[r]}},setTableRowMode:function(e){if(e){var t=e.getRowMode();if(!t&&e.getVisibleRowCountMode()){return}if(t===null||t==="Fixed"){e.setRowMode(new d)}else if(t==="Auto"){e.setRowMode(new h)}else if(t==="Interactive"){e.setRowMode(new p)}}},getRowInstancefromShape:function(e){var t=e.getParentRowSettings();if(t!=null){return t.getParentRow()}},_get2dContext:function(e,t,r){if(!m.context){m.context=document.createElement("canvas").getContext("2d")}if(m.fontSize!==e||m.fontFamily!==t||m.fontWeight!==r){m.context.font=r+" "+e+"px "+t;m.fontSize=e;m.fontFamily=t;m.fontWeight=r}return m.context},getShapeTextWidth:function(e,t,r,a){return this._get2dContext(t,r,a).measureText(e).width},getSelectedTableRowSettings:function(e,t){var r=e.getRows(),a=e.getFirstVisibleRow();if(r.length===0){return null}var n=r[0].getIndex();var i=t-a;if(n!==a){i+=Math.abs(n-a)}if(!r[i]){return null}return r[i].getAggregation("_settings")},updateGanttRows:function(e,t,r){var a=e.getParent().getParent();var n=jQuery(document.getElementById(a.getId()+"-svg")),i=n.find("rect.sapGanttBackgroundSVGRow");if(a.getEnableChartSelectionState()){i.eq(r).toggleClass("sapGanttBackgroundSVGRowSelected",!!t[r].selected)}if(a.getEnableChartHoverState()){i.eq(r).toggleClass("sapGanttBackgroundSVGRowHovered",!!t[r].hovered)}},getShapesWithUid:function(e,t){var a=function(t){var a=n.parseUid(t),i=a.shapeId;var s=["[id='",e,"']"," ["+T.SHAPE_ID_DATASET_KEY+"='",i,"']"].join("");var o=document.querySelector(s);if(o){var l=r.byId(o.id);if(l){var g=n.parseUid(l.getShapeUid());if(g.shapeId===i&&g.rowId===a.rowId){return l}}}};return t.map(a)},getShapeByShapeId:function(e,t){var a=[];t.forEach(function(t){var n=["[id='",e,"']"," ["+T.SHAPE_ID_DATASET_KEY+"='",t,"']"].join("");var i=document.querySelector(n);if(i){var s=r.byId(i.id);a.push(s)}});return a},getShapesInRowsById:function(e,t){var a=document.getElementById(e);var n=[];t.forEach(function(e){if(a){var t=a.querySelector("[data-sap-gantt-row-id='"+e+"']");if(t){n=Array.from(t.children).filter(function(e){return e.id!==""}).reduce(function(e,t){return e.concat(r.byId(t.id))},n)}}});return n},getShapeIdFromShapeUid:function(e){return e.map(function(e){var t=n.parseUid(e);return t.shapeId})},getTimeFormaterBySmallInterval:function(e){var t=e.getAxisTimeStrategy(),a=t.getTimeLineOption().smallInterval,n=a.unit;var o=t.getCalendarType(),l=t.getLocale()?t.getLocale():new s(r.getConfiguration().getLanguage().toLowerCase());var g="yyyyMMMddhhms";if(!(n===sap.gantt.config.TimeUnit.minute||n===sap.gantt.config.TimeUnit.hour)){g="yyyyMMMdd"}var c=a.locale?new s(a.locale):l;var f={format:g,style:a.style,calendarType:o};if(u._getEnableDateTimezoneFormatter()){return i.getDateTimeInstance(f,c)}else{return i.getDateTimeWithTimezoneInstance(f,c)}},getFormatedDateByTimeZone:function(e){var t=this.oDateFormat.format(e);return u.abapTimestampToDate(t)},resetStrokeDasharray:function(e){if(!e){return}var t=e.getSimpleAdhocLines().find(function(e){return e._getSelected()});if(t){t._setSelected(false);var r=document.getElementById(t._getHeaderLine().sId);var a=document.getElementById(t._getLine().sId);var n=document.getElementById(t._getMarker().getId());n.style.cursor="pointer";if(a&&r){a.style.strokeDasharray=t.getStrokeDasharray();r.style.strokeDasharray=t.getStrokeDasharray();a.style.strokeWidth=t._getStrokeWidth();r.style.strokeWidth=t._getStrokeWidth()}}var i=e.getDeltaLines().find(function(e){return e._getIsSelected()});if(i){var s=i._getChartDeltaArea();if(s){var o=document.getElementById(s.sId);if(i._getEnableChartDeltaAreaHighlight()===true){o.style.opacity=0}}var g=document.getElementById(i._getForwardMarker().sId);var c=document.getElementById(i._getBackwardMarker().sId);var u=document.getElementById(i._getHeaderDeltaArea().sId);var f=l.get("sapUiChartDataPointBorderColor");if(i.getVisibleDeltaStartEndLines()){var h=document.getElementById(i._getStartLine().sId);var d=document.getElementById(i._getEndLine().sId);var p=document.getElementById(i._getHeaderStartLine().sId);var m=document.getElementById(i._getHeaderEndLine().sId);h.style.strokeDasharray=i.getStrokeDasharray();d.style.strokeDasharray=i.getStrokeDasharray();p.style.strokeDasharray=i.getStrokeDasharray();m.style.strokeDasharray=i.getStrokeDasharray();h.style.strokeWidth=i._getStrokeWidth();d.style.strokeWidth=i._getStrokeWidth();p.style.strokeWidth=i._getStrokeWidth();m.style.strokeWidth=i._getStrokeWidth()}g.style.fillOpacity=0;c.style.fillOpacity=0;u.style.opacity=1;u.style.cursor="pointer";g.style.stroke=null;c.style.stroke=null;if(i._getVisibleMarker()===true){g.style.fillOpacity=1;c.style.fillOpacity=1;g.style.stroke=f;c.style.stroke=f}var S=e._getResizeExtension();S.clearAllDeltaOutline();i._setIsSelected(false)}},adhocLinesPresentAndEnabled:function(e){return e.getSimpleAdhocLines().filter(function(e){return e.MarkerType!=c.None}).length>0&&e.getEnableAdhocLine()},addToolbarToTable:function(e,t,r){if(r){if(t.getExtension().length==0){var a=new o;a.addContent(e.oExportTableToExcelButton);t.addExtension(a)}else{t.getExtension()[0].addContent(e.oExportTableToExcelButton)}}},findSpaceInLevel:function(e,r,a,n){for(var i=0;i<S[e].length;i++){if(y){return}var s=r.getParent().getParent();if(s&&s.isA("sap.gantt.overlays.GanttRowOverlay")){return}var o=n,l=n,g=n;if(t.isA(r,"sap.gantt.simple.AdhocLine")){o=a}if(t.isA(S[e][i],"sap.gantt.simple.AdhocLine")){l=a}if(t.isA(S[e][i+1],"sap.gantt.simple.AdhocLine")){g=a}if(S[e].length>1){if(i===0&&(r[o]()<=S[e][i][a]()||r[o]()>S[e][i][a]()&&r[o]()-S[e][i][a]()<=1e3)&&!(this._stringToDateObject(r[a]()).getTime()===this._stringToDateObject(S[e][i][a]()).getTime()&&this._stringToDateObject(r[o]()).getTime()===this._stringToDateObject(S[e][i][l]()).getTime())){S[e].push(r);v=true}else if(S[e][i+1]!==undefined&&(r[a]()>=S[e][i][l]()&&r[o]()<=S[e][i+1][a]()||r[a]()<S[e][i][l]()&&S[e][i][l]()-r[a]()<=1e3&&(r[o]()>S[e][i+1][a]()&&r[o]()-S[e][i+1][a]()<=1e3||r[o]()<=S[e][i+1][a]())||r[o]()>S[e][i+1][a]()&&r[o]()-S[e][i+1][a]()<=1e3&&(r[a]()>=S[e][i][l]()||r[a]()<S[e][i][l]()&&S[e][i][l]()-r[a]()<=1e3))&&!(this._stringToDateObject(r[a]()).getTime()===this._stringToDateObject(S[e][i][a]()).getTime()&&this._stringToDateObject(r[o]()).getTime()===this._stringToDateObject(S[e][i][l]()).getTime()||this._stringToDateObject(r[a]()).getTime()===this._stringToDateObject(S[e][i+1][a]()).getTime()&&this._stringToDateObject(r[o]()).getTime()===this._stringToDateObject(S[e][i+1][g]()).getTime())){S[e].push(r);v=true}else if(i===S[e].length-1&&(r[a]()>=S[e][i][l]()||r[a]()<S[e][i][l]()&&S[e][i][l]()-r[a]()<=1e3)&&!(this._stringToDateObject(r[a]()).getTime()===this._stringToDateObject(S[e][i][a]()).getTime()&&this._stringToDateObject(r[o]()).getTime()===this._stringToDateObject(S[e][i][l]()).getTime())){S[e].push(r);v=true}else if(this._stringToDateObject(r[a]()).getTime()===this._stringToDateObject(S[e][i][a]()).getTime()&&this._stringToDateObject(r[o]()).getTime()===this._stringToDateObject(S[e][i][l]()).getTime()){if(parseInt(e,10)===Object.keys(S).length-1){S[parseInt(e,10)+1]=[r];v=true}else{v=false}}else{if(i===S[e].length-1&&parseInt(e,10)===Object.keys(S).length-1){S[parseInt(e,10)+1]=[r];v=true}else{v=false}}}else{if((r[a]()>=S[e][i][l]()||r[a]()<S[e][i][l]()&&S[e][i][l]()-r[a]()<=1e3||(r[o]()<=S[e][i][a]()||r[o]()>S[e][i][a]()&&r[o]()-S[e][i][a]()<=1e3))&&!(this._stringToDateObject(r[a]()).getTime()===this._stringToDateObject(S[e][i][a]()).getTime()&&this._stringToDateObject(r[o]()).getTime()===this._stringToDateObject(S[e][i][l]()).getTime())){S[e].push(r);v=true}else if(this._stringToDateObject(r[a]()).getTime()===this._stringToDateObject(S[e][i][a]()).getTime()&&this._stringToDateObject(r[o]()).getTime()===this._stringToDateObject(S[e][i][l]()).getTime()){if(parseInt(e,10)===Object.keys(S).length-1){S[parseInt(e,10)+1]=[r];v=true}else{v=false}}else{if(parseInt(e,10)===Object.keys(S).length-1){S[parseInt(e,10)+1]=[r];v=true}else{v=false}}}if(v){i=S[e].length;y=true;S=this.sortShapesByTime(S,e,a)}}},sortShapesByTime:function(e,t,r){var a=e[t].length;var n;do{n=false;for(var i=0;i<a;i++){if(e[t][i+1]!==undefined){if(e[t][i][r]()>e[t][i+1][r]()){var s=e[t][i];e[t][i]=e[t][i+1];e[t][i+1]=s;n=true}}}}while(n);return e},_partitionShapesIntoOverlappingRanges:function(e,t,r){S={};var a="get"+t.charAt(0).toUpperCase()+t.slice(1);var n="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.length>0){S[0]=[e[0]]}for(var i=1,s=e.length;i<s;i++){y=false;for(var o in S){this.findSpaceInLevel(o,e[i],a,n)}}return S},_stringToDateObject:function(e){if(typeof e==="string"&&e.length>0){return u.abapTimestampToDate(e)}return e},_getExpandedChildArray:function(e,r,a,n){var i,s;e.forEach(function(e){if(t.isA(e,"sap.gantt.simple.BaseConditionalShape")){var o=e._getActiveShapeElement();if(a.indexOf(o.getScheme())>-1||r.getEnablePseudoShapes()){if(t.isA(o,"sap.gantt.simple.BaseGroup")){i=null;s=null;o.getShapes().forEach(function(e){if(!i&&!s){i=e.getTime();s=e.getEndTime()}else{if(e.getTime()>=i){i=i}else{i=e.getTime()}if(e.getEndTime()>=s){s=e.getEndTime()}else{s=s}}});o.setProperty("time",i,true);o.setProperty("endTime",s,true);n=n.concat(o)}else if(o){n=n.concat(o)}}}else if(t.isA(e,"sap.gantt.simple.BaseGroup")){i=null;s=null;e.getShapes().forEach(function(e){if(!i&&!s){i=e.getTime();s=e.getEndTime()}else{if(e.getTime()>=i){i=i}else{i=e.getTime()}if(e.getEndTime()>=s){s=e.getEndTime()}else{s=s}}});e.setProperty("time",i,true);e.setProperty("endTime",s,true);n=n.concat(e)}else{n=n.concat(e)}});return n},calculateLevelForShapes:function(e,r,a,n){var i=function(e){return e.reduce(function(e,t){return e.concat(Array.isArray(t)?i(t):t)},[])};var s=this._partitionShapesIntoOverlappingRanges(e,r,a);var o=0;var l=Object.values(s).map(function(e,t){e.map(function(e){var r=t+1;if(e._setLevel){e._setLevel(r)}e._level=r;var a=e.getParentRowSettings&&e.getParentRowSettings(),n=e.getShapeId&&e.getShapeId();if(a&&a._overlayShapeIdList&&n&&a._overlayShapeIdList[n]){a._overlayShapeIdList[n]=e._level}if(o<r){o=r}return e});return e});var g=i(l);var c={};if(n){c={adhocLines:g.filter(function(e){return t.isA(e,"sap.gantt.simple.AdhocLine")}),deltaLines:g.filter(function(e){return t.isA(e,"sap.gantt.simple.DeltaLine")}),maxLevel:o}}else{c={shapes:g,maxLevel:o}}return c},getShapeSuccessors:function(e,t){var r=[];if(e.getEnableChainSelection()){var a=this._getVisibleRelationships(t);var n=a.filter(function(t){return t.getPredecessor()===e.getShapeId()});n.forEach(function(e){var a=e.getRelatedInRowShapes(t.getId());if(a.successor){r.push(a.successor)}});r=Array.from(new Set(r))}return r},getShapePredeccessors:function(e,t){var r=[];if(e.getEnableChainSelection()){var a=this._getVisibleRelationships(t);var n=a.filter(function(t){return t.getSuccessor()===e.getShapeId()});n.forEach(function(e){var a=e.getRelatedInRowShapes(t.getId());if(a.predecessor){r.push(a.predecessor)}});r=Array.from(new Set(r))}return r},selectAssociatedShapes:function(e,t){var r=e.shape;var a=t._getDragDropExtension();var n=!r.getSelected();if(a.shapeSelectedOnMouseDown&&!a.initiallySelected&&!t.getEnableSelectAndDrag()){n=a.shapeSelectedOnMouseDown}var i=[r];if(r.getEnableChainSelection()){i=this._getShapesToSelect(r,t);i.forEach(function(e){this.oSelection.updateShape(e.getShapeUid(),{selected:n,ctrl:true,draggable:e.getDraggable(),time:e.getTime(),endTime:e.getEndTime()})}.bind(t))}return i},_getShapesToSelect:function(e,t){var r=[e];var a=this._getVisibleRelationships(t);var n=a.filter(function(t){return t.getPredecessor()===e.getShapeId()||t.getSuccessor()===e.getShapeId()});n.forEach(function(e){var a=e.getRelatedInRowShapes(t.getId());if(a.predecessor&&a.predecessor.getSelectableInChainSelection()){r.push(a.predecessor)}if(a.successor&&a.successor.getSelectableInChainSelection()){r.push(a.successor)}});r=Array.from(new Set(r));return r},_getVisibleRelationships:function(e){var t=[];e.getTable().getRows().forEach(function(e){var r=e.getAggregation("_settings").getRelationships();t=t.concat(r)});t=Array.from(new Set(t));return t},rerenderAssociatedRelationships:function(e,t){var a=r.createRenderManager();var n=[];var i=this._getVisibleRelationships(e);i.forEach(function(e){if(e.getSuccessor()===t.getShapeId()||e.getPredecessor()===t.getShapeId()){n.push(e)}});n.forEach(function(t){t.renderElement(a,t,e.getId())})},getFilteredShapeType:function(e){e=Array.from(new Set(e));return e.filter(function(e){return e!=="None"})},getPathCorners:function(e,t){var r=e.replace(/([A-Z])/g," $1");var a=[],n;var i=r.split(/[,\s]/).reduce(function(e,t){var r=t.match("([a-zA-Z])(.+)");if(r){e.push(r[1]);e.push(r[2])}else{e.push(t)}return e},[]);var s=i.reduce(function(e,t){if(parseFloat(t)==t&&e.length){e[e.length-1].push(t)}else{e.push([t])}return e},[]);function o(e,t,r){var a=t.x-e.x;var n=t.y-e.y;var i=Math.sqrt(a*a+n*n);return l(e,t,Math.min(1,r/i))}function l(e,t,r){return{x:e.x+(t.x-e.x)*r,y:e.y+(t.y-e.y)*r}}function g(e,t){if(e.length>2){e[e.length-2]=t.x;e[e.length-1]=t.y}}function c(e){return{x:parseFloat(e[e.length-2]),y:parseFloat(e[e.length-1])}}if(s.length>1){var u=c(s[0]),f=null;if(s[s.length-1][0]=="Z"&&s[0].length>2){f=["L",u.x,u.y];s[s.length-1]=f}a.push(s[0]);for(var h=1;h<s.length;h++){var d=a[a.length-1],p=s[h],m=p==f?s[1]:s[h+1],S=t;if(m&&d&&d.length>2&&p[0]=="L"&&m.length>2&&m[0]=="L"){var v=c(d),y=c(p),T=c(m),_,E,I=Math.abs(v.x-y.x)+Math.abs(v.y-y.y),b=Math.abs(T.x-y.x)+Math.abs(T.y-y.y),A=Math.max(Math.min(S,I,b/2),1);_=o(y,v,A);E=o(y,T,A);g(p,_);p.origPoint=y;a.push(p);var D=l(_,y,.5),w=l(y,E,.5),x=["C",D.x,D.y,w.x,w.y,E.x,E.y];x.origPoint=y;a.push(x)}else{a.push(p)}}if(f){var R=c(a[a.length-1]);a.push(["Z"]);g(a[0],R)}}else{a=s}n=a.reduce(function(e,t){return e+t.join(" ")+" "},"");return n},arrayMove:function(e,t,r){if(r>=e.length){var a=r-e.length+1;while(a--){e.push(undefined)}}e.splice(r,0,e.splice(t,1)[0]);return e},getEdgePoint:function(e){var t=2;var r=["Arrow","None"];var a=this._getVisibleRelationships(e);a.forEach(function(a){if(a.getPredecessor()!==undefined&&a.getSuccessor()!==undefined&&(a.getShapeTypeStart()!=="None"||r.indexOf(a.getShapeTypeEnd())==-1)||e.getRelationshipShapeSize()==sap.gantt.simple.relationshipShapeSize.Large){t=3}});return t},getTimeLabel:function(e,t,r,a){var i=g.getEventSVGPoint(a,e);var s,o,l;l=t.getZoomStrategy();if(u._getEnableDateTimezoneFormatter()){o=u.dateToAbapTimestamp(t.viewToTime(i.x));s=u._convertUTCToLocalTime(o,r);return n.getLowerCaseLabel(l.getLowerRowFormatter().format(s))}else{s=t.viewToTime(i.x);return n.getLowerCaseLabel(r.getFormattedDate(l.getLowerRowFormatter(),s))}},getVisibleElements:function(e,t,r){return Array.from(e.querySelectorAll(t)).reduce(function(e,t){return e.concat(Array.from(t.querySelectorAll(r)))},[])},isDynamicText:function(){var e=f.simple.horizontalTextAlignment;var a=false;var n=Array.from(document.querySelectorAll(".sapGanttChartSvg .sapGanttChartShapes .baseShapeSelection")).filter(function(e){if(!e.classList.contains("sapGanttTextNoPointerEvents")&&e.tagName!="text"){return e}});n.forEach(function(n){var i=n.closest("[data-sap-ui]").getAttribute("data-sap-ui");var s=r.byId(i);if(s&&!a){if(t.isA(s,"sap.gantt.simple.BaseConditionalShape")){var o=s._getActiveShapeElement();if(t.isA(o,"sap.gantt.simple.BaseGroup")){o.getShapes().forEach(function(t){if(t.getHorizontalTextAlignment()===e.Dynamic){a=true}})}else{if(s.getHorizontalTextAlignment()===e.Dynamic){a=true}}}else if(t.isA(s,"sap.gantt.simple.MultiActivityGroup")){if(s.getTask().getHorizontalTextAlignment()===e.Dynamic){a=true}}else if(t.isA(s,"sap.gantt.simple.BaseGroup")){s.getShapes().forEach(function(t){if(t.getHorizontalTextAlignment()===e.Dynamic){a=true}})}else{if(s.getHorizontalTextAlignment()===e.Dynamic){a=true}}}});if(!a){var i=Array.from(document.querySelectorAll(".sapGanttChartSvg .sapGanttChartCalendar .baseShapeSelection")).filter(function(e){if(!e.classList.contains("sapGanttTextNoPointerEvents")&&e.tagName!="text"){return e}});i.forEach(function(t){if(!a){var n=t.closest("[data-sap-ui]").getAttribute("data-sap-ui");var i=r.byId(n);if(i.getHorizontalTextAlignment()===e.Dynamic){a=true}}})}return a},setLmarker:function(e,t,a){var n=t.mAnchors.predecessor.x,i=t.mAnchors.predecessor.y;var s=t.mAnchors.successor.x,o=t.mAnchors.successor.y;t.setProperty("_lMarker","",true);var l=t.getProcessedType();var g=e._edgePoint;if(l===1&&n<=s){if(r.getConfiguration().getRTL()?t.getLShapeForTypeSF():t.getLShapeForTypeFS()){if(g==2&&t.getShapeTypeStart()=="None"||g==3&&Math.abs(n-s)>=g*6){if(i>o){t.setProperty("_lMarker","rightUp",true)}else{t.setProperty("_lMarker","rightDown",true)}}}}else if(l===2&&n>=s){if(r.getConfiguration().getRTL()?t.getLShapeForTypeFS():t.getLShapeForTypeSF()){if(g==2&&t.getShapeTypeStart()=="None"||g==3&&Math.abs(n-s)>=g*6){if(i>o){t.setProperty("_lMarker","leftUp",true)}else{t.setProperty("_lMarker","leftDown",true)}}}}if(a){e.relSet[t.getShapeId()]=t}else{e.relSetFake[t.getShapeId()]=t}},pseudoShapeGroupAfterEdit:function(e,t){var r=[],a=0,n=e.oOverlapShapeIds&&e.oOverlapShapeIds[t];if(n){if(n[0]){var i=T.getShapeByShapeId(e.getId(),[n[0]])[0];i&&r.push({iShapeCount:1,startTime:i.getTime(),endTime:i.getEndTime()})}for(var s=1;s<n.length;s++){var o=T.getShapeByShapeId(e.getId(),[n[s]])[0];if(o){var l=o.getTime(),g=o.getEndTime(),c=r[a],u=c.startTime,f=c.endTime;if(l>=u&&g<=f){c.iShapeCount++}else if(l>=u&&l<f&&g>f){c.iShapeCount++;c.endTime=g}else if(l>=f&&g>=f){a++;r.push({iShapeCount:1,startTime:l,endTime:g})}}}}return r},relationexist:function(e,t){t.mRelatedShapes=t.getRelatedInRowShapes(e.getId());var r=t.getProcessedType();t.mAnchors=t.getRlsAnchors(r,t.mRelatedShapes);if(!t.getVisible()){return false}if(!t.mRelatedShapes.predecessor&&!t.mRelatedShapes.successor){return false}var a=function(e){return!isNaN(parseFloat(e.x))&&isFinite(e.x)&&!isNaN(parseFloat(e.y))&&isFinite(e.y)};if(!a(t.mAnchors.predecessor)||!a(t.mAnchors.successor)){return false}return true},geNumberOfTruncatedCharacters:function(e,t,r,a,n,i,s){var o=0;s=s?s:1;if(e>t){if(t>0&&r.length>0){o=Math.round(t/Math.ceil(e/r.length));while(true){if(o<0){break}var l=n.apply(a,[r.slice(0,o)]);var g=n.apply(a,[r.slice(0,o+1)]);l=i?l.width:l*s;g=i?g.width:g*s;if(l>t){o--;continue}if(l!=g&&g<t){o++;continue}break}}}else{return r?r.length:0}return o>=0&&o<=r.length?o:0}};return T},true);
//# sourceMappingURL=GanttUtils.js.map