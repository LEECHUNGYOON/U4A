sap.ui.define(["./InputBase","sap/ui/core/Element","sap/ui/core/Item","sap/ui/core/Core","sap/ui/core/LabelEnablement","sap/ui/core/AccessKeysEnablement","./ColumnListItem","./GroupHeaderListItem","sap/ui/core/SeparatorItem","./Table","./library","sap/ui/core/IconPool","sap/ui/Device","./SuggestionsPopover","./Toolbar","./ToolbarSpacer","./Button","sap/ui/core/ResizeHandler","sap/ui/dom/containsOrEquals","sap/base/assert","sap/base/util/deepEqual","sap/m/inputUtils/wordStartsWithValue","sap/m/inputUtils/inputsDefaultFilter","sap/m/inputUtils/highlightDOMElements","sap/m/inputUtils/typeAhead","sap/ui/events/KeyCodes","sap/m/inputUtils/filterItems","sap/m/inputUtils/ListHelpers","sap/m/inputUtils/calculateSelectionStart","sap/m/inputUtils/selectionRange","./InputRenderer","sap/ui/base/ManagedObject","sap/ui/base/ManagedObjectObserver","sap/ui/core/Lib","sap/ui/dom/jquery/selectText"],(function(e,t,s,i,o,n,u,a,r,g,p,l,h,c,d,S,_,y,f,m,v,I,T,b,P,V,R,w,C,A,D,F,M,L){"use strict";var x=p.ListType,H=p.InputTextFormatMode,O=p.InputType,E=p.ListMode,B=p.ListSeparators,U=e.extend("sap.m.Input",{metadata:{interfaces:["sap.ui.core.IAccessKeySupport","sap.m.IToolbarInteractiveControl"],library:"sap.m",properties:{type:{type:"sap.m.InputType",group:"Data",defaultValue:O.Text},maxLength:{type:"int",group:"Behavior",defaultValue:0},dateFormat:{type:"string",group:"Misc",defaultValue:"YYYY-MM-dd",deprecated:!0},showValueHelp:{type:"boolean",group:"Behavior",defaultValue:!1},valueHelpIconSrc:{type:"sap.ui.core.URI",group:"Behavior",defaultValue:"sap-icon://value-help"},showSuggestion:{type:"boolean",group:"Behavior",defaultValue:!1},valueHelpOnly:{type:"boolean",group:"Behavior",defaultValue:!1},filterSuggests:{type:"boolean",group:"Behavior",defaultValue:!0},maxSuggestionWidth:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:null},startSuggestion:{type:"int",group:"Behavior",defaultValue:1},showTableSuggestionValueHelp:{type:"boolean",group:"Behavior",defaultValue:!0},description:{type:"string",group:"Misc",defaultValue:null},fieldWidth:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:"50%"},valueLiveUpdate:{type:"boolean",group:"Behavior",defaultValue:!1},selectedKey:{type:"string",group:"Data",defaultValue:""},textFormatMode:{type:"sap.m.InputTextFormatMode",group:"Misc",defaultValue:H.Value},textFormatter:{type:"function",group:"Misc",defaultValue:null},suggestionRowValidator:{type:"function",group:"Misc",defaultValue:null},enableSuggestionsHighlighting:{type:"boolean",group:"Behavior",defaultValue:!0},enableTableAutoPopinMode:{type:"boolean",group:"Behavior",defaultValue:!1},autocomplete:{type:"boolean",group:"Behavior",defaultValue:!0},showClearIcon:{type:"boolean",defaultValue:!1},effectiveShowClearIcon:{type:"boolean",defaultValue:!1,visibility:"hidden"},separateSuggestions:{type:"boolean",defaultValue:!0,visibility:"hidden"},highlightAccKeysRef:{type:"boolean",defaultValue:!1,visibility:"hidden"},accesskey:{type:"string",defaultValue:"",visibility:"hidden"}},defaultAggregation:"suggestionItems",aggregations:{suggestionItems:{type:"sap.ui.core.Item",multiple:!0,singularName:"suggestionItem"},suggestionColumns:{type:"sap.m.Column",multiple:!0,singularName:"suggestionColumn",bindable:"bindable",forwarding:{getter:"_getSuggestionsTable",aggregation:"columns"}},suggestionRows:{type:"sap.m.ITableItem",multiple:!0,singularName:"suggestionRow",bindable:"bindable",forwarding:{getter:"_getSuggestionsTable",aggregation:"items"}},_suggestionPopup:{type:"sap.ui.core.Control",multiple:!1,visibility:"hidden"},_valueHelpIcon:{type:"sap.ui.core.Icon",multiple:!1,visibility:"hidden"}},associations:{selectedItem:{type:"sap.ui.core.Item",multiple:!1},selectedRow:{type:"sap.m.ColumnListItem",multiple:!1}},events:{liveChange:{parameters:{value:{type:"string"},escPressed:{type:"boolean"},previousValue:{type:"string"}}},valueHelpRequest:{parameters:{fromSuggestions:{type:"boolean"}}},suggest:{parameters:{suggestValue:{type:"string"},suggestionColumns:{type:"sap.m.ListBase"}}},suggestionItemSelected:{parameters:{selectedItem:{type:"sap.ui.core.Item"},selectedRow:{type:"sap.m.ColumnListItem"}}},submit:{parameters:{value:{type:"string"}}}},designtime:"sap/m/designtime/Input.designtime"},renderer:D});l.insertFontFaceStyle(),U._DEFAULTFILTER_TABULAR=function(e,t){for(var s=t.getCells(),i=0;i<s.length;i++)if(s[i].getText&&I(s[i].getText(),e))return!0;return!1},U._DEFAULTRESULT_TABULAR=function(e){if(!e||e.isA("sap.m.GroupHeaderListItem"))return"";for(var t=e.getCells(),s=0;s<t.length;s++)if(t[s].getText)return t[s].getText();return""},U.prototype.init=function(){e.prototype.init.call(this),this._iSetCount=0,this._sProposedItemText=null,this._oRb=L.getResourceBundleFor("sap.m"),-1===this.getId().indexOf("popup-input")&&this._createSuggestionsPopover(),this._setTypedInValue(""),this._bDoTypeAhead=!1,this._isValueInitial=!1,this._previousInputType=this.getType(),this._bClearButtonPressed=!1,this._bAfterOpenFinisihed=!1,n.registerControl(this)};var K=function(e){o.getReferencingLabels(this).forEach((function(t){i.byId(t).setProperty("highlightAccKeysRef",e)}),this)};return U.prototype.getAccessKeysFocusTarget=function(){return this.getFocusDomRef()},U.prototype.onAccKeysHighlightStart=function(){K.call(this,!0)},U.prototype.onAccKeysHighlightEnd=function(){K.call(this,!1)},U.prototype.exit=function(){e.prototype.exit.call(this),this._deregisterEvents(),this.cancelPendingSuggest(),this._iRefreshListTimeout&&(clearTimeout(this._iRefreshListTimeout),this._iRefreshListTimeout=null),this._destroySuggestionsTable(),this._getSuggestionsPopover()&&(this._oSuggestionPopup=null,this._oSuggPopover.destroy(),this._oSuggPopover=null),this.$().off("click")},U.prototype.onBeforeRendering=function(){var t=this.getSelectedKey(),s=this.getShowValueHelp()&&this.getEnabled()&&this.getEditable(),i=this.getProperty("effectiveShowClearIcon")&&this.getEnabled()&&this.getEditable(),o=this._oValueHelpIcon,n=this._getSuggestionsPopover(),u=n&&this._isSuggestionsPopoverOpen(),a=n&&n.getInput(),r=u?n._getValueStateHeader().getText():null,g=u?n._getValueStateHeader().getValueState():"";e.prototype.onBeforeRendering.call(this),!this.getDomRef()&&this.getValue()&&(this._isValueInitial=!0),this.getShowClearIcon()?this._getClearIcon().setProperty("visible",i):this._oClearButton&&this._getClearIcon().setProperty("visible",!1),this._deregisterEvents(),t&&!this.getSelectedItem()&&this.getSuggestionItemByKey(t)&&this.setSelectedKey(t),this.getShowSuggestion()&&(this.getShowTableSuggestionValueHelp()?this._addShowMoreButton():this._removeShowMoreButton(),a&&a.setType(this.getType())),s?(o=this._getValueHelpIcon()).setVisible(!0):o&&o.setVisible(!1),this.getWidth()||this.setWidth("100%"),this._hasTabularSuggestions()&&(this._getSuggestionsTable().setAutoPopinMode(this.getEnableTableAutoPopinMode()),this._getSuggestionsTable().setContextualWidth(this.getEnableTableAutoPopinMode()?"Auto":"Inherit")),u&&(this.getValueStateText()&&r!==this.getValueStateText()||this.getValueState()!==g||this.getFormattedValueStateText())&&this._updateSuggestionsPopoverValueState()},U.prototype.onAfterRendering=function(){e.prototype.onAfterRendering.call(this),!this._isValueInitial&&this.getType()===this._previousInputType||this.getType()!==O.Password||(this.getDomRef("inner").value=this.getProperty("value"),this._isValueInitial=!1),this._previousInputType=this.getType()},U.prototype._getDisplayText=function(e){var t=this.getTextFormatter();if(t)return t(e);var s=e.getText(),i=e.getKey();switch(this.getTextFormatMode()){case H.Key:return i;case H.ValueKey:return s+" ("+i+")";case H.KeyValue:return"("+i+") "+s;default:return s}},U.prototype._onValueUpdated=function(e){if(!this._bSelectingItem&&e!==this._sSelectedValue){var t=this.getSelectedKey(),s=this._getSuggestionsPopover(),i=s&&s.getItemsContainer();(this._hasTabularSuggestions()||""!==t)&&((this._hasTabularSuggestions()?this._getSuggestionsTable()&&!!this._getSuggestionsTable().getSelectedItem():i&&!!i.getSelectedItem())||(this.setProperty("selectedKey","",!0),this.setAssociation("selectedRow",null,!0),this.setAssociation("selectedItem",null,!0)))}},U.prototype.setSelectionItem=function(e,t){if(this._bSelectingItem=!0,!e)return this.setAssociation("selectedItem",null,!0),void this.setValue("");var s,i=this._iSetCount;this.setAssociation("selectedItem",e,!0),this.setProperty("selectedKey",e.getKey(),!0);let o="";o=this._getDisplayText(e),this._setModelPropertyChange(o),t&&this.fireSuggestionItemSelected({selectedItem:e}),s=i!==this._iSetCount?this.getValue():this._getDisplayText(e),this._sSelectedValue=s,this.setSelectionUpdatedFromList(!1);var n=!!this?.mEventRegistry?.suggestionItemSelected?.length;!0===this.isA("sap.m.MultiInput")&&(n=this?.mEventRegistry?.suggestionItemSelected?.length>1),!1===n?this.updateInputField(s):this.setValue(s),this.bIsDestroyed||(this.isMobileDevice()&&this.isA("sap.m.MultiInput")||this._closeSuggestionPopup(),this._bSelectingItem=!1,this._resetTypeAhead())},U.prototype.addSuggestionRowGroup=function(e,t,s){return t=t||new a({title:F.escapeSettingsValue(e.text)||F.escapeSettingsValue(e.key)}),this._createSuggestionPopupContent(!0),this.addAggregation("suggestionRows",t,s),t},U.prototype.addSuggestionItemGroup=function(e,t,s){return t=t||new r({text:F.escapeSettingsValue(e.text)||F.escapeSettingsValue(e.key)}),this._createSuggestionPopupContent(!1),this.addAggregation("suggestionItems",t,s),t},U.prototype.setSelectedItem=function(e){return"string"==typeof e&&(e=t.registry.get(e)),null===e||e instanceof s?(this.setSelectionItem(e),this):this},U.prototype.setSelectedKey=function(e){if(e=this.validateProperty("selectedKey",e),this.setProperty("selectedKey",e,!0),this._hasTabularSuggestions())return this;if(!e)return this.setSelectionItem(),this;var t=this.getSuggestionItemByKey(e);return this.setSelectionItem(t),this},U.prototype.getSuggestionItemByKey=function(e){var t,s,i=this.getSuggestionItems()||[];for(s=0;s<i.length;s++)if((t=i[s]).getKey()===e)return t},U.prototype._getFormattedValueStateText=function(){var t=this._isSuggestionsPopoverOpen(),s=t?this._getSuggestionsPopover()._getValueStateHeader().getFormattedText():null;return t&&s?s:e.prototype.getFormattedValueStateText.call(this)},U.prototype.setSelectionRow=function(e,t){if(!e)return void this.setAssociation("selectedRow",null,!0);this._bSelectingItem=!0;var i,o=this.getSuggestionRowValidator();o&&((i=o(e))instanceof s||(i=null));var n,u=this._iSetCount,a="";this.setAssociation("selectedRow",e,!0),i&&(a=i.getKey()),this.setProperty("selectedKey",a,!0);let r="";r=i?this._getDisplayText(i):this._getRowResultFunction()(e),this._setModelPropertyChange(r),t&&this.fireSuggestionItemSelected({selectedRow:e}),n=u!==this._iSetCount?this.getValue():i?this._getDisplayText(i):this._getRowResultFunction()(e),this._sSelectedValue=n,this.setSelectionUpdatedFromList(!1);var g=!!this?.mEventRegistry?.suggestionItemSelected?.length;!0===this.isA("sap.m.MultiInput")&&(g=this?.mEventRegistry?.suggestionItemSelected?.length>1),!1===g?this.updateInputField(n):this.setValue(n),this.bIsDestroyed||(this.isMobileDevice()&&this.isA("sap.m.MultiInput")&&this._isMultiLineMode||this._closeSuggestionPopup(),this._bSelectingItem=!1,this._resetTypeAhead())},U.prototype.setSelectedRow=function(e){return"string"==typeof e&&(e=t.registry.get(e)),null===e||e instanceof u?(this.setSelectionRow(e),this):this},U.prototype._getValueHelpIcon=function(){var e=this,t=this.getValueHelpIconSrc();return this._oValueHelpIcon?this._oValueHelpIcon.getSrc()!==t&&this._oValueHelpIcon.setSrc(t):this._oValueHelpIcon=this.addEndIcon({id:this.getId()+"-vhi",src:t,useIconTooltip:!1,alt:this._oRb.getText("INPUT_VALUEHELP_BUTTON"),decorative:!1,noTabStop:!0,press:function(t){if(e.getValueHelpOnly())return;var s,i=this.getParent();h.support.touch?((s=i.$("inner")).attr("readonly","readonly"),i.focus(),s.removeAttr("readonly")):i.focus(),e.bValueHelpRequested=!0;let o=e.getLastValue(),n=e.getValue();e._fireValueHelpRequest(!1),o!==n&&e.fireChange({value:n})}}),this._oValueHelpIcon},U.prototype._getClearIcon=function(){var e=this;return this._oClearButton||(this._oClearButton=this.addEndIcon({src:l.getIconURI("decline"),noTabStop:!0,visible:!1,alt:this._oRb.getText("INPUT_CLEAR_ICON_ALT"),useIconTooltip:!1,decorative:!1,press:function(){""!==e.getValue()&&(e.setValue(""),e.fireChange({value:""}),e.fireLiveChange({value:""}),e._bClearButtonPressed=!0,setTimeout((function(){h.system.desktop&&(e.focus(),e._closeSuggestionPopup())}),0))}},0)),this._oClearButton},U.prototype._fireValueHelpRequest=function(e){var t="";t=this.getShowSuggestion()&&!this.isMobileDevice()?this._getTypedInValue()||"":this.getDOMValue(),this.fireValueHelpRequest({fromSuggestions:e,_userInputValue:t})},U.prototype._fireValueHelpRequestForValueHelpOnly=function(){this.getEnabled()&&this.getEditable()&&this.getShowValueHelp()&&this.getValueHelpOnly()&&(h.system.phone&&this.focus(),this._fireValueHelpRequest(!1))},U.prototype.ontap=function(t){e.prototype.ontap.call(this,t),this.isValueHelpOnlyOpener(t.target)&&this._fireValueHelpRequestForValueHelpOnly(),this.shouldSuggetionsPopoverOpenOnMobile(t)&&this._openSuggestionsPopover(),this._bClearButtonPressed=!1},U.prototype.shouldSuggetionsPopoverOpenOnMobile=function(e){return this.isMobileDevice()&&this.getEditable()&&this.getEnabled()&&this.getShowSuggestion()&&!this._bClearButtonPressed&&e.target.id!==this.getId()+"-vhi"},U.prototype.setFilterFunction=function(e){return null==e?(this._fnFilter=T,this):(m("function"==typeof e,"Input.setFilterFunction: first argument fnFilter must be a function on "+this),this._fnFilter=e,this)},U.prototype._getFilterFunction=function(e){return"function"!=typeof this._fnFilter||e?this._hasTabularSuggestions()?U._DEFAULTFILTER_TABULAR:T:this._fnFilter},U.prototype.setRowResultFunction=function(e){var t;return null==e?(this._fnRowResultFilter=U._DEFAULTRESULT_TABULAR,this):(m("function"==typeof e,"Input.setRowResultFunction: first argument fnFilter must be a function on "+this),this._fnRowResultFilter=e,(t=this.getSelectedRow())&&this.setSelectedRow(t),this)},U.prototype._getRowResultFunction=function(e){return"function"!=typeof this._fnRowResultFilter||e?U._DEFAULTRESULT_TABULAR:this._fnRowResultFilter},U.prototype.closeSuggestions=function(){this._closeSuggestionPopup()},U.prototype._doSelect=function(e,t){var s=this._$input[0];if(s){var i=this._$input;s.focus(),i.selectText(e||0,t||i.val().length)}return this},U.prototype._isIncrementalType=function(){var e=this.getType();return"Number"===e||"Date"===e||"Datetime"===e||"Month"===e||"Time"===e||"Week"===e},U.prototype.onsapescape=function(t){if(this._isSuggestionsPopoverOpen())return t.originalEvent._sapui_handledByControl=!0,this._revertPopupSelection(),void(this._getTypedInValue()!==this.getValue()&&this.setValue(this._getTypedInValue()));this.getValueLiveUpdate()&&this.setProperty("value",this.getLastValue(),!0),e.prototype.onsapescape&&e.prototype.onsapescape.apply(this,arguments)},U.prototype.onsapenter=function(t){const s=this._isSuggestionsPopoverOpen(),i=!this.hasStyleClass("sapMFocus")&&s,o=this._hasTabularSuggestions()?this.getSuggestionRows():this.getSuggestionItems(),n=this._getSuggestionsPopover(),u=n?.getItemsContainer()?.getSelectedItem(),a=u?.getTitle?.()||u?.getCells?.()[0]?.getText?.()||"",r=!!this._iSuggestDelay&&!a.toLowerCase().includes(this._getTypedInValue().toLowerCase());let g,p=this.getEnabled()&&this.getEditable();this.cancelPendingSuggest(),i&&this.setSelectionUpdatedFromList(!0),this.getShowSuggestion()&&this._bDoTypeAhead&&s&&!this.isComposingCharacter()&&!r&&(this._hasTabularSuggestions()?u&&this.setSelectionRow(u,!0):u&&this.setSelectionItem(w.getItemByListItem(o,u),!0)),s&&!this.isComposingCharacter()&&(this._closeSuggestionPopup(),g=this.getDOMValue()?this.getDOMValue().length:null,this.selectText(g,g)),!i&&e.prototype.onsapenter.apply(this,arguments),p=p&&!(this.getShowValueHelp()&&this.getValueHelpOnly()),p&&this.fireSubmit({value:this.getValue()}),this.isMobileDevice()||this._resetTypeAhead()},U.prototype.onsapfocusleave=function(s){this.onfocusout(s);let i=sap.ui.getCore().byId(s.relatedControlId);void 0!==i?.onfocusin&&i.onfocusin(s);var o=this._getSuggestionsPopover(),n=o&&o.getPopover(),u=n&&n.isA("sap.m.Popover"),a=s.relatedControlId&&t.registry.get(s.relatedControlId),r=a&&a.getFocusDomRef(),g=n&&r&&f(n.getDomRef(),r);if(u&&(g&&!o.getValueStateActiveState()?(this._bPopupHasFocus=!0,(h.system.desktop&&v(n.getFocusDomRef(),r)||a.isA("sap.m.GroupHeaderListItem"))&&this.focus()):this.getDOMValue()===this._sSelectedSuggViaKeyboard&&(this._sSelectedSuggViaKeyboard=null)),g||e.prototype.onsapfocusleave.apply(this,arguments),this.bValueHelpRequested=!1,!1===g&&void 0!==n&&(n._oPreviousFocus=null,n.close()),!0===g){var p=this.getDomRef("inner")||void 0;void 0!==p&&setTimeout((function(){var e=p.value||"",t=e?.length||0;p.setSelectionRange(t,t)}),0)}if(this._getProposedItemText()&&!this.isMobileDevice())if(this.getShowSuggestion()&&this._bAfterOpenFinisihed)this.setSelectionUpdatedFromList(!0);else{var l=this.getSuggestionItems().filter(function(e){return e.getText()===this._getProposedItemText()}.bind(this))[0];l&&(this.setSelectionItem(l,!0),this.selectText(0,0))}},U.prototype.onmousedown=function(e){this._isSuggestionsPopoverOpen()&&e.stopPropagation()},["onsapup","onsapdown","onsappageup","onsappagedown","onsaphome","onsapend"].forEach((function(e){U.prototype[e]=function(t){("onsapup"!==e&&"onsapdown"!==e||!this.isComposingCharacter())&&this.getShowSuggestion()&&(this._getSuggestionsPopover().handleListNavigation(this,t),this._isIncrementalType()&&t.setMarked(),this.setSelectionUpdatedFromList(!0))}})),U.prototype.setSelectionUpdatedFromList=function(e){this._bSelectionUpdatedFromList=e},U.prototype.getSelectionUpdatedFromList=function(){return this._bSelectionUpdatedFromList},U.prototype.updateSelectionFromList=function(e){if(this._hasTabularSuggestions()&&this.getSelectedRow()!==e)this.setSelectionRow(e,!0);else{var t=w.getItemByListItem(this.getSuggestionItems(),e);t&&this.getSelectedItem()!==t.getId()&&this.setSelectionItem(t,!0)}this.setSelectionUpdatedFromList(!1)},U.prototype._deregisterEvents=function(){this._deregisterPopupResize(),this.isMobileDevice()&&this._getSuggestionsPopover()&&this._getSuggestionsPopover().getPopover()&&this.$().off("click")},U.prototype.updateSuggestionItems=function(){return this._bSuspendInvalidate=!0,this.updateAggregation("suggestionItems"),this._synchronizeSuggestions(),this._bSuspendInvalidate=!1,this},U.prototype.invalidate=function(){this._bSuspendInvalidate||e.prototype.invalidate.apply(this,arguments)},U.prototype.cancelPendingSuggest=function(){this._iSuggestDelay&&(clearTimeout(this._iSuggestDelay),this._iSuggestDelay=null)},U.prototype._triggerSuggest=function(e){var t=this._getSuggestionsPopover().getItemsContainer();this.cancelPendingSuggest(),this._bShouldRefreshListItems=!0,e||(e=""),e.length>=this.getStartSuggestion()?this._iSuggestDelay=setTimeout(function(){this._sPrevSuggValue!==e&&(this._bBindingUpdated=!1,this.fireSuggest({suggestValue:e}),this._bBindingUpdated||this._refreshItemsDelayed(),this._sPrevSuggValue=e)}.bind(this),300):this.isMobileDevice()?t instanceof g?t.addStyleClass("sapMInputSuggestionTableHidden"):t&&t.destroyItems&&t.destroyItems():this._isSuggestionsPopoverOpen()&&setTimeout(function(){(this.getDOMValue()||"").length<this.getStartSuggestion()&&this._closeSuggestionPopup()}.bind(this),0)},U.prototype._shouldTriggerSuggest=function(){return!this._bPopupHasFocus&&!this.getStartSuggestion()&&!this.getValue()&&this.getShowSuggestion()},U.prototype._setModelPropertyChange=function(e){let t=this.getModel()||void 0;if(void 0===t)return;let s=this.getBinding("value")||void 0;if(void 0===s)return;if(void 0===s?.sInternalType)return;let i=s.getType()||void 0;if(void 0===i)return;let o=i.parseValue(e,s.sInternalType),n={};n.context=this.getBindingContext()||void 0,n.path=this.getBindingPath("value"),n.value=o,n.reason="binding",t.firePropertyChange(n)},U.prototype.onchange=function(e){this.getShowValueHelp()||this.getShowSuggestion()||this.getProperty("effectiveShowClearIcon")||this.onChange(e)},U.prototype.oninput=function(t){if(e.prototype.oninput.call(this,t),!t.isMarked("invalid")){var s,i,o,n=this.getDOMValue();this.getValueLiveUpdate()&&this.setProperty("value",n,!0),this.fireLiveChange({value:n,newValue:n}),this.addStyleClass("sapMFocus"),this.getShowSuggestion()&&!this.isMobileDevice()&&(i=(s=this._getSuggestionsPopover()).getItemsContainer(),this._triggerSuggest(n),i&&!s.getValueStateActiveState()?(o=i&&i.getSelectedItem(),i.removeStyleClass("sapMListFocus"),o&&o.removeStyleClass("sapMLIBFocused")):s.getValueStateActiveState()&&"A"!==document.activeElement.tagName&&s._getValueStateHeader().removeStyleClass("sapMPseudoFocus")),this._handleTypeAhead(this)}},U.prototype.onkeydown=function(e){this._bDoTypeAhead=!h.os.android&&this.getAutocomplete()&&e.which!==V.BACKSPACE&&e.which!==V.DELETE},U.prototype.onkeyup=function(e){var t,s,i,o=this.getValue(),n=this.getLastValue(),u=e.which===V.ARROW_DOWN||e.which===V.ARROW_UP;this._bDoTypeAhead||o?this._bDoTypeAhead||u||!o||(i=(s=(t=this.getShowSuggestion()&&this._getSuggestionsPopover())&&t.getItemsContainer())&&s.getSelectedItem(),this._setProposedItemText(null),i&&i.setSelected(!1)):(this.getShowSuggestion()&&this.setSelectedKey(null),n!==o&&this.setLastValue(n)),this.getShowClearIcon()&&this.setProperty("effectiveShowClearIcon",!!o)},U.prototype.getValue=function(){return this.getDomRef("inner")&&this._$input?this.getDOMValue():this.getProperty("value")},U.prototype._refreshItemsDelayed=function(){clearTimeout(this._iRefreshListTimeout),this._iRefreshListTimeout=setTimeout(this._refreshListItems.bind(this),0)},U.prototype._clearSuggestionPopupItems=function(){var e=this._getSuggestionsPopover().getItemsContainer();e&&(e instanceof g?e.removeSelections(!0):e.destroyItems())},U.prototype._hideSuggestionPopup=function(){var e=this._getSuggestionsPopover(),t=e.getPopover(),s=e.getItemsContainer();this.isMobileDevice()?this._hasTabularSuggestions()&&s&&s.addStyleClass("sapMInputSuggestionTableHidden"):this._isSuggestionsPopoverOpen()&&(this._sCloseTimer=setTimeout(function(){this.cancelPendingSuggest(),this._getTypedInValue()&&this.setDOMValue(this._getTypedInValue()),t.close()}.bind(this),0)),this.$("SuggDescr").text(""),this.$("inner").removeAttr("aria-activedescendant")},U.prototype._openSuggestionPopup=function(e){this.isMobileDevice()||(this._sCloseTimer&&(clearTimeout(this._sCloseTimer),this._sCloseTimer=null),this._isSuggestionsPopoverOpen()||this._sOpenTimer||!1===e||!this.getShowSuggestion()||(this._sOpenTimer=setTimeout(function(){this._sOpenTimer=null,this._getSuggestionsPopover()&&this._openSuggestionsPopover()}.bind(this),0)))},U.prototype._applySuggestionAcc=function(e){var t="",s=this._oRb;setTimeout(function(){if(!this.getSuggestionItems().length&&!this._hasTabularSuggestions())return this.$("SuggDescr").text("");t=1===e?s.getText("INPUT_SUGGESTIONS_ONE_HIT"):e>1?s.getText("INPUT_SUGGESTIONS_MORE_HITS",[e]):s.getText("INPUT_SUGGESTIONS_NO_HIT"),this.$("SuggDescr").text(t)}.bind(this),0)},U.prototype._refreshListItems=function(){var e,t=this.getShowSuggestion(),s=this._bDoTypeAhead?this._getTypedInValue():this.getDOMValue()||"";if(!t||!this._bShouldRefreshListItems||!this.getDomRef()||!this.isMobileDevice()&&!this.$().hasClass("sapMInputFocused"))return null;if(this._clearSuggestionPopupItems(),s.length<this.getStartSuggestion())return this._hideSuggestionPopup(),!1;var i=(e=this._getFilteredSuggestionItems(s).items.length)>0;(i=i&&!this.getValueHelpOnly())?this._openSuggestionPopup(this.getValue().length>=this.getStartSuggestion()):this._hideSuggestionPopup(),this._applySuggestionAcc(e)},U.prototype.addSuggestionItem=function(e){return this.addAggregation("suggestionItems",e,!0),this._synchronizeSuggestions(),this._createSuggestionPopupContent(),this},U.prototype.updateSuggestionRows=function(){return this._bSuspendInvalidate=!0,this.updateAggregation("suggestionRows"),this._synchronizeSuggestions(),this._bSuspendInvalidate=!1,this},U.prototype.insertSuggestionItem=function(e,t){return this.insertAggregation("suggestionItems",t,e,!0),this._synchronizeSuggestions(),this._createSuggestionPopupContent(),this},U.prototype.removeSuggestionItem=function(e){var t=this.removeAggregation("suggestionItems",e,!0);return this._synchronizeSuggestions(),t},U.prototype.removeAllSuggestionItems=function(){var e=this.removeAllAggregation("suggestionItems",!0);return this._synchronizeSuggestions(),e},U.prototype.destroySuggestionItems=function(){return this.destroyAggregation("suggestionItems",!0),this._synchronizeSuggestions(),this},U.prototype.bindAggregation=function(){return"suggestionRows"!==arguments[0]&&"suggestionColumns"!==arguments[0]&&"suggestionItems"!==arguments[0]||(this._createSuggestionPopupContent("suggestionRows"===arguments[0]||"suggestionColumns"===arguments[0]),this._bBindingUpdated=!0),e.prototype.bindAggregation.apply(this,arguments)},U.prototype._closeSuggestionPopup=function(){this._bShouldRefreshListItems=!1,this.cancelPendingSuggest(),this._isSuggestionsPopoverOpen()&&this._getSuggestionsPopover().getPopover().close(),!this.isMobileDevice()&&this.$().hasClass("sapMInputFocused")&&this.openValueStateMessage(),this.$("SuggDescr").text(""),this.$("inner").removeAttr("aria-activedescendant"),this._sPrevSuggValue=null},U.prototype._synchronizeSuggestions=function(){var e=this._getSuggestionsPopover(),t=e&&e.getInput(),s=t&&t.getFocusDomRef();document.activeElement!==this.getFocusDomRef()&&document.activeElement!==s||(this._bShouldRefreshListItems=!0,this._refreshItemsDelayed()),this.getDomRef()&&!this._isSuggestionsPopoverOpen()&&this._synchronizeSelection()},U.prototype._synchronizeSelection=function(){var e=this.getSelectedKey();e&&(!this.getValue()||this.getSelectedItem()||this.getSelectedRow())&&this.setSelectedKey(e)},U.prototype.onfocusin=function(t){e.prototype.onfocusin.apply(this,arguments),this.addStyleClass("sapMInputFocused"),!this.isMobileDevice()&&this._isSuggestionsPopoverOpen()&&this.closeValueStateMessage(),this._shouldTriggerSuggest()&&this._triggerSuggest(this.getValue()),this._bPopupHasFocus=void 0,this._sPrevSuggValue=null},U.prototype.oncompositionend=function(t){e.prototype.oncompositionend.apply(this,arguments),h.browser.firefox||this._handleTypeAhead(this)},U.prototype._getEffectiveTypeAhead=function(){var e=this._getSuggestionsPopover(),t=e&&e.getInput();return this.isMobileDevice()&&null===this._bDoTypeAhead?t._bDoTypeAhead&&!!t&&document.activeElement===t.getFocusDomRef():this._bDoTypeAhead&&document.activeElement===this.getFocusDomRef()},U.prototype._handleTypeAhead=function(e){var t,s=this.getValue(),i=e.getFocusDomRef(),o={value:"",selectedItem:null},n=e._getSuggestionsPopover()&&e._getSuggestionsPopover().getItemsContainer(),u=this._getEffectiveTypeAhead();if(i.selectionStart!==i.selectionEnd?this._setTypedInValue(i.value.substring(0,i.selectionStart)):this._setTypedInValue(i.value),(e&&e.getValue().toLowerCase())!==(this._getProposedItemText()&&this._getProposedItemText().toLowerCase())&&(e._setProposedItemText(null),u)){var a=e._hasTabularSuggestions(),r=a?e.getSuggestionRows():e.getSuggestionItems(),g=function(t){return t?a?e._getRowResultFunction()(t):t.getText():""};if(this.isMobileDevice()&&n&&!r.length)return t={onBeforeRendering:function(){n.getItems().length&&this._handleTypeAhead(e)},onAfterRendering:function(){n.getItems().length&&n.removeDelegate(t)}},void n.addDelegate(t,this);var p=P(s,this,r,function(e){return this._formatTypedAheadValue(g(e))}.bind(this));return o.value=g(p[0]),o.selectedItem=p[0],e._setProposedItemText(o.value),this._mTypeAheadInfo=o,o}},U.prototype._resetTypeAhead=function(e){(e=e||this)._setProposedItemText(null),this._setTypedInValue("")},U.prototype.onsapright=function(){var e=this.getValue(),t=this.getFocusDomRef();this.getAutocomplete()&&this._getTypedInValue()!==e&&(this._setTypedInValue(t.value.substring(0,t.selectionStart)),this.fireLiveChange({value:e,newValue:e}))},U.prototype._formatTypedAheadValue=function(e){var t=this._getTypedInValue();return 0===e.toLowerCase().indexOf(t.toLowerCase())?t.concat(e.substring(t.length,e.length)):e},U.prototype.onsapshow=function(e){this.getEnabled()&&this.getEditable()&&this.getShowValueHelp()&&(this.bValueHelpRequested=!0,this._fireValueHelpRequest(!1),e.preventDefault(),e.stopPropagation())},U.prototype.onsaphide=U.prototype.onsapshow,U.prototype.onsapselect=function(e){this._fireValueHelpRequestForValueHelpOnly()},U.prototype.onfocusout=function(t){e.prototype.onfocusout.apply(this,arguments),this.removeStyleClass("sapMInputFocused"),this.$("SuggDescr").text("")},U.prototype._hasTabularSuggestions=function(){return!(!this.getAggregation("suggestionColumns")||!this.getAggregation("suggestionColumns").length)},U.prototype._getSuggestionsTable=function(){return this._bIsBeingDestroyed?null:(this._oSuggestionsTable||(this._oSuggestionsTable=this._createSuggestionsTable()),this._oSuggestionsTable)},U.prototype._destroySuggestionsTable=function(){this._oSuggestionsTable&&(this._oSuggestionsTable.destroy(),this._oSuggestionsTable=null)},U.prototype._createSuggestionsTable=function(){var e=new g(this.getId()+"-popup-table",{mode:E.SingleSelectMaster,showNoData:!1,showSeparators:this.getProperty("separateSuggestions")?B.Inner:B.None,width:"100%",enableBusyIndicator:!1,rememberSelections:!1,itemPress:function(e){h.system.desktop&&this.focus();var t=e.getParameter("listItem");this.setSelectionRow(t,!0)}.bind(this),sticky:[p.Sticky.ColumnHeaders]});return e.addEventDelegate({onAfterRendering:function(){var t;this.getEnableSuggestionsHighlighting()&&(t=e.$().find("tbody .sapMText, tbody .sapMLabel"),b(t,this._getTypedInValue()))}},this),this.isMobileDevice()&&e.addStyleClass("sapMInputSuggestionTableHidden"),e.updateItems=function(){return g.prototype.updateItems.apply(this,arguments),this._refreshItemsDelayed(),this},new M(function(e){var t=e.mutation,s=e.child,i="items"===e.name;switch(t){case"insert":i&&(s.setType(x.Active),this._createSuggestionPopupContent(!0),this._synchronizeSuggestions());break;case"remove":i&&this._synchronizeSuggestions()}}.bind(this)).observe(e,{aggregations:["items","columns"]}),e},U.prototype.clone=function(){var t=e.prototype.clone.apply(this,arguments);return t.setRowResultFunction(this._fnRowResultFilter),t.setValue(this.getValue()),t},U.prototype.setValue=function(t){return this._iSetCount++,e.prototype.setValue.call(this,t),this._onValueUpdated(t),this._setTypedInValue(""),this.setProperty("effectiveShowClearIcon",!!t),this},U.prototype.setDOMValue=function(e){this._$input.val(e)},U.prototype.getDOMValue=function(){return this._$input.val()},U.prototype._getInputValue=function(){return e.prototype._getInputValue.apply(this,arguments)},U.prototype.updateInputField=function(e){this._isSuggestionsPopoverOpen()&&this.isMobileDevice()?this._getSuggestionsPopover().getInput().setValue(e)._doSelect():(e=this._getInputValue(e),this.setDOMValue(e),this.onChange(null,null,e))},U.prototype.getAccessibilityInfo=function(){var t=e.prototype.getAccessibilityInfo.apply(this,arguments);return t.description=((t.description||"")+" "+this.getDescription()).trim(),t},U.prototype.preventChangeOnFocusLeave=function(e){return this.bFocusoutDueRendering||this.bValueHelpRequested},U.prototype._getShowMoreButton=function(){return this._getSuggestionsPopover().getShowMoreButton()},U.prototype._getShowMoreButtonPress=function(){var e,t=this._getTypedInValue();this.getShowTableSuggestionValueHelp()&&(t&&(e=t,this.updateDomValue(e),this._resetTypeAhead(),this._setTypedInValue(e)),this._fireValueHelpRequest(!0),this._closeSuggestionPopup())},U.prototype._addShowMoreButton=function(){var e=this._getSuggestionsPopover(),t=e&&e.getPopover();if(t&&this._hasTabularSuggestions()&&!this._getShowMoreButton()){var s=new _({text:this._oRb.getText("INPUT_SUGGESTIONS_SHOW_ALL"),press:this._getShowMoreButtonPress.bind(this)});t.isA("sap.m.Dialog")?e.setShowMoreButton(s):e.setShowMoreButton(new d({content:[new S,s]}))}},U.prototype._removeShowMoreButton=function(){var e=this._getSuggestionsPopover();e&&e.getPopover()&&this._hasTabularSuggestions()&&this._getShowMoreButton()&&e.removeShowMoreButton()},U.prototype._hasShowSelectedButton=function(){return!1},U.prototype._createSuggestionPopupContent=function(e){var t=this._getSuggestionsPopover(),s=t.getItemsContainer();s&&(s.isA("sap.m.Table")&&!e||s.isA("sap.m.List")&&e)&&(s.destroy(),s=null,this._destroySuggestionsTable()),this._bIsBeingDestroyed||!t||s||(t.initContent(this.getId(),e?this._getSuggestionsTable():null),this._hasTabularSuggestions()||e?this._decorateSuggestionsPopoverTable():this._decorateSuggestionsPopoverList(t.getItemsContainer()))},U.prototype._decorateSuggestionsPopoverList=function(e){e&&e.isA("sap.m.List")&&(e.addEventDelegate({onAfterRendering:function(){var t,s;this.getEnableSuggestionsHighlighting()&&(t=e.$().find(".sapMSLIInfo [id$=-infoText], .sapMSLITitleOnly [id$=-titleText]"),s=((s=this._bDoTypeAhead?this._getTypedInValue():this.getValue())||"").toLowerCase(),b(t,s))}},this),e.attachItemPress((function(e){h.system.desktop&&this.focus();var t=e.getParameter("listItem");t.isA("sap.m.GroupHeaderListItem")||this.setSelectionItem(w.getItemByListItem(this.getSuggestionItems(),t),!0)}),this))},U.prototype._decorateSuggestionsPopoverTable=function(){this.getShowTableSuggestionValueHelp()&&this._addShowMoreButton()},U.prototype._decoratePopupInput=function(e){if(e)return e.setValueLiveUpdate(!0),e.setValueState(this.getValueState()),e.setShowValueHelp(this.getShowValueHelp()),e.attachValueHelpRequest(function(){this.fireValueHelpRequest({fromSuggestions:!0}),this._getSuggestionsPopover().iPopupListSelectedIndex=-1,this._closeSuggestionPopup()}.bind(this)),e.attachLiveChange(function(e){var t=e.getParameter("newValue");this.setDOMValue(this._getInputValue(this._getSuggestionsPopover().getInput().getValue())),this._triggerSuggest(t),this.fireLiveChange({value:t,newValue:t})}.bind(this)),e._handleTypeAhead=function(){U.prototype._handleTypeAhead.call(e,this)}.bind(this),e._resetTypeAhead=function(){U.prototype._resetTypeAhead.call(e,this)}.bind(this),e.addEventDelegate({onsapenter:function(){this.setValue(this._getProposedItemText())}},this),e},U.prototype.forwardEventHandlersToSuggPopover=function(e){e.setOkPressHandler(this._closeSuggestionPopup.bind(this)),e.setCancelPressHandler(this._revertPopupSelection.bind(this))},U.prototype._revertPopupSelection=function(){var e=this._getSuggestionsPopover(),t=e&&e.getInput();this._setProposedItemText(null),this.setSelectionUpdatedFromList(!1),this.isMobileDevice()&&t&&t.setDOMValue(this.getLastValue()),this._closeSuggestionPopup()},U.prototype._getSuggestionsPopover=function(){return this._oSuggPopover},U.prototype._createSuggestionsPopover=function(){var e=this._oSuggPopover=new c(this);return e.decorateParent(this),e.setInputLabels(this.getLabels.bind(this)),this._createSuggestionsPopoverPopup(),this.forwardEventHandlersToSuggPopover(e),e.attachEvent(c.M_EVENTS.SELECTION_CHANGE,(function(e){var t=e.getParameter("newItem"),s=this.calculateNewValue(t),i=t&&t.isA("sap.m.GroupHeaderListItem"),o=this.getFocusDomRef(),n=o&&o.value.substring(0,o.selectionStart),u=e.getParameter("previousItem"),a=u&&u.isA("sap.m.GroupHeaderListItem"),r=C(A(o,a),s,n,a);!t||i?this.setDOMValue(n):(this.setDOMValue(s),r=0===r&&0===s.indexOf(n)?n.length:r,this._doSelect(r)),this._sSelectedSuggViaKeyboard=s}),this),this.getShowTableSuggestionValueHelp()&&this._addShowMoreButton(),this._oSuggPopover},U.prototype.calculateNewValue=function(e){return!e||e&&e.isA("sap.m.GroupHeaderListItem")?"":e.isA("sap.m.ColumnListItem")?this._getInputValue(this._getRowResultFunction()(e)):e.isA("sap.m.StandardListItem")?this._getInputValue(e.getTitle()):void 0},U.prototype._createSuggestionsPopoverPopup=function(){var t,s=this._getSuggestionsPopover();s.createSuggestionPopup(this,{showSelectedButton:this._hasShowSelectedButton()},U),this._decoratePopupInput(s.getInput()),(t=s.getPopover()).attachBeforeOpen((function(){this._updateSuggestionsPopoverValueState()}),this),t.attachBeforeClose((function(){this._updateSuggestionsPopoverValueState()}),this),t.attachAfterOpen((function(){var e,t=this.getShowSuggestion()&&this._getSuggestionsPopover(),s=t&&t.getItemsContainer();e=this._handleTypeAhead(this),this._getProposedItemText()&&s&&!s.getSelectedItem()&&e&&e.selectedItem&&((this._hasTabularSuggestions()?e.selectedItem:w.getListItem(e.selectedItem)).setSelected(!0),this.setSelectionUpdatedFromList(!0))}),this),this.isMobileDevice()?t.attachBeforeClose((function(){this.setDOMValue(this._getInputValue(s.getInput().getValue())),this.onChange()}),this).attachAfterClose((function(){var e=s.getItemsContainer();if(e){var t=e&&e.getSelectedItem();this._getProposedItemText()&&t&&this.setSelectionUpdatedFromList(!0),this.getSelectionUpdatedFromList()&&this.updateSelectionFromList(t),!g||e instanceof g?e.removeSelections(!0):e.destroyItems()}}),this).attachAfterOpen((function(){this._triggerSuggest(this.getValue()),this._refreshListItems()}),this).attachBeforeOpen((function(){var e=s.getInput();["placeholder","maxLength","value","showClearIcon","effectiveShowClearIcon"].forEach((function(t){e.setProperty(t,this.getProperty(t))}),this)}),this):(t.attachAfterClose((function(){const e=s.getItemsContainer(),t=this._getSuggestionsPopover(),i=t?.getItemsContainer()?.getSelectedItem(),o=this.getDomRef(),n=i?.getTitle?.()||i?.getCells?.()[0]?.getText?.()||"";!!this._iSuggestDelay&&!n.toLowerCase().includes(this.getValue().toLowerCase())||(this.getSelectionUpdatedFromList()&&this.updateSelectionFromList(i),e&&(this._bAfterOpenFinisihed=!1,e instanceof g?(i?.removeStyleClass("sapMLIBFocused"),e.removeSelections(!0)):e.destroyItems(),this._deregisterPopupResize(),o&&o.contains(document.activeElement)&&this.addStyleClass("sapMFocus")))}),this).attachBeforeOpen((function(){s._sPopoverContentWidth=this.getMaxSuggestionWidth(),s.resizePopup(this),this._registerPopupResize(),this._bAfterOpenFinisihed=!1}),this),t.addEventDelegate({onAfterRendering:function(){var e=this.getDomRef().getBoundingClientRect().width,t=getComputedStyle(this.getDomRef()).getPropertyValue("--sPopoverMaxWidth");this._bAfterOpenFinisihed=!0,this.getMaxSuggestionWidth()||(e<=parseInt(t)&&!h.system.phone?s.getPopover().addStyleClass("sapMSuggestionPopoverDefaultWidth"):(s.getPopover().getDomRef().style.setProperty("max-width",e+"px"),s.getPopover().addStyleClass("sapMSuggestionPopoverInputWidth")),s.getPopover().getDomRef().style.setProperty("min-width",e+"px"))}},this)),t.attachAfterClose((function(t){if(void 0!==this._sCloseTimer&&null!==this._sCloseTimer)return;this.getLastValue()!==this.getValue()&&e.prototype.onChange.call(this)}),this),this.setAggregation("_suggestionPopup",t),this._oSuggestionPopup=t},U.prototype._registerPopupResize=function(){var e=this._getSuggestionsPopover();this._sPopupResizeHandler=y.register(this,e.resizePopup.bind(e,this))},U.prototype._deregisterPopupResize=function(){this._sPopupResizeHandler&&(this._sPopupResizeHandler=y.deregister(this._sPopupResizeHandler))},U.prototype.showItems=function(e){var t,s=this._getFilterFunction(),i=!this.getEnabled()||!this.getEditable();(i=i||this.getValueHelpOnly())||(this.setFilterFunction(e||function(){return!0}),this._clearSuggestionPopupItems(),(t=this._getFilteredSuggestionItems(this.getDOMValue()).items.length)>0?this._openSuggestionPopup():this._hideSuggestionPopup(),this._applySuggestionAcc(t),this.setFilterFunction(s))},U.prototype.shouldValueStateMessageBeOpened=function(){return!(!e.prototype.shouldValueStateMessageBeOpened.apply(this,arguments)||this._isSuggestionsPopoverOpen())},U.prototype._isSuggestionsPopoverOpen=function(){return this._getSuggestionsPopover()&&this._getSuggestionsPopover().isOpen()},U.prototype.isMobileDevice=function(){return h.system.phone},U.prototype._openSuggestionsPopover=function(){this.closeValueStateMessage(),this._updateSuggestionsPopoverValueState(),this._getSuggestionsPopover().getPopover().open()},U.prototype._updateSuggestionsPopoverValueState=function(){var e=this._getSuggestionsPopover(),t=this.getValueState(),s=this.getValueState()!==e._getValueStateHeader().getValueState(),i=this.getFormattedValueStateText(),o=this.getValueStateText();e&&(!this._isSuggestionsPopoverOpen()||i||s||this.setFormattedValueStateText(e._getValueStateHeader().getFormattedText()),e.updateValueState(t,i||o,this.getShowValueStateMessage()),this.isMobileDevice()&&e.getInput().setValueState(t))},U.prototype.setShowValueHelp=function(e){var t=this._getSuggestionsPopover()&&this._getSuggestionsPopover().getInput();return this.setProperty("showValueHelp",e),t&&t.setShowValueHelp(e),this},U.prototype.isValueHelpOnlyOpener=function(e){return!0},U.prototype._getFilteredSuggestionItems=function(e){var t,s=this._getSuggestionsPopover(),i=s.getItemsContainer(),o=s&&s.getInput();return(this.isMobileDevice()?!o._getProposedItemText()&&!o._mTypeAheadInfo||o._mTypeAheadInfo&&!o._mTypeAheadInfo.value:this._getProposedItemText()&&!this._mTypeAheadInfo||this._mTypeAheadInfo&&!this._mTypeAheadInfo.value)&&this._handleTypeAhead(this),this._hasTabularSuggestions()?(this.isMobileDevice()&&i&&i.removeStyleClass("sapMInputSuggestionTableHidden"),t=this.filterTabularItems(this.getSuggestionRows(),e)):(t=R(this,this.getSuggestionItems(),e,this.getFilterSuggests(),!0,this._getFilterFunction()),this._mapItems(t)),t},U.prototype.filterTabularItems=function(e,t){var s,i=this.getFilterSuggests(),o=[],n=[],u=!1,a=this._getFilterFunction();return e.forEach((function(e){e.isA("sap.m.GroupHeaderListItem")?n.push({header:e,visible:!1}):(s=!i||a(t,e),e.setVisible(s),s&&o.push(e),!u&&s&&this._getProposedItemText()===this._getRowResultFunction()(e)&&(e.setSelected(!0),u=!0),n.length&&s&&(n[n.length-1].visible=!0))}),this),n.forEach((function(e){e.header.setVisible(e.visible)})),this._getSuggestionsTable().invalidate(),{items:o,groups:n}},U.prototype._mapItems=function(e){var t,s,i=this.getSuggestionItems(),o=e.items,n=e.groups,u=n.map((function(e){return e.header})),a=!1,r=this._getSuggestionsPopover().getItemsContainer();i.filter((function(e){return o.indexOf(e)>-1||u.indexOf(e)>-1})).map((function(e){return t=w.createListItemFromCoreItem(e,!0),r.addItem(t),a||this._getProposedItemText()!==e.getText()||(t.setSelected(!0),a=!0),e}),this).filter((function(e){return u.indexOf(e)>-1})).forEach((function(e){(s=u.indexOf(e))>-1&&(t=w.getListItem(e))&&t.setVisible(n[s].visible)}))},U.prototype._setTypedInValue=function(e){return this._sTypedInValue=e,this},U.prototype._getTypedInValue=function(){return this._sTypedInValue},U.prototype._setSeparateSuggestions=function(e){var t=this._getSuggestionsTable();return this.setProperty("separateSuggestions",e),t&&t.setShowSeparators(e?B.Inner:B.None),this},U.prototype._setProposedItemText=function(e){return this._sProposedItemText=e,this},U.prototype._getProposedItemText=function(){return this._sProposedItemText},U.prototype._getToolbarInteractive=function(){return!0},U}));