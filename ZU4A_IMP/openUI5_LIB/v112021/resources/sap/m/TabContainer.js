sap.ui.define(["./library","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/core/util/ResponsivePaddingsEnablement","./TabContainerRenderer","./TabStrip","./TabStripItem","./Button","sap/ui/Device"],(function(t,e,i,o,n,r,a,s,p){"use strict";var d=t.ButtonType,g=t.PageBackgroundDesign,m=e.extend("sap.m.TabContainer",{metadata:{library:"sap.m",properties:{showAddNewButton:{type:"boolean",group:"Misc",defaultValue:!1},backgroundDesign:{type:"sap.m.PageBackgroundDesign",group:"Appearance",defaultValue:g.List}},aggregations:{items:{type:"sap.m.TabContainerItem",multiple:!0,singularName:"item",bindable:"bindable"},_addNewButton:{type:"sap.m.Button",multiple:!1,visibility:"hidden"},_tabStrip:{type:"sap.ui.core.Control",multiple:!1,visibility:"hidden"}},associations:{selectedItem:{type:"sap.m.TabContainerItem",multiple:!1}},events:{itemClose:{allowPreventDefault:!0,parameters:{item:{type:"sap.m.TabContainerItem"}}},itemSelect:{allowPreventDefault:!0,parameters:{item:{type:"sap.m.TabContainerItem"}}},addNewButtonPress:{}},designtime:"sap/m/designtime/TabContainer.designtime",dnd:{draggable:!1,droppable:!0}},constructor:function(t,i){var o=[];i||"object"!=typeof t||(i=t),i&&Array.isArray(i.items)&&(o=i.items,delete i.items),e.prototype.constructor.apply(this,arguments);var n=new r(this.getId()+"--tabstrip",{hasSelect:!0,itemSelect:function(t){var e=t.getParameter("item"),i=this._fromTabStripItem(e);this.setSelectedItem(i,t)}.bind(this),itemClose:function(t){var e=t.getParameter("item"),i=this._fromTabStripItem(e);t.preventDefault(),this.fireItemClose({item:i})&&(this.getBinding("items")||this.removeItem(i))}.bind(this)});this.setAggregation("_tabStrip",n,!0),i&&i.showAddNewButton&&this.setShowAddNewButton(!0),o.forEach((function(t){this.addItem(t)}),this),this.data("sap-ui-fastnavgroup","true",!0)},renderer:n}),l={name:"text",additionalText:"additionalText",icon:"icon",iconTooltip:"iconTooltip",modified:"modified"};return o.call(m.prototype,{header:{selector:".sapMTabStripContainer"}}),m.prototype.init=function(){this._initResponsivePaddingsEnablement()},m.prototype.onBeforeRendering=function(){this.getSelectedItem()||this._setDefaultTab()},m.prototype._getAddNewTabButton=function(){var t=this.getAggregation("_addNewButton"),e=sap.ui.getCore().getLibraryResourceBundle("sap.m");return t||((t=new s({type:d.Transparent,tooltip:e.getText("TABCONTAINER_ADD_NEW_TAB"),icon:i.getIconURI("add"),press:function(){this.getParent().getParent().fireAddNewButtonPress()}})).addStyleClass("sapMTSAddNewTabBtn"),this.setAggregation("_addNewButton",t,!0)),t},m.prototype._getTabStrip=function(){return this.getAggregation("_tabStrip")},m.prototype._fromTabStripItem=function(t){for(var e=this.getItems()||[],i=e.length,o=0;o<i;o++)if(e[o].getId()===t.getKey())return e[o];return null},m.prototype._toTabStripItem=function(t){var e,i,o=0,n=t,r=this._getTabStrip();if(!r)return null;for(i=(e=r.getItems()).length,"object"==typeof t&&(n=t.getId());o<i;o++)if(e[o].getKey()===n)return e[o];return null},m.prototype._getSelectedItemContent=function(){var t=this._getTabStrip(),e=this.getSelectedItem(),i=sap.ui.getCore().byId(e),o=this._toTabStripItem(i);return t&&t.setSelectedItem(o),i?i.getContent():null},m.prototype._moveToNextItem=function(t){if(this._getTabStrip()._oItemNavigation){var e=this.getItems().length,i=this._getTabStrip()._oItemNavigation.getFocusedIndex(),o=e===i?--i:i,n=this.getItems()[o],r=document.activeElement.classList;t&&(this.setSelectedItem(n),this.fireItemSelect({item:n})),(r.contains("sapMTabStripSelectListItemCloseBtn")||r.contains("sapMTabStripItem"))&&setTimeout(function(){this._getTabStrip()._oItemNavigation&&this._getTabStrip()._oItemNavigation.focusItem(o)}.bind(this),0)}},m.prototype._attachItemPropertyChanged=function(t){t.attachItemPropertyChanged(function(t){var e=t.mParameters.propertyKey;if(l[e]){e=l[e];var i=this._toTabStripItem(t.getSource()),o="set"+e.substr(0,1).toUpperCase()+e.substr(1);i&&i[o](t.mParameters.propertyValue)}}.bind(this))},m.prototype.removeItem=function(t){var e,i,o=this._getTabStrip();return null==t?null:(e=(t=this.removeAggregation("items",t)).getId()===this.getSelectedItem(),(i=this._toTabStripItem(t)).getId()===o.getSelectedItem()&&o.removeAllAssociation("selectedItem",!0),o.removeItem(i),this._moveToNextItem(e),t)},m.prototype.addAggregation=function(t,i,o){return"items"===t&&this._attachItemPropertyChanged(i),e.prototype.addAggregation.call(this,t,i,o)},m.prototype.insertAggregation=function(t,i,o,n){return"items"===t&&this._attachItemPropertyChanged(i),e.prototype.insertAggregation.call(this,t,i,o,n)},m.prototype.addItem=function(t){return this.addAggregation("items",t,!1),this._getTabStrip().addItem(new a({key:t.getId(),text:t.getName(),additionalText:t.getAdditionalText(),icon:t.getIcon(),iconTooltip:t.getIconTooltip(),modified:t.getModified(),tooltip:t.getTooltip()})),this},m.prototype.destroyItems=function(){return this._getTabStrip().destroyItems(),this.setAssociation("selectedItem",null),this.destroyAggregation("items")},m.prototype.insertItem=function(t,e){return this._getTabStrip().insertItem(new a({key:t.getId(),text:t.getName(),additionalText:t.getAdditionalText(),icon:t.getIcon(),iconTooltip:t.getIconTooltip(),modified:t.getModified(),tooltip:t.getTooltip(),customData:t.getCustomData()}),e),this.insertAggregation("items",t,e)},m.prototype.removeAllItems=function(){return this._getTabStrip().removeAllItems(),this.setSelectedItem(null),this.removeAllAggregation("items")},m.prototype.setAddButton=function(t){return this._getTabStrip().setAddButton(t)},m.prototype.getAddButton=function(){return this._getTabStrip().getAddButton()},m.prototype.setShowAddNewButton=function(t){this.setProperty("showAddNewButton",t,!0),p.system.phone&&(t?this.addStyleClass("sapUiShowAddNewButton"):this.removeStyleClass("sapUiShowAddNewButton"));var e=this._getTabStrip();return e&&e.setAddButton(t?this._getAddNewTabButton():null),this},m.prototype.setSelectedItem=function(t,e){if(this.fireItemSelect({item:t})){var i=this._getTabStrip();return t&&i&&(i.setSelectedItem(this._toTabStripItem(t)),this._rerenderContent(t.getContent())),this.setAssociation("selectedItem",t,!0),this}return e&&e.preventDefault(),this},m.prototype._rerenderContent=function(t){var e,i=this.$("content");if(t&&!(i.length<=0)){e=sap.ui.getCore().createRenderManager();for(var o=0;o<t.length;o++)e.renderControl(t[o]);e.flush(i[0]),e.destroy()}},m.prototype._setDefaultTab=function(){var t=this.getItems()[0]||null;return this.setSelectedItem(t),t},m}));