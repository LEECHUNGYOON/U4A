sap.ui.define(["./library","sap/ui/core/Control","sap/m/Text","sap/ui/core/HTML","sap/ui/core/Icon","sap/ui/core/IconPool","sap/m/Button","sap/m/GenericTileRenderer","sap/m/GenericTileLineModeRenderer","sap/m/Image","sap/ui/Device","sap/ui/core/ResizeHandler","sap/base/strings/camelize","sap/base/util/deepEqual","sap/ui/events/PseudoEvents","sap/ui/core/theming/Parameters","sap/ui/thirdparty/jquery","sap/ui/core/library","sap/ui/core/Configuration","sap/ui/core/InvisibleText","sap/ui/core/Core","sap/ui/core/Theming"],(function(e,t,i,o,s,n,a,r,l,h,p,d,c,g,u,_,jQuery,T,y,m,f,v){"use strict";var M,I=e.GenericTileScope,A=e.LoadState,S=T.CSSColor,C=e.FrameType,b=e.Size,R=e.GenericTileMode,L=e.TileSizeBehavior,x=e.WrappingType,B=e.URLHelper;M=_.get({name:"sapLegendColor9",callback:function(e){M=e}});var E="GenericTileDeviceSet",D={},P=t.extend("sap.m.GenericTile",{metadata:{library:"sap.m",properties:{mode:{type:"sap.m.GenericTileMode",group:"Appearance",defaultValue:R.ContentMode},header:{type:"string",group:"Appearance",defaultValue:null},subheader:{type:"string",group:"Appearance",defaultValue:null},failedText:{type:"string",group:"Appearance",defaultValue:null},size:{type:"sap.m.Size",group:"Misc",defaultValue:b.Auto,deprecated:!0},frameType:{type:"sap.m.FrameType",group:"Misc",defaultValue:C.OneByOne},systemInfo:{type:"string",group:"Misc",defaultValue:null},appShortcut:{type:"string",group:"Misc",defaultValue:null},backgroundImage:{type:"sap.ui.core.URI",group:"Misc",defaultValue:null},headerImage:{type:"sap.ui.core.URI",group:"Misc",defaultValue:null},state:{type:"sap.m.LoadState",group:"Misc",defaultValue:A.Loaded},imageDescription:{type:"string",group:"Accessibility",defaultValue:null},scope:{type:"sap.m.GenericTileScope",group:"Misc",defaultValue:I.Display},sizeBehavior:{type:"sap.m.TileSizeBehavior",defaultValue:L.Responsive},ariaLabel:{type:"string",group:"Accessibility",defaultValue:null},ariaRole:{type:"string",group:"Accessibility",defaultValue:null},ariaRoleDescription:{type:"string",group:"Accessibility",defaultValue:null},url:{type:"sap.ui.core.URI",group:"Misc",defaultValue:null},enableNavigationButton:{type:"boolean",group:"Misc",defaultValue:!1},pressEnabled:{type:"boolean",group:"Misc",defaultValue:!0},navigationButtonText:{type:"string",group:"Misc",defaultValue:null},wrappingType:{type:"sap.m.WrappingType",group:"Appearance",defaultValue:x.Normal},width:{type:"sap.ui.core.CSSSize",group:"Appearance"},additionalTooltip:{type:"string",group:"Accessibility",defaultValue:null},tileIcon:{type:"sap.ui.core.URI"},backgroundColor:{type:"string",group:"Appearance",defaultValue:M},valueColor:{type:"sap.m.ValueColor",group:"Appearance",defaultValue:"None"},iconLoaded:{type:"boolean",group:"Misc",defaultValue:!0},renderOnThemeChange:{type:"boolean",group:"Misc",defaultValue:!1},tileBadge:{type:"string",group:"Misc",defaultValue:""},dropAreaOffset:{type:"int",group:"Misc",defaultValue:0}},defaultAggregation:"tileContent",aggregations:{tileContent:{type:"sap.m.TileContent",multiple:!0,bindable:"bindable"},linkTileContents:{type:"sap.m.LinkTileContent",multiple:!0,singularName:"linkTileContent"},icon:{type:"sap.ui.core.Control",multiple:!1,deprecated:!0},actionButtons:{type:"sap.m.Button",multiple:!0,bindable:"bindable"},_titleText:{type:"sap.m.Text",multiple:!1,visibility:"hidden"},_failedMessageText:{type:"sap.m.Text",multiple:!1,visibility:"hidden"},_invisibleText:{type:"sap.ui.core.InvisibleText",multiple:!1,visibility:"hidden"},_tileIcon:{type:"sap.ui.core.Icon",multiple:!1,visibility:"hidden"},_tileIconImage:{type:"sap.m.Image",multiple:!1,visibility:"hidden"}},events:{press:{parameters:{scope:{type:"sap.m.GenericTileScope"},action:{type:"string"},domRef:{type:"any"}}}}},renderer:{apiVersion:2,render:function(e,t){t.getMode()===R.LineMode?l.render(e,t):r.render(e,t)}}});P._Action={Press:"Press",Remove:"Remove",More:"More"},P.LINEMODE_SIBLING_PROPERTIES=["state","subheader","header","scope"],P.prototype.init=function(){this._oRb=f.getLibraryResourceBundle("sap.m"),p.media.hasRangeSet(E)||p.media.initRangeSet(E,[450],"px",["small","large"]),this._oTitle=new i(this.getId()+"-title"),this._oTitle.addStyleClass("sapMGTTitle"),this._oTitle.cacheLineHeight=!1,this.setAggregation("_titleText",this._oTitle,!0),this._oAppShortcut=new i(this.getId()+"-appShortcut"),this._oAppShortcut.cacheLineHeight=!1,this.addDependent(this._oAppShortcut),this._oSystemInfo=new i(this.getId()+"-systemInfo"),this._oSystemInfo.cacheLineHeight=!1,this.addDependent(this._oSystemInfo),this._oSubTitle=new i(this.getId()+"-subTitle"),this._oSubTitle.cacheLineHeight=!1,this.addDependent(this._oSubTitle),this._sFailedToLoad=this._oRb.getText("INFOTILE_CANNOT_LOAD_TILE"),this._sLoading=this._oRb.getText("INFOTILE_LOADING"),this._oFailedText=new i(this.getId()+"-failed-txt",{maxLines:2}),this._oFailedText.cacheLineHeight=!1,this._oFailedText.addStyleClass("sapMGTFailed"),this.setAggregation("_failedMessageText",this._oFailedText,!0),this._oInvisibleText=new m(this.getId()+"-ariaText"),this.setAggregation("_invisibleText",this._oInvisibleText,!0),this._oErrorIcon=new s(this.getId()+"-warn-icon",{src:"sap-icon://error",size:"1.375rem"}),this._oErrorIcon.addStyleClass("sapMGTFtrFldIcnMrk");var e=_.get({name:"sapNegativeTextColor",callback:function(e){this._oErrorIcon.setColor(e)}.bind(this)});e&&this._oErrorIcon.setColor(e),this._oBusy=new o(this.getId()+"-overlay"),this._oBusy.setBusyIndicatorDelay(0),this._bTilePress=!0,this._sBGColor=M,this._bThemeApplied=!1,f.ready(this._handleCoreInitialized.bind(this)),this._oNavigateAction=new a(this.getId()+"-navigateAction"),this._oNavigateAction._bExcludeFromTabChain=!0,this.addDependent(this._oNavigateAction)},P.prototype.setWrappingType=function(e){return this.setProperty("wrappingType",e,!0),this._oTitle.setWrappingType(e),this._oFailedText.setWrappingType(e),this._oSubTitle.setWrappingType(e),this._oAppShortcut.setWrappingType(e),this._oSystemInfo.setWrappingType(e),this},P.prototype.setSubheader=function(e){return this.setProperty("subheader",e),this._oSubTitle.setText(e),this},P.prototype.setAppShortcut=function(e){return this.setProperty("appShortcut",e),this._oAppShortcut.setText(e),this},P.prototype.setSystemInfo=function(e){return this.setProperty("systemInfo",e),this._oSystemInfo.setText(e),this},P.prototype._handleCoreInitialized=function(){v.attachApplied(this._handleThemeApplied.bind(this))},P.prototype._handleThemeApplied=function(){this._bThemeApplied=!0,this._oTitle.clampHeight(),v.detachApplied(this._handleThemeApplied.bind(this))},P.prototype.onThemeChanged=function(){this.getDomRef()&&this.getRenderOnThemeChange()&&this.invalidate()},P.prototype._initScopeContent=function(e){if(!this.getState||this.getState()!==A.Disabled)switch(this._oMoreIcon&&(this._oMoreIcon.destroy(),this._oMoreIcon=null),this.isA("sap.m.GenericTile")&&this._isIconMode()&&this.getFrameType()===C.TwoByHalf?(this._oMoreIcon=this._oMoreIcon||new a({id:this.getId()+"-action-more",icon:"sap-icon://overflow",type:"Transparent",tooltip:this._oRb.getText("GENERICTILE_MORE_ACTIONBUTTON_TEXT")}).addStyleClass("sapMPointer").addStyleClass(e+"MoreIcon").addStyleClass(e+"ActionMoreButton"),this._oMoreIcon.ontouchstart=function(){this.removeFocus()}.bind(this)):(this._oMoreIcon=this._oMoreIcon||new a({id:this.getId()+"-action-more",icon:"sap-icon://overflow",type:"Unstyled"}).addStyleClass("sapMPointer").addStyleClass(e+"MoreIcon"),this._oMoreIcon._bExcludeFromTabChain=!0),this._oRemoveButton=this._oRemoveButton||new a({id:this.getId()+"-action-remove",icon:"sap-icon://decline",tooltip:this._oRb.getText("GENERICTILE_REMOVEBUTTON_TEXT")}).addStyleClass("sapUiSizeCompact").addStyleClass(e+"RemoveButton"),this._oRemoveButton._bExcludeFromTabChain=!0,this.getScope()){case I.Actions:this._oMoreIcon.setVisible(!0),this._oRemoveButton.setVisible(!0);break;case I.ActionMore:this._oMoreIcon.setVisible(!0),this._oRemoveButton.setVisible(!1);break;case I.ActionRemove:this._oRemoveButton.setVisible(!0),this._oMoreIcon.setVisible(!1)}},P.prototype._addClassesForButton=function(){this._oMoreIcon.getDomRef().classList.add("sapMBtn"),this._oMoreIcon.getDomRef("inner").classList.add("sapMBtnInner"),this._oMoreIcon.getDomRef("inner").classList.add("sapMBtnTransparent")},P.prototype.removeFocus=function(){this.getDomRef().classList.add("sapMGTActionButtonPress"),this._oMoreIcon._activeButton()},P.prototype._isSmall=function(){return this.getSizeBehavior()===L.Small||window.matchMedia("(max-width: 374px)").matches},P.prototype.exit=function(){this._sParentResizeListenerId&&(d.deregister(this._sResizeListenerId),this._sParentResizeListenerId=null),this._sGenericTileResizeListenerId&&(d.deregister(this._sGenericTileResizeListenerId),this._sGenericTileResizeListenerId=null),p.media.detachHandler(this._handleMediaChange,this,E),this._$RootNode&&(this._$RootNode.off(this._getAnimationEvents()),this._$RootNode=null),this._clearAnimationUpdateQueue(),this._oErrorIcon.destroy(),this._oImage&&this._oImage.destroy(),this._oBusy.destroy(),this._oMoreIcon&&this._oMoreIcon.destroy(),this._oRemoveButton&&this._oRemoveButton.destroy(),this._oNavigateAction&&this._oNavigateAction.destroy()},P.prototype.onBeforeRendering=function(){var e=!!this.getSubheader();this.getMode()===R.HeaderMode||this.getMode()===R.IconMode?this._applyHeaderMode(e):this._applyContentMode(e);for(var t=this.getTileContent().length,i=0;i<t;i++)this.getTileContent()[i].setDisabled(this.getState()===A.Disabled);this._initScopeContent("sapMGT"),this._generateFailedText(),this.$().off("mouseenter"),this.$().off("mouseleave"),this._sParentResizeListenerId&&(d.deregister(this._sResizeListenerId),this._sParentResizeListenerId=null),this._sGenericTileResizeListenerId&&(d.deregister(this._sGenericTileResizeListenerId),this._sGenericTileResizeListenerId=null);var o=this.getParent();if(o&&o.isA("sap.f.GridContainer")&&this._applyNewDim(),p.media.detachHandler(this._handleMediaChange,this,E),this._$RootNode&&this._$RootNode.off(this._getAnimationEvents()),this.getFrameType()===C.Auto&&this.setFrameType(C.OneByOne),this.getMode()!==R.LineMode&&(this.getAppShortcut()||this.getSystemInfo())&&this._setMaxLines(),this._isNavigateActionEnabled()){var s=this.getNavigationButtonText()?this.getNavigationButtonText():this._oRb.getText("ACTION_READ_MORE");this._oNavigateAction.setText(s),this._oNavigateAction.detachPress(this._navigateEventHandler,this)}this._isIconMode()&&this._validateBackgroundColor(),this._isLinkTileContentPresent=this.getLinkTileContents().length>0},P.prototype.onAfterRendering=function(){this._setupResizeClassHandler();var e=this.getMode(),i=this._isScreenLarge();if(this._sGenericTileResizeListenerId=d.register(this,this._handleResizeOnTile.bind(this)),this._handleResizeOnTile(),e===R.LineMode){var o=this.$().parent();i&&(this._updateHoverStyle(!0),this.getParent()instanceof t?this._sParentResizeListenerId=d.register(this.getParent(),this._handleResize.bind(this)):this._sParentResizeListenerId=d.register(o,this._handleResize.bind(this)))}e===R.LineMode&&this._bUpdateLineTileSiblings&&(this._updateLineTileSiblings(),this._bUpdateLineTileSiblings=!1),e===R.LineMode&&p.media.attachHandler(this._handleMediaChange,this,E),this._isNavigateActionEnabled()&&this._oNavigateAction.attachPress(this._navigateEventHandler,this),this._oMoreIcon&&this._oMoreIcon.getDomRef()&&!this._isIconMode()&&(this._oMoreIcon.getDomRef().firstChild.classList.remove("sapMBtnHoverable"),this._oMoreIcon.getDomRef().firstChild.classList.remove("sapMFocusable")),this._isIconMode()&&this.getFrameType()===C.TwoByHalf&&this._oMoreIcon.getDomRef()&&this._addClassesForButton(),this.getFrameType()!==C.TwoByOne||this.getMode()!==R.ActionMode&&!this._isLinkTileContentPresent||this.getState()!==A.Loaded||this.isA("sap.m.ActionTile")||this._applyExtraHeight(),this.getTooltip()&&this.getDomRef()&&this.getDomRef().setAttribute("aria-describedby",this.getAggregation("_invisibleText").getId()),this.onDragComplete(),this.getDomRef()&&this.getParent()&&this.getParent().isA("sap.m.SlideTile")&&this.getDomRef().setAttribute("tabindex","-1")},P.prototype._applyExtraHeight=function(){var e=this.getDomRef("hdr-text").offsetHeight,t=parseInt(getComputedStyle(this.getDomRef("title")).lineHeight.slice(0,2)),i=Math.ceil(e/t);1!==i||this.getHeaderImage()?this.getDomRef("content").classList.remove("sapMGTFtrMarginTop"):this.getDomRef("content").classList.add("sapMGTFtrMarginTop"),this._isLinkTileContentPresent&&this._adjustFocusOnLinkTiles(this.getDomRef().classList.contains("sapMTileSmallPhone"),i)},P.prototype._adjustFocusOnLinkTiles=function(e,t){var i,o=e?5:6;for(o=2===t?--o:o,i=this.getLinkTileContents().length-1;i>o-1;--i)this.getLinkTileContents()[i]._getLink().getDomRef().setAttribute("tabindex",-1);for(;i>=0;)this.getLinkTileContents()[i]._getLink().getDomRef().setAttribute("tabindex",0),i--},P.prototype._validateBackgroundColor=function(){var e=this.getBackgroundColor();if(S.isValid(e))this._sBGColor=e;else{var t=_.get({name:e,callback:function(e){this._sBGColor=e||M}.bind(this)});t&&(this._sBGColor=t)}},P.prototype._setMaxLines=function(){var e=this.getFrameType(),t=e===C.OneByOne||e===C.TwoByHalf?1:2;if(this._oAppShortcut.setMaxLines(t),this._oSystemInfo.setMaxLines(t),this.getFrameType()===C.TwoByHalf){var i=this.getAppShortcut().length>11,o=this.getSystemInfo().length>11;i&&o||i?this._oAppShortcut.setMaxLines(2):o&&this._oSystemInfo.setMaxLines(2)}},P.prototype.onDragComplete=function(){this.hasStyleClass("sapMGTPressActive")&&(this.removeStyleClass("sapMGTPressActive"),this.$("hover-overlay").length>0&&this.$("hover-overlay").removeClass("sapMGTPressActive"),this.getMode()===R.LineMode&&this.removeStyleClass("sapMGTLineModePress")),this.getDomRef()&&(this.getDomRef().removeEventListener("mouseenter",this._updateAriaAndTitle.bind(this)),this.getDomRef().removeEventListener("mouseleave",this._removeTooltipFromControl.bind(this)),this.getDomRef().addEventListener("mouseenter",this._updateAriaAndTitle.bind(this)),this.getDomRef().addEventListener("mouseleave",this._removeTooltipFromControl.bind(this)))},P.prototype._handleResize=function(){this.getMode()===R.LineMode&&this._isScreenLarge()&&this.getParent()&&this._queueAnimationEnd()},P.prototype._handleResizeOnTile=function(){this._isIconMode()&&this.getFrameType()===C.OneByOne&&this._handleResizeOnIconTile()},P.prototype._handleResizeOnIconTile=function(){var e=this._oTitle.getDomRef(),t=window.matchMedia("(max-width: 600px)").matches,i=window.matchMedia("(max-width: 374px)").matches;if(e){var o=parseInt(getComputedStyle(e).height.slice(0,2))/parseInt(getComputedStyle(e).lineHeight.slice(0,2));1===o?this.addStyleClass("sapMGTHeaderOneLine"):this.removeStyleClass("sapMGTHeaderOneLine"),t||i||3!==o||!this._oSubTitle.getDomRef()?(this.removeStyleClass("sapMGTHeaderThreeLine"),this._oSubTitle.setMaxLines(2)):(this._oSubTitle.setMaxLines(1),this.addStyleClass("sapMGTHeaderThreeLine"))}},P.prototype._setupResizeClassHandler=function(){var e=function(){var e=this.getParent();e&&e.isA("sap.f.GridContainer")&&this._applyNewDim(),this.getSizeBehavior()===L.Small||window.matchMedia("(max-width: 374px)").matches||this._isSmallStretchTile()?(this.$().addClass("sapMTileSmallPhone"),this._isSmallStretchTile()&&this.addStyleClass("sapMGTStretch")):(this.$().removeClass("sapMTileSmallPhone"),this.removeStyleClass("sapMGTStretch")),this.__isLinkTileContentPresent&&this._applyExtraHeight()}.bind(this);jQuery(window).on("resize",e),e()},P.prototype._isSmallStretchTile=function(){return this.getFrameType()===C.Stretch&&window.matchMedia("(max-width: 600px)").matches},P.prototype._isCompact=function(){return jQuery("body").hasClass("sapUiSizeCompact")||this.$().is(".sapUiSizeCompact")||this.$().closest(".sapUiSizeCompact").length>0},P.prototype._calculateStyleData=function(){if(this.$("lineBreak").remove(),!this._isScreenLarge()||!this.getDomRef()||this.$().is(":hidden"))return null;var e=this.$(),t=this.$("endMarker"),i=this.$("startMarker");if(0===t.length||0===i.length)return null;var o,s,n,a=this._getLineCount(),r=Math.ceil(l._getCSSPixelValue(this,"margin-top")),h=this.$().parent().innerWidth(),d=Math.ceil(l._getCSSPixelValue(this,"min-height")),c=l._getCSSPixelValue(this,"line-height"),g=this.$().is(":not(:first-child)")&&a>1,u=jQuery("<span><br></span>"),_=0,T=y.getRTL(),m=t.position();g&&(u.attr("id",this.getId()+"-lineBreak"),e.prepend(u),a=this._getLineCount(),m=t.position());var f,v={rtl:T,lineBreak:g,startOffset:i.offset(),endOffset:t.offset(),availableWidth:h,lines:[]},M=f=p.browser.msie||p.browser.edge?u.find("br").position():u.position();for(!(p.browser.mozilla||p.browser.msie||p.browser.edge)&&f.left<m.left&&(M=m),v.positionLeft=g?f.left:e.position().left,v.positionRight=g?e.width()-M.left:v.availableWidth-e.position().left,!g&&a>1&&(v.positionRight=i.parent().innerWidth()-(i.position().left+i.width()));_<a;_++)g&&0===_||(1===a?(o=T?v.availableWidth-v.positionLeft:v.positionLeft,n=e.width()):_===a-1?(o=0,n=T?e.width()-m.left:m.left):(o=0,n=h),s=_*c+r,v.lines.push({offset:{x:o,y:s},width:n,height:d}));return v},P.prototype._getStyleData=function(){var e=this._calculateStyleData();return!g(this._oStyleData,e)&&(delete this._oStyleData,this._oStyleData=e,!0)},P.prototype._getAnimationEvents=function(){return"transitionend.sapMGT$id animationend.sapMGT$id".replace(/\$id/g,c(this.getId()))},P.prototype._updateHoverStyle=function(e){(this._getStyleData()||e)&&(this._clearAnimationUpdateQueue(),this._cHoverStyleUpdates=-1,this._oAnimationEndCallIds={},this._oStyleData&&this._oStyleData.lineBreak&&this.getUIArea()&&(this._$RootNode=jQuery(this.getUIArea().getRootNode()),this._$RootNode.on(this._getAnimationEvents(),this._queueAnimationEnd.bind(this))),this._queueAnimationEnd())},P.prototype._queueAnimationEnd=function(e){if(e&&jQuery(e.target).is(".sapMGT, .sapMGT *"))return!1;"number"!=typeof this._cHoverStyleUpdates&&(this._cHoverStyleUpdates=-1),this._oAnimationEndCallIds||(this._oAnimationEndCallIds={}),this._cHoverStyleUpdates++,this._oAnimationEndCallIds[this._cHoverStyleUpdates]=setTimeout(this._handleAnimationEnd.bind(this,this._cHoverStyleUpdates),10)},P.prototype._handleAnimationEnd=function(e){delete this._oAnimationEndCallIds[e],this._cHoverStyleUpdates===e&&(this._getStyleData(),l._updateHoverStyle.call(this))},P.prototype._clearAnimationUpdateQueue=function(){for(var e in this._oAnimationEndCallIds)clearTimeout(this._oAnimationEndCallIds[e]),delete this._oAnimationEndCallIds[e]},P.prototype._getLineCount=function(){var e=this.getDomRef().getBoundingClientRect(),t=l._getCSSPixelValue(this,"line-height");return Math.round(e.height/t)},P.prototype.getBoundingRects=function(){var e=this.$().offset();return[{offset:{x:e.left,y:e.top},width:this.$().outerWidth(),height:this.$().height()}]},P.prototype._updateLineTileSiblings=function(){var e=this.getParent();if(this.getMode()===R.LineMode&&this._isScreenLarge()&&e){var t=e.indexOfAggregation(this.sParentAggregationName,this),i=e.getAggregation(this.sParentAggregationName).splice(t+1);for(t=0;t<i.length;t++){var o=i[t];o instanceof P&&o.getMode()===R.LineMode&&o._updateHoverStyle()}}},P.prototype.ontouchstart=function(e){e&&-1===e.target.id.indexOf("-action-more")&&this.getDomRef()&&this.getDomRef().classList.remove("sapMGTActionButtonPress"),this.addStyleClass("sapMGTPressActive"),this.$("hover-overlay").length>0&&this.$("hover-overlay").addClass("sapMGTPressActive"),this.getMode()===R.LineMode&&this.addStyleClass("sapMGTLineModePress")},P.prototype.ontouchcancel=function(){this.removeStyleClass("sapMGTPressActive"),this.$("hover-overlay").length>0&&this.$("hover-overlay").removeClass("sapMGTPressActive")},P.prototype.ontouchend=function(){this.removeStyleClass("sapMGTPressActive"),this.$("hover-overlay").length>0&&this.$("hover-overlay").removeClass("sapMGTPressActive"),this.getMode()===R.LineMode&&this.removeStyleClass("sapMGTLineModePress")},P.prototype.ondragend=function(){this.onDragComplete()},P.prototype.ontap=function(e){var t;w(e,this)||this._isLinkPressed(e)||(this._bTilePress||this._isActionMoreButtonVisibleIconMode(e))&&this.getState()!==A.Disabled&&(this.$().trigger("focus"),t=this._getEventParams(e),this.isInActionRemoveScope()&&t.action===P._Action.Press||this.firePress(t),e.preventDefault())};var G=!1;function w(e,t){var i=!1,o=!1;if(t._isActionMode()){var s=document.querySelector('[id="'+t.getId()+'-actionButtons"]');i=s&&s!==e.target&&s.contains(e.target)}if(t._isNavigateActionEnabled()){var n=document.querySelector('[id="'+t.getId()+'-navigateActionContainer"]');o=n&&n!==e.target&&n.contains(e.target)}return i||o}return P.prototype.onkeydown=function(e){w(e,this)||this._isLinkPressed(e)||(G=16===e.keyCode||27===e.keyCode,D[e.keyCode]||(D[e.keyCode]=!0,(D[32]||D[13])&&e.preventDefault()),u.events.sapselect.fnCheck(e)&&this.getState()!==A.Disabled&&(this.addStyleClass("sapMGTPressActive"),this.$("hover-overlay").length>0&&this.$("hover-overlay").addClass("sapMGTPressActive"),e.preventDefault()))},P.prototype._updateAriaLabel=function(){var e=this._getAriaText(),t=this.$(),i=!1;return t.attr("aria-label")!==e&&(t.attr("aria-label",e),i=!0),i},P.prototype.onsaptabnext=function(e){this._isIconMode()&&this.getFrameType()===C.TwoByHalf&&e&&e.keyCode&&(9===e.keyCode&&e.srcControl.getId()==this._oMoreIcon.getId()?this._oMoreIcon.removeStyleClass("sapMGTVisible"):9===e.keyCode&&this._oMoreIcon.addStyleClass("sapMGTVisible"))},P.prototype.onsaptabprevious=function(){this._isIconMode()&&this.getFrameType()===C.TwoByHalf&&this._oMoreIcon.removeStyleClass("sapMGTVisible")},P.prototype.onkeyup=function(e){if(!w(e,this)&&!this._isLinkPressed(e)){D[e.keyCode]&&delete D[e.keyCode];var t,i=!1,o=this.getScope();(o===I.Actions||o===I.ActionRemove)&&(u.events.sapdelete.fnCheck(e)||u.events.sapbackspace.fnCheck(e))&&(t={scope:o,action:P._Action.Remove,domRef:this._oRemoveButton.getPopupAnchorDomRef()},i=!0),D[16]&&16!==e.keyCode&&(this.getState(),A.Disabled),(u.events.sapselect.fnCheck(e)||G)&&this.getState()!==A.Disabled&&(this.removeStyleClass("sapMGTPressActive"),this.$("hover-overlay").length>0&&this.$("hover-overlay").removeClass("sapMGTPressActive"),t=this._getEventParams(e),i=!0),!G&&i&&(this._bTilePress||this._isActionMoreButtonVisibleIconMode(e))&&(this.firePress(t),e.preventDefault()),this._updateAriaLabel()}},P.prototype.setProperty=function(e){return t.prototype.setProperty.apply(this,arguments),this.getMode()===R.LineMode&&-1!==P.LINEMODE_SIBLING_PROPERTIES.indexOf(e)&&(this._bUpdateLineTileSiblings=!0),this},P.prototype.getHeader=function(){return this._oTitle.getText()},P.prototype.setHeader=function(e){return this.setProperty("header",e),this._oTitle.setText(e),this},P.prototype.setHeaderImage=function(e){return!g(this.getHeaderImage(),e)&&(this._oImage&&(this._oImage.destroy(),this._oImage=void 0),e&&(this._oImage=n.createControlByURI({id:this.getId()+"-icon-image",src:e},h),this._oImage.addStyleClass("sapMGTHdrIconImage"))),this.setProperty("headerImage",e)},P.prototype._applyHeaderMode=function(e){var t,i,o=this.getFrameType();this._isIconMode()?(i=o===C.TwoByHalf?1:2,o===C.OneByOne?t=4:o===C.TwoByHalf&&(t=e?1:2),this._oTitle.setMaxLines(t),this._oSubTitle.setMaxLines(i)):o===C.TwoByOne&&(this.getLinkTileContents()>0||this.getMode()===R.ActionMode)||o===C.OneByHalf||o===C.TwoByHalf?this._oTitle.setMaxLines(2):e?this._oTitle.setMaxLines(4):this._oTitle.setMaxLines(5);this._changeTileContentContentVisibility(!1)},P.prototype._applyContentMode=function(e){var t=this.getFrameType(),i=this.getTileContent(),o=!1;if(t===C.TwoByHalf||t===C.OneByHalf)if(i.length)for(var s=0;s<i.length;s++){var n=i[s].getAggregation("content");if(null!==n){if(t===C.OneByHalf&&"sap.m.ImageContent"===n.getMetadata().getName()){o=!0,this._oTitle.setMaxLines(2);break}this._oTitle.setMaxLines(1);break}this._oTitle.setMaxLines(2)}else this._oTitle.setMaxLines(2);else t===C.TwoByOne&&(this.getLinkTileContents().length>0||this.getMode()===R.ActionMode)?e?this._oTitle.setMaxLines(1):this._oTitle.setMaxLines(2):e?this._oTitle.setMaxLines(2):this._oTitle.setMaxLines(3);this._changeTileContentContentVisibility(!0,t,o)},P.prototype._changeTileContentContentVisibility=function(e,t,i){var o;o=this.getTileContent();for(var s=0;s<o.length;s++)t==C.OneByHalf&&i?o[s].setRenderContent(!1):o[s].setRenderContent(e)},P.prototype._getHeaderAriaAndTooltipText=function(){var e="",t=!0;return this.getHeader()&&(e+=this.getHeader(),t=!1),this.getSubheader()&&(e+=(t?"":"\n")+this.getSubheader(),t=!1),this.getImageDescription()&&(e+=(t?"":"\n")+this.getImageDescription()),e},P.prototype._getContentAriaAndTooltipText=function(){var e="",t=!0,i=this.getTileContent(),o=this.getAdditionalTooltip();if(!this._isInActionScope()&&(this.getMode()===R.ContentMode||this.getMode()===R.ArticleMode||this.getMode()===R.ActionMode))for(var s=0;s<i.length;s++)i[s].getVisible()&&("function"==typeof i[s]._getAriaAndTooltipText?e+=(t?"":"\n")+i[s]._getAriaAndTooltipText():i[s].getTooltip_AsString()&&(e+=(t?"":"\n")+i[s].getTooltip_AsString()),t=!1);return o&&(e+=(t?"":"\n")+o),e},P.prototype._getAriaAndTooltipText=function(){var e=this._getHeaderAriaAndTooltipText()+"\n"+this._getContentAriaAndTooltipText();switch(this.getState()){case A.Disabled:return"";case A.Loading:return e+"\n"+this._sLoading;case A.Failed:return e+"\n"+this._oFailedText.getText();default:return 0===e.trim().length?"":e}},P.prototype._getAriaText=function(e){var t=this._getAriaAndTooltipText(),i=this.getAriaLabel();return t&&!this._isTooltipSuppressed()||(t=this._getAriaAndTooltipText()),this._isInActionScope()&&this.getScope()!==I.ActionMore&&(t=this._oRb.getText("GENERICTILE_ACTIONS_ARIA_TEXT")+" "+t),i&&(t=i+" "+t),e||(t=t.trim(),this.getLinkTileContents().length>0?t+="\n"+this._oRb.getText("GENERICTILE_LINK_TILE_CONTENT_DESCRIPTION"):t+="\n"+this._getSizeDescription()),t.trim()},P.prototype._getSizeDescription=function(){var e="",t=this.getFrameType();if(this.getMode()===R.LineMode){var i=this.getUrl()&&!this._isInActionScope()&&this.getState()!==A.Disabled,o=this.hasListeners("press");e=i||o?"GENERIC_TILE_LINK":"GENERIC_TILE_LINE_SIZE"}else t===C.OneByHalf?e="GENERIC_TILE_FLAT_SIZE":t===C.TwoByHalf?e="GENERIC_TILE_FLAT_WIDE_SIZE":t===C.TwoByOne?e="GENERIC_TILE_WIDE_SIZE":(t===C.OneByOne||t===C.Stretch||t===C.TwoThirds)&&(e="GENERIC_TILE_ROLE_DESCRIPTION");return this._oRb.getText(e)},P.prototype._getTooltipText=function(){var e=this.getTooltip_Text();return!0===this._isTooltipSuppressed()&&(e=null),e},P.prototype._checkFooter=function(e,t){var i=t.getState(),o=this._isInActionScope()||!0===this._bShowActionsView,s=this.getFrameType(),n=e.getAggregation("content");if(this._isIconMode())e.setRenderFooter(!1);else if(i===A.Failed||o&&i!==A.Disabled)e.setRenderFooter(!1);else if(s!==C.TwoByHalf||null===n&&!this.getSubheader()){if(s!==C.OneByHalf||!(null!==n&&"sap.m.ImageContent"!==n.getMetadata().getName()||this.getSubheader()))return e.setRenderFooter(!0),!0;e.setRenderFooter(!1)}else e.setRenderFooter(!1)},P.prototype._isInActionScope=function(){return this.getScope()===I.Actions||this.getScope()===I.ActionMore||this.getScope()===I.ActionRemove},P.prototype._isLinkPressed=function(e){var t=e.target.id;return!!this.getLinkTileContents().find((function(e){return e._getLink().getDomRef().id===t}))},P.prototype.isInActionRemoveScope=function(){return this.getScope()===I.ActionRemove},P.prototype._isActionMoreButtonVisibleIconMode=function(e){return(this.getScope()===I.ActionMore||this.getScope()===I.Actions)&&this._isIconMode()&&this.getFrameType()===C.TwoByHalf&&e.target.id.indexOf("-action-more")>-1},P.prototype._generateFailedText=function(){var e=this.getFailedText(),t=e||this._sFailedToLoad;this._oFailedText.setText(t),this._oFailedText.setTooltip(t)},P.prototype._isTooltipSuppressed=function(){var e=this.getTooltip_Text();return!!(e&&e.length>0&&0===e.trim().length)},P.prototype._isHeaderTextTruncated=function(){var e,t,i;return this.getMode()===R.LineMode?(t=this.$("hdr-text")).length>0&&(i=Math.ceil(t[0].getBoundingClientRect().width),t[0]&&i<t[0].scrollWidth):(e=this.getAggregation("_titleText").getDomRef("inner"),this.getAggregation("_titleText").getClampHeight(e)<e.scrollHeight)},P.prototype._isSubheaderTextTruncated=function(){var e;if((e=this.getMode()===R.LineMode?this.$("subHdr-text"):this.$("subTitle")).length>0){var t=Math.ceil(e[0].getBoundingClientRect().width);return e[0]&&t<e[0].scrollWidth}return!1},P.prototype._setTooltipFromControl=function(){var e=this._getAriaAndTooltipText();!e||this._getTooltipText()||this._isTooltipSuppressed()||(this.$().attr("title",e.trim()),this._bTooltipFromControl=!0)},P.prototype._updateAriaAndTitle=function(){var e=this._getAriaAndTooltipText(),t=this._getAriaText(),i=this.$();i.attr("title")!==e&&i.attr("aria-label",t),this._isInActionScope()?i.find("*:not(.sapMGTRemoveButton,.sapMGTActionMoreButton)").removeAttr("aria-label").removeAttr("title").off("mouseenter"):i.find("*").removeAttr("aria-label").removeAttr("title").off("mouseenter"),this._setTooltipFromControl()},P.prototype._removeTooltipFromControl=function(){this._bTooltipFromControl&&(this.$().removeAttr("title"),this._bTooltipFromControl=!1)},P.prototype._isScreenLarge=function(){return"large"===this._getCurrentMediaContainerRange(E).name},P.prototype._getEventParams=function(e){var t=P._Action.Press,i=this.getScope(),o=this.getDomRef();return(i===I.Actions||I.ActionRemove)&&e.target.id.indexOf("-action-remove")>-1?(t=P._Action.Remove,o=this._oRemoveButton.getPopupAnchorDomRef()):(i===I.Actions||i===I.ActionMore)&&this._isIconMode&&this._isIconMode()&&e.target.id.indexOf("-action-more")>-1?(t=P._Action.More,o=this._oMoreIcon.getDomRef()):i!==I.Actions&&i!==I.ActionMore||(o=this._oMoreIcon.getDomRef()),{scope:i,action:t,domRef:o}},P.prototype._handleMediaChange=function(){this._bUpdateLineTileSiblings=!0,this.invalidate()},P.prototype.setPressEnabled=function(e){return this._bTilePress=e,this.setProperty("pressEnabled",e),this},P.prototype.showActionsView=function(e){this._bShowActionsView!==e&&(this._bShowActionsView=e,this.invalidate())},P.prototype._generateIconAggregation=function(e){var t="";return this._oIcon=n.createControlByURI({size:this.getFrameType()===C.OneByOne?"2rem":"1.25rem",useIconTooltip:!1,src:e}),this._oIcon||(this._oIcon=n.createControlByURI({height:this.getFrameType()===C.OneByOne?"2rem":"1.25rem",width:this.getFrameType()===C.OneByOne?"2rem":"1.25rem",useIconTooltip:!1,src:e},h).addStyleClass("sapMPointer").addStyleClass("sapMGTTileIcon")),this._oIcon.addStyleClass("sapMPointer").addStyleClass("sapMGTTileIcon"),this._oIcon instanceof h?t="_tileIconImage":this._oIcon instanceof s&&(t="_tileIcon"),t&&this.setAggregation(t,this._oIcon),t},P.prototype._isIconMode=function(){var e=this.getMode(),t=this.getFrameType(),i=this.getTileIcon(),o=this.getBackgroundColor(),s=this.getIconLoaded();return this._sTileBadge=t===C.TwoByHalf&&this.getTileBadge().trim().substring(0,3),e===R.IconMode&&(t===C.OneByOne||t===C.TwoByHalf)&&(i&&o||this._sTileBadge&&o||!s)},P.prototype._isNavigateActionEnabled=function(){return this.getMode()===R.ArticleMode&&this.getUrl()&&this.getEnableNavigationButton()},P.prototype._applyNewDim=function(e){var t=e?e.getActiveLayoutSettings().getGap():this.getParent().getActiveLayoutSettings().getGap(),i="16px"===t||"1rem"===t;i?this.addStyleClass("sapMGTGridContainerOneRemGap"):!i&&this.hasStyleClass("sapMGTGridContainerOneRemGap")&&this.removeStyleClass("sapMGTGridContainerOneRemGap")},P.prototype._isActionMode=function(){return this.getFrameType()===C.TwoByOne&&this.getMode()===R.ActionMode&&this.getActionButtons().length},P.prototype._getNavigateAction=function(){return this._oNavigateAction},P.prototype._navigateEventHandler=function(e){e.preventDefault();var t=e.getSource().getParent().getUrl();B.redirect(t,!0)},P.prototype.getDropAreaRect=function(e){var t=this.getDomRef().getBoundingClientRect().toJSON(),i=this.getDropAreaOffset();return"Horizontal"===e?(t.left-=i,t.right+=i):(t.top-=i,t.bottom+=i),t},P}));