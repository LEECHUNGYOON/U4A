sap.ui.define(["sap/ui/core/Element","./Dialog","./Popover","./SelectList","./library","sap/ui/core/Control","sap/ui/core/EnabledPropagator","sap/ui/core/LabelEnablement","sap/ui/core/Icon","sap/ui/core/IconPool","./Button","./Bar","./Title","./delegate/ValueStateMessage","sap/ui/core/message/MessageMixin","sap/ui/core/library","sap/ui/core/Item","sap/ui/Device","sap/ui/core/InvisibleText","./SelectRenderer","sap/ui/dom/containsOrEquals","sap/ui/events/KeyCodes","./Text","sap/m/SimpleFixFlex","sap/base/Log","sap/ui/core/ValueStateSupport","sap/ui/core/InvisibleMessage","sap/ui/core/Lib"],(function(e,t,i,s,o,n,r,a,l,c,p,u,h,g,d,y,f,S,m,I,v,_,b,C,T,x,A,V){"use strict";var P=o.SelectListKeyboardNavigationMode,L=o.PlacementType,k=y.ValueState,R=y.TextDirection,O=y.TextAlign,E=y.OpenState,F=o.SelectType,D=y.InvisibleMessageMode,M=y.TitleLevel,B=n.extend("sap.m.Select",{metadata:{interfaces:["sap.ui.core.IFormContent","sap.m.IOverflowToolbarContent","sap.m.IToolbarInteractiveControl","sap.f.IShellBar","sap.ui.core.ISemanticFormContent","sap.ui.core.ILabelable"],library:"sap.m",properties:{name:{type:"string",group:"Misc",defaultValue:""},enabled:{type:"boolean",group:"Behavior",defaultValue:!0},editable:{type:"boolean",group:"Behavior",defaultValue:!0},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"auto"},maxWidth:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"100%"},selectedKey:{type:"string",group:"Data",defaultValue:""},selectedItemId:{type:"string",group:"Misc",defaultValue:""},icon:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:""},type:{type:"sap.m.SelectType",group:"Appearance",defaultValue:F.Default},autoAdjustWidth:{type:"boolean",group:"Appearance",defaultValue:!1},textAlign:{type:"sap.ui.core.TextAlign",group:"Appearance",defaultValue:O.Initial},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:R.Inherit},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:k.None},valueStateText:{type:"string",group:"Misc",defaultValue:""},showSecondaryValues:{type:"boolean",group:"Misc",defaultValue:!1},resetOnMissingKey:{type:"boolean",group:"Behavior",defaultValue:!1},forceSelection:{type:"boolean",group:"Behavior",defaultValue:!0},wrapItemsText:{type:"boolean",group:"Behavior",defaultValue:!1},columnRatio:{type:"sap.m.SelectColumnRatio",group:"Appearance",defaultValue:"3:2"},required:{type:"boolean",group:"Misc",defaultValue:!1}},defaultAggregation:"items",aggregations:{items:{type:"sap.ui.core.Item",multiple:!0,singularName:"item",bindable:"bindable",forwarding:{getter:"getList",aggregation:"items"}},picker:{type:"sap.ui.core.PopupInterface",multiple:!1,visibility:"hidden"},_valueIcon:{type:"sap.ui.core.Icon",multiple:!1,visibility:"hidden"},_pickerHeader:{type:"sap.m.Bar",multiple:!1,visibility:"hidden"},_pickerValueStateContent:{type:"sap.m.Text",multiple:!1,visibility:"hidden"}},associations:{selectedItem:{type:"sap.ui.core.Item",multiple:!1},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:!0,singularName:"ariaLabelledBy"}},events:{change:{parameters:{selectedItem:{type:"sap.ui.core.Item"},previousSelectedItem:{type:"sap.ui.core.Item"}}},liveChange:{parameters:{selectedItem:{type:"sap.ui.core.Item"}}}},designtime:"sap/m/designtime/Select.designtime"},renderer:I});function w(e){this._isIconOnly()&&!this.isOpen()||e&&(this.getSelectedItemId()!==e.getId()&&this.fireEvent("liveChange",{selectedItem:e}),this.setSelection(e),this.setValue(e.getText()),this.scrollToItem(e))}return c.insertFontFaceStyle(),r.apply(B.prototype,[!0]),d.call(B.prototype),B.prototype._attachHiddenSelectHandlers=function(){var e=this._getHiddenSelect(),t=this._getHiddenInput();e.on("focus",this._addFocusClass.bind(this)),e.on("blur",this._removeFocusClass.bind(this)),t.on("focus",this.focus.bind(this))},B.prototype.focus=function(){this._getHiddenSelect().trigger("focus"),n.prototype.focus.call(this,arguments)},B.prototype._addFocusClass=function(){this.$().addClass("sapMSltFocused")},B.prototype._removeFocusClass=function(){this.$().removeClass("sapMSltFocused")},B.prototype._detachHiddenSelectHandlers=function(){var e=this._getHiddenSelect(),t=this._getHiddenInput();e&&(e.off("focus"),e.off("blur")),t&&t.off("focus")},B.prototype._getHiddenSelect=function(){return this.$("hiddenSelect")},B.prototype._getHiddenInput=function(){return this.$("hiddenInput")},B.prototype._announceValueStateText=function(){var e=this._getValueStateText();this._oInvisibleMessage&&this._oInvisibleMessage.announce(e,D.Polite)},B.prototype._getValueStateText=function(){var e=this.getValueState();return e===k.None?"":V.getResourceBundleFor("sap.m").getText("INPUTBASE_VALUE_STATE_"+e.toUpperCase())+" "+(this.getValueStateText()||x.getAdditionalText(this))},B.prototype._isFocused=function(){return this.getFocusDomRef()===document.activeElement},B.prototype._isIconOnly=function(){return this.getType()===F.IconOnly},B.prototype._handleFocusout=function(e){this._bFocusoutDueRendering=this.bRenderingPhase,this._bFocusoutDueRendering?this._bProcessChange=!1:this._bProcessChange?(this.isOpen()&&e.target!==this.getAggregation("picker")?this._revertSelection():this._checkSelectionChange(),this._bProcessChange=!1):this._bProcessChange=!0},B.prototype._checkSelectionChange=function(){var e=this.getSelectedItem();this._oSelectionOnFocus!==e&&this.fireChange({selectedItem:e,previousSelectedItem:this._oSelectionOnFocus})},B.prototype._revertSelection=function(){var e=this.getSelectedItem();this._oSelectionOnFocus!==e&&(this.fireEvent("liveChange",{selectedItem:this._oSelectionOnFocus}),this.setSelection(this._oSelectionOnFocus),this.setValue(this._getSelectedItemText()))},B.prototype._getSelectedItemText=function(e){return(e=e||this.getSelectedItem())||(e=this.getDefaultSelectedItem()),e?e.getText():""},B.prototype.getOverflowToolbarConfig=function(){var e=["enabled","selectedKey"];this.getAutoAdjustWidth()&&!this._bIsInOverflow||e.push("selectedItemId");var t={canOverflow:!0,autoCloseEvents:["change"],invalidationEvents:["_itemTextChange"],propsUnrelatedToSize:e,onBeforeEnterOverflow:function(e){e.getParent().isA("sap.m.OverflowToolbar")&&(e._prevSelectType=e.getType(),e._bIsInOverflow=!0,e.getType()!==F.Default&&e.setProperty("type",F.Default,!0))},onAfterExitOverflow:function(e){e.getParent().isA("sap.m.OverflowToolbar")&&(e._bIsInOverflow=!1,e.getType()!==e._prevSelectType&&e.setProperty("type",e._prevSelectType,!0))}};return t},B.prototype.getList=function(){return this._bIsBeingDestroyed?null:this._oList},B.prototype.findFirstEnabledItem=function(e){var t=this.getList();return t?t.findFirstEnabledItem(e):null},B.prototype.findLastEnabledItem=function(e){var t=this.getList();return t?t.findLastEnabledItem(e):null},B.prototype.setSelectedIndex=function(e,t){var i;(i=(t=t||this.getItems())[e=e>t.length-1?t.length-1:Math.max(0,e)])&&this.setSelection(i)},B.prototype.scrollToItem=function(e){var t=this.getPicker().getDomRef(),i=e&&e.getDomRef();if(t&&i){var s=t.querySelector(".sapUiSimpleFixFlexFlexContent"),o=t.querySelector(".sapMSltPickerValueState"),n=o?o.clientHeight:0,r=s.scrollTop,a=i.offsetTop-n,l=s.clientHeight,c=i.offsetHeight;r>a?s.scrollTop=a:a+c>r+l&&(s.scrollTop=Math.ceil(a+c-l))}},B.prototype.setValue=function(e){var t=this.getDomRef(),i=t&&t.querySelector(".sapMSelectListItemText"),s=!this.isOpen()&&this._isFocused()&&this._oInvisibleMessage;i&&(i.textContent=e),this._setHiddenSelectValue(),this._getValueIcon(),s&&this._oInvisibleMessage.announce(e,D.Assertive)},B.prototype._setHiddenSelectValue=function(){var e=this._getHiddenSelect(),t=this._getHiddenInput(),i=this.getSelectedKey(),s=this._getSelectedItemText();t.attr("value",i||""),this._isIconOnly()||e.text(s)},B.prototype._getValueIcon=function(){if(this._bIsBeingDestroyed)return null;var e=this.getAggregation("_valueIcon"),t=this.getSelectedItem(),i=!!(t&&t.getIcon&&t.getIcon()),s=i?t.getIcon():"sap-icon://pull-down";return e||(e=new l(this.getId()+"-labelIcon",{src:s,visible:!1}),this.setAggregation("_valueIcon",e,!0)),e.getVisible()!==i&&(e.setVisible(i),e.toggleStyleClass("sapMSelectListItemIcon",i)),i&&t.getIcon()!==e.getSrc()&&e.setSrc(s),e},B.prototype._isShadowListRequired=function(){return!this.getAutoAdjustWidth()&&"auto"===this.getWidth()},B.prototype._handleAriaActiveDescendant=function(e){var t=this.getFocusDomRef(),i=e&&e.getDomRef(),s="aria-activedescendant";t&&(i&&this.isOpen()?t.setAttribute(s,e.getId()):t.removeAttribute(s))},B.prototype.updateItems=function(e){s.prototype.updateItems.apply(this,arguments),this._oSelectionOnFocus=this.getSelectedItem()},B.prototype.refreshItems=function(){s.prototype.refreshItems.apply(this,arguments)},B.prototype.onBeforeOpen=function(e){var t=this["_onBeforeOpen"+this.getPickerType()],i=this.getRenderer().CSS_CLASS;this.addStyleClass(i+"Pressed"),this.addStyleClass(i+"Expanded"),this.closeValueStateMessage(),this.addContent(),this.addContentToFlex(),t&&t.call(this)},B.prototype.onAfterOpen=function(e){var t=this.getFocusDomRef(),i=null;t&&(i=this.getSelectedItem(),t.setAttribute("aria-expanded","true"),t.setAttribute("aria-controls",this.getList().getId()),i&&(t.setAttribute("aria-activedescendant",i.getId()),this.scrollToItem(i)))},B.prototype.onBeforeClose=function(e){var t=this.getFocusDomRef(),i=this.getRenderer().CSS_CLASS;t&&(t.removeAttribute("aria-controls"),t.removeAttribute("aria-activedescendant"),this.shouldValueStateMessageBeOpened()&&document.activeElement===t&&this.openValueStateMessage()),this.removeStyleClass(i+"Expanded")},B.prototype.onAfterClose=function(e){var t=this.getFocusDomRef(),i=this.getRenderer().CSS_CLASS+"Pressed";t&&(t.setAttribute("aria-expanded","false"),t.removeAttribute("aria-activedescendant")),this.removeStyleClass(i)},B.prototype.getPicker=function(){return this._bIsBeingDestroyed?null:this.createPicker(this.getPickerType())},B.prototype.getValueStateTextInvisibleText=function(){return this._bIsBeingDestroyed?null:(this._oValueStateTextInvisibleText||(this._oValueStateTextInvisibleText=new m({id:this.getId()+"-valueStateText-InvisibleText"}),this._oValueStateTextInvisibleText.toStatic()),this._oValueStateTextInvisibleText)},B.prototype.getSimpleFixFlex=function(){return this._bIsBeingDestroyed?null:(this.oSimpleFixFlex||(this.oSimpleFixFlex=new C({id:this.getPickerValueStateContentId(),fixContent:this._getPickerValueStateContent().addStyleClass(this.getRenderer().CSS_CLASS+"PickerValueState"),flexContent:this.createList()})),this.oSimpleFixFlex)},B.prototype.setPickerType=function(e){this._sPickerType=e},B.prototype.getPickerType=function(){return this._sPickerType},B.prototype._getPickerValueStateContent=function(){return this.getAggregation("_pickerValueStateContent")||this.setAggregation("_pickerValueStateContent",new b({wrapping:!0,text:this._getTextForPickerValueStateContent()})),this.getAggregation("_pickerValueStateContent")},B.prototype._updatePickerValueStateContentText=function(){var e,t=this.getPicker(),i=t&&t.getContent()[0].getFixContent();i&&(e=this._getTextForPickerValueStateContent(),i.setText(e))},B.prototype._getTextForPickerValueStateContent=function(){var e=this.getValueStateText();return e||this._getDefaultTextForPickerValueStateContent()},B.prototype._getDefaultTextForPickerValueStateContent=function(){var e=this.getValueState();return e===k.None?"":V.getResourceBundleFor("sap.ui.core").getText("VALUE_STATE_"+e.toUpperCase())},B.prototype._updatePickerValueStateContentStyles=function(){var e=this.getValueState(),t=k,i=this.getRenderer().CSS_CLASS+"Picker",s=i+e+"State",o=i+"WithSubHeader",n=this.getPicker(),r=n&&n.getContent()[0].getFixContent();r&&(this._removeValueStateClassesForPickerValueStateContent(n),r.addStyleClass(s),e!==t.None?n.addStyleClass(o):n.removeStyleClass(o))},B.prototype._removeValueStateClassesForPickerValueStateContent=function(e){var t=k,i=this.getRenderer().CSS_CLASS+"Picker",s=e.getContent()[0].getFixContent();Object.keys(t).forEach((function(e){var t=i+e+"State";s.removeStyleClass(t)}))},B.prototype._createPopover=function(){var e=this,t=new i({showArrow:!1,showHeader:!1,placement:L.VerticalPreferredBottom,offsetX:0,offsetY:0,initialFocus:this,ariaLabelledBy:this._getPickerHiddenLabelId()});return t.addEventDelegate({ontouchstart:function(t){var i=this.getDomRef("cont");(t.target===i||t.srcControl instanceof f)&&(e._bProcessChange=!1)}},t),this._decoratePopover(t),t},B.prototype._decoratePopover=function(e){var t=this;e.open=function(){return this.openBy(t)}},B.prototype._onBeforeRenderingPopover=function(){var e=this.getPicker(),t=this.$().outerWidth()+"px";e&&e.setContentMinWidth(t)},B.prototype._createDialog=function(){var e=this,i=this._getPickerHeader();return new t({stretch:!0,ariaLabelledBy:this._getPickerHiddenLabelId(),customHeader:i,beforeOpen:function(){e.updatePickerHeaderTitle()}})},B.prototype._getPickerTitle=function(){var e=this.getPicker(),t=e&&e.getCustomHeader();return t?t.getContentMiddle()[0]:null},B.prototype._getPickerHeader=function(){var e,t=c.getIconURI("decline");return this.getAggregation("_pickerHeader")||(e=V.getResourceBundleFor("sap.m"),this.setAggregation("_pickerHeader",new u({titleAlignment:o.TitleAlignment.Auto,contentMiddle:new h({text:e.getText("SELECT_PICKER_TITLE_TEXT"),level:M.H1}),contentRight:new p({icon:t,press:this.close.bind(this)})}))),this.getAggregation("_pickerHeader")},B.prototype._getPickerHiddenLabelId=function(){return m.getStaticId("sap.m","INPUT_AVALIABLE_VALUES")},B.prototype.getPickerValueStateContentId=function(){return this.getId()+"-valueStateText"},B.prototype.updatePickerHeaderTitle=function(){if(this.getPicker()){var e=this.getLabels();if(e.length){var t=e[0],i=this._getPickerTitle();t&&"function"==typeof t.getText&&i&&i.setText(t.getText())}}},B.prototype._onBeforeOpenDialog=function(){},B.prototype.init=function(){this.setPickerType(S.system.phone?"Dialog":"Popover"),this.createPicker(this.getPickerType()),this._oSelectionOnFocus=null,this.bRenderingPhase=!1,this._bFocusoutDueRendering=!1,this._bProcessChange=!1,this.sTypedChars="",this.iTypingTimeoutID=-1,this._oValueStateMessage=new g(this),this._bValueStateMessageOpened=!1,this._sAriaRoleDescription=V.getResourceBundleFor("sap.m").getText("SELECT_ROLE_DESCRIPTION"),this._oInvisibleMessage=null,this._referencingLabelsHandlers=[]},B.prototype.onBeforeRendering=function(){this._oInvisibleMessage||(this._oInvisibleMessage=A.getInstance()),this.bRenderingPhase=!0,this.synchronizeSelection({forceSelection:this.getForceSelection()}),this._updatePickerValueStateContentText(),this._updatePickerValueStateContentStyles(),this._detachHiddenSelectHandlers(),this._isIconOnly()&&this.setAutoAdjustWidth(!0)},B.prototype.onAfterRendering=function(){this.bRenderingPhase=!1,this._setHiddenSelectValue(),this._attachHiddenSelectHandlers(),this._clearReferencingLabelsHandlers(),this._handleReferencingLabels()},B.prototype.exit=function(){var e=this.getValueStateMessage(),t=this._getValueIcon();this._oSelectionOnFocus=null,this._oValueStateTextInvisibleText&&(this._oValueStateTextInvisibleText.destroy(),this._oValueStateTextInvisibleText=null),e&&(this.closeValueStateMessage(),e.destroy()),t&&t.destroy(),this._oValueStateMessage=null,this._bValueStateMessageOpened=!1},B.prototype.ontouchstart=function(e){e.setMarked(),this.getEnabled()&&this.getEditable()&&(this.addStyleClass(this.getRenderer().CSS_CLASS+"Pressed"),this.focus())},B.prototype.ontouchend=function(e){e.setMarked(),this.getEnabled()&&this.getEditable()&&!this.isOpen()&&this.isOpenArea(e.target)&&this.removeStyleClass(this.getRenderer().CSS_CLASS+"Pressed")},B.prototype.ontap=function(e){var t=this.getRenderer().CSS_CLASS;if(e.setMarked(),this.getEnabled()&&this.getEditable()){if(this.isOpenArea(e.target)){if(this.isOpen())return this.close(),void this.removeStyleClass(t+"Pressed");S.system.phone&&this.focus(),this.open()}this.isOpen()&&this.addStyleClass(t+"Pressed")}},B.prototype.onSelectionChange=function(e){var t=e.getParameter("selectedItem"),i=this.getSelectedItem();this.close(),this.setSelection(t),this.fireChange({selectedItem:t,previousSelectedItem:i}),this.setValue(this._getSelectedItemText())},B.prototype.onkeypress=function(e){if(this.getEditable()){e.setMarked();var t,i=String.fromCharCode(e.which);this.sTypedChars+=i,t=/^(.)\1+$/i.test(this.sTypedChars)?i:this.sTypedChars,clearTimeout(this.iTypingTimeoutID),this.iTypingTimeoutID=setTimeout(function(){this.sTypedChars="",this.iTypingTimeoutID=-1}.bind(this),1e3),w.call(this,this.searchNextItemByText(t))}},B.prototype.onsapshow=function(e){this.getEditable()&&(e.setMarked(),e.which===_.F4&&e.preventDefault(),this.toggleOpenState())},B.prototype.onsaphide=B.prototype.onsapshow,B.prototype.onmousedown=function(e){e.preventDefault(),this._getHiddenSelect().trigger("focus")},B.prototype.onsapescape=function(e){this.getEditable()&&!this._bSpaceDown&&this.isOpen()&&(e.setMarked(),this.close(),this._revertSelection())},B.prototype.onsapenter=function(e){e.preventDefault(),this.getEditable()&&(this.isOpen()&&e.setMarked(),this.close(),this._checkSelectionChange())},B.prototype.onkeydown=function(e){e.which===_.SPACE&&(this._bSpaceDown=!0),[_.ARROW_DOWN,_.ARROW_UP,_.SPACE].indexOf(e.which)>-1&&e.preventDefault(),e.which!==_.SHIFT&&e.which!==_.ESCAPE||(this._bSupressNextAction=this._bSpaceDown)},B.prototype.onkeyup=function(e){this.getEditable()&&e.which===_.SPACE&&(e.shiftKey||this._bSupressNextAction||(e.setMarked(),this.isOpen()&&this._checkSelectionChange(),this.toggleOpenState()),this._bSpaceDown=!1,this._bSupressNextAction=!1)},B.prototype.onsapdown=function(e){if(this.getEditable()){e.setMarked(),e.preventDefault();var t,i=this.getSelectableItems();t=i[i.indexOf(this.getSelectedItem())+1],w.call(this,t)}},B.prototype.onsapup=function(e){if(this.getEditable()){e.setMarked(),e.preventDefault();var t,i=this.getSelectableItems();t=i[i.indexOf(this.getSelectedItem())-1],w.call(this,t)}},B.prototype.onsaphome=function(e){if(this.getEditable()){e.setMarked(),e.preventDefault();var t=this.getSelectableItems()[0];w.call(this,t)}},B.prototype.onsapend=function(e){if(this.getEditable()){e.setMarked(),e.preventDefault();var t=this.findLastEnabledItem(this.getSelectableItems());w.call(this,t)}},B.prototype.onsappagedown=function(e){if(this.getEditable()){e.setMarked(),e.preventDefault();var t=this.getSelectableItems(),i=this.getSelectedItem();this.setSelectedIndex(t.indexOf(i)+10,t),(i=this.getSelectedItem())&&this.setValue(i.getText()),this.scrollToItem(i)}},B.prototype.onsappageup=function(e){if(this.getEditable()){e.setMarked(),e.preventDefault();var t=this.getSelectableItems(),i=this.getSelectedItem();this.setSelectedIndex(t.indexOf(i)-10,t),(i=this.getSelectedItem())&&this.setValue(i.getText()),this.scrollToItem(i)}},B.prototype.onsaptabnext=function(e){this.isOpen()&&(this.close(),this._checkSelectionChange())},B.prototype.onsaptabprevious=B.prototype.onsaptabnext,B.prototype.onfocusin=function(e){this._bFocusoutDueRendering||this._bProcessChange||(this._oSelectionOnFocus=this.getSelectedItem()),this._bProcessChange=!0,setTimeout(function(){!this.isOpen()&&this.shouldValueStateMessageBeOpened()&&document.activeElement===this.getFocusDomRef()&&this.openValueStateMessage()}.bind(this),100)},B.prototype.onfocusout=function(e){this._handleFocusout(e),this.bRenderingPhase||this.closeValueStateMessage()},B.prototype.onsapfocusleave=function(t){var i=this.getAggregation("picker");if(t.relatedControlId&&i){var s=e.registry.get(t.relatedControlId),o=s&&s.getFocusDomRef();S.system.desktop&&v(i.getFocusDomRef(),o)&&this.focus()}},B.prototype.getFocusDomRef=function(){return this._getHiddenSelect()[0]},B.prototype.getPopupAnchorDomRef=function(){return this.getDomRef()},B.prototype.setSelection=function(t){var i,s=this.getList();s&&s.setSelection(t),this.setAssociation("selectedItem",t,!0),this.setProperty("selectedItemId",t instanceof f?t.getId():t,!0),"string"==typeof t&&(t=e.registry.get(t)),i=t?t.getKey():"",this.setProperty("selectedKey",i,!0),this._handleAriaActiveDescendant(t)},B.prototype.setColumnRatio=function(e){var t=this.getList();return this.setProperty("columnRatio",e,!0),t&&this.getShowSecondaryValues()&&t.setProperty("_columnRatio",this.getColumnRatio()),this},B.prototype.isSelectionSynchronized=function(){return s.prototype.isSelectionSynchronized.apply(this,arguments)},B.prototype.synchronizeSelection=function(){s.prototype.synchronizeSelection.apply(this,arguments)},B.prototype.addContent=function(e){},B.prototype.addContentToFlex=function(){},B.prototype.createPicker=function(e){var t=this.getAggregation("picker"),i=this.getRenderer().CSS_CLASS;return t||(t=this["_create"+e](),this.setAggregation("picker",t,!0),t.setHorizontalScrolling(!1).setVerticalScrolling(!1).addStyleClass(i+"Picker").addStyleClass(i+"Picker-CTX").addStyleClass("sapUiNoContentPadding").attachBeforeOpen(this.onBeforeOpen,this).attachAfterOpen(this.onAfterOpen,this).attachBeforeClose(this.onBeforeClose,this).attachAfterClose(this.onAfterClose,this).addEventDelegate({onBeforeRendering:this.onBeforeRenderingPicker,onAfterRendering:this.onAfterRenderingPicker},this).addContent(this.getSimpleFixFlex()),t)},B.prototype.searchNextItemByText=function(e){var t,i,s,o,n=this.getSelectedItem();if(!n)return null;if("string"!=typeof e||""===e)return null;if(e.length>1&&n.getText().toLowerCase().startsWith(e.toLowerCase()))return n;t=this.getItems(),i=this.getSelectedIndex(),s=t.splice(i+1,t.length-i),o=t.splice(0,t.length-1),t=s.concat(o);for(var r,a=0;a<t.length;a++)if((r=t[a]).getEnabled()&&!r.isA("sap.ui.core.SeparatorItem")&&r.getText().toLowerCase().startsWith(e.toLowerCase()))return r;return null},B.prototype.createList=function(){var e=P,t=S.system.phone?e.Delimited:e.None;return this._oList=new s({width:"100%",keyboardNavigationMode:t,hideDisabledItems:!0}).addStyleClass(this.getRenderer().CSS_CLASS+"List-CTX").addEventDelegate({ontap:function(e){e.srcControl.getEnabled()&&(this._checkSelectionChange(),this.close())}},this).addEventDelegate({onAfterRendering:this.onAfterRenderingList},this).attachSelectionChange(this.onSelectionChange,this),this._oList.setProperty("_tabIndex","-1"),this._oList.toggleStyleClass("sapMSelectListWrappedItems",this.getWrapItemsText()),this._oList},B.prototype.setWrapItemsText=function(e){var t=this.getPicker();return this._oList&&this._oList.toggleStyleClass("sapMSelectListWrappedItems",e),t&&"Popover"===this.getPickerType()&&t.toggleStyleClass("sapMPickerWrappedItems",e),this.setProperty("wrapItemsText",e,!0)},B.prototype.hasContent=function(){return this.getItems().length>0},B.prototype.onBeforeRenderingPicker=function(){var e=this["_onBeforeRendering"+this.getPickerType()];e&&e.call(this)},B.prototype.onAfterRenderingPicker=function(){var e=this["_onAfterRendering"+this.getPickerType()];e&&e.call(this)},B.prototype.onAfterRenderingList=function(){},B.prototype.open=function(){var e=this.getPicker();return this.focus(),e&&e.open(),this},B.prototype.toggleOpenState=function(){return this.isOpen()?this.close():this.open(),this},B.prototype.getVisibleItems=function(){var e=this.getList();return e?e.getVisibleItems():[]},B.prototype.isItemSelected=function(e){return e&&e.getId()===this.getAssociation("selectedItem")},B.prototype.getSelectedIndex=function(){return this.getSelectedItem()?this.indexOfItem(this.getSelectedItem()):-1},B.prototype.getDefaultSelectedItem=function(e){return this.getForceSelection()?this.findFirstEnabledItem():null},B.prototype.getSelectableItems=function(){var e=this.getList();return e?e.getSelectableItems():[]},B.prototype.getOpenArea=function(){return this.getDomRef()},B.prototype.isOpenArea=function(e){var t=this.getOpenArea();return t&&t.contains(e)},B.prototype.getFormFormattedValue=function(){var e=this.getSelectedItem();return e?e.getText():""},B.prototype.getFormValueProperty=function(){return"selectedKey"},B.prototype.findItem=function(e,t){var i=this.getList();return i?i.findItem(e,t):null},B.prototype.clearSelection=function(){this.setSelection(null)},B.prototype.onItemChange=function(e){var t,i,s,o,n=this.getAssociation("selectedItem"),r=e.getParameter("id"),a=e.getParameter("name"),l=e.getParameter("newValue");if("key"===a&&!this.isBound("selectedKey")){if(i=this.getSelectedKey(),s=this.getItemByKey(l),l===i&&n!==r&&s&&r===s.getId())return void this.setSelection(s);if(t=e.getParameter("oldValue"),n===r&&i===t&&!this.getItemByKey(t))return void this.setSelectedKey(l);if(o=this.getItemByKey(i),n===r&&l!==i&&o)return void this.setSelection(o)}"text"===a&&n===r&&(this.fireEvent("_itemTextChange"),this.setValue(l))},B.prototype.fireChange=function(e){return this._oSelectionOnFocus=e.selectedItem,this.fireEvent("change",e)},B.prototype.addAggregation=function(e,t,i){return"items"!==e||i||this.isInvalidateSuppressed()||this.invalidate(t),n.prototype.addAggregation.apply(this,arguments)},B.prototype.destroyAggregation=function(e,t){return"items"!==e||t||this.isInvalidateSuppressed()||this.invalidate(),n.prototype.destroyAggregation.apply(this,arguments)},B.prototype.setAssociation=function(e,t,i){var o=this.getList();return o&&"selectedItem"===e&&s.prototype.setAssociation.apply(o,arguments),n.prototype.setAssociation.apply(this,arguments)},B.prototype.setProperty=function(e,t,i){var o=this.getList();"selectedKey"!==e&&"selectedItemId"!==e||o&&s.prototype.setProperty.apply(o,arguments);try{n.prototype.setProperty.apply(this,arguments)}catch(e){T.warning("Update failed due to exception. Loggable in support mode log",null,null,(function(){return{exception:e}}))}return this},B.prototype.removeAllAssociation=function(e,t){var i=this.getList();return i&&"selectedItem"===e&&s.prototype.removeAllAssociation.apply(i,arguments),n.prototype.removeAllAssociation.apply(this,arguments)},B.prototype.clone=function(){var e=n.prototype.clone.apply(this,arguments),t=this.getSelectedItem(),i=this.getSelectedKey();return this.isBound("selectedKey")||e.isSelectionSynchronized()||(t&&""===i?e.setSelectedIndex(this.indexOfItem(t)):e.setSelectedKey(i)),e},B.prototype._updatePickerAriaLabelledBy=function(e){var t,i=this.getPicker();i&&(t=this.getValueStateTextInvisibleText().getId(),e===k.None?i.removeAriaLabelledBy(t):i.addAriaLabelledBy(t))},B.prototype._handleReferencingLabels=function(){var e,t=this.getLabels(),i=this;t.forEach((function(t){t&&(e={ontap:function(){i.focus()}},i._referencingLabelsHandlers.push({oDelegate:e,sLabelId:t.getId()}),t.addEventDelegate(e))}))},B.prototype._clearReferencingLabelsHandlers=function(){var t;this._referencingLabelsHandlers.forEach((function(i){(t=e.registry.get(i.sLabelId))&&t.removeEventDelegate(i.oDelegate)})),this._referencingLabelsHandlers=[]},B.prototype.getLabels=function(){var t=this.getAriaLabelledBy().concat(a.getReferencingLabels(this));return t=t.filter((function(e,i){return t.indexOf(e)===i})).map((function(t){return e.registry.get(t)})).filter(Boolean)},B.prototype.getDomRefForValueStateMessage=function(){return this.getFocusDomRef()},B.prototype.getValueStateMessageId=function(){return this.getId()+"-message"},B.prototype.getValueStateMessage=function(){return this._oValueStateMessage},B.prototype.openValueStateMessage=function(){var e=this.getValueStateMessage();e&&!this._bValueStateMessageOpened&&(this._bValueStateMessageOpened=!0,e.open())},B.prototype.closeValueStateMessage=function(){var e=this.getValueStateMessage();e&&this._bValueStateMessageOpened&&(this._bValueStateMessageOpened=!1,e.close())},B.prototype.shouldValueStateMessageBeOpened=function(){return!this._isIconOnly()&&this.getValueState()!==k.None&&this.getEnabled()&&this.getEditable()&&!this._bValueStateMessageOpened},B.prototype.setShowSecondaryValues=function(e){var t=!this._isShadowListRequired();this.setProperty("showSecondaryValues",e,t);var i=this.getList(),s=e?this.getColumnRatio():null;return i&&(i.setShowSecondaryValues(e),i.setProperty("_columnRatio",s)),this},B.prototype.addItem=function(e){return this.addAggregation("items",e),e&&e.attachEvent("_change",this.onItemChange,this),this},B.prototype.insertItem=function(e,t){return this.insertAggregation("items",e,t),e&&e.attachEvent("_change",this.onItemChange,this),this},B.prototype.findAggregatedObjects=function(){var e=this.getList();return e?s.prototype.findAggregatedObjects.apply(e,arguments):[]},B.prototype.getItems=function(){var e=this.getList();return e?e.getItems():[]},B.prototype.setSelectedItem=function(t){return"string"==typeof t&&(this.setAssociation("selectedItem",t,!0),t=e.registry.get(t)),t instanceof f||null===t?(t||(t=this.getDefaultSelectedItem()),this.setSelection(t),this.setValue(this._getSelectedItemText(t)),this._oSelectionOnFocus=t,this):this},B.prototype.setSelectedItemId=function(e){return(e=this.validateProperty("selectedItemId",e))||(e=this.getDefaultSelectedItem()),this.setSelection(e),this.setValue(this._getSelectedItemText()),this._oSelectionOnFocus=this.getSelectedItem(),this},B.prototype._isKeyAvailable=function(e){return this._oList.getItems().map((function(e){return e.getKey()})).indexOf(e)>-1},B.prototype.setSelectedKey=function(e){var t=""===(e=this.validateProperty("selectedKey",e));if(t||this._isKeyAvailable(e)||!this.getResetOnMissingKey()||(t=!0),!this.getForceSelection()&&t)return this.setSelection(null),this.setValue(""),this.setProperty("selectedKey",e);var i=this.getItemByKey(e);return i||t?(!i&&t&&(i=this.getDefaultSelectedItem()),this.setSelection(i),this.setValue(this._getSelectedItemText(i)),this._oSelectionOnFocus=i,this):this.setProperty("selectedKey",e)},B.prototype.setValueState=function(e){var t,i,s=this.getValueState();return e===s?this:((i=this.getPicker())&&i.isA("sap.m.Popover")&&i.isOpen()&&i.oPopup.getOpenState()===E.CLOSING?i.attachEventOnce("afterClose",(function(t){this._updatePickerAriaLabelledBy(e)}),this):this._updatePickerAriaLabelledBy(e),this.setProperty("valueState",e),this._isFocused()&&this._announceValueStateText(),(t=this.getDomRefForValueState())?(!this.isOpen()&&this.shouldValueStateMessageBeOpened()&&document.activeElement===t?this.openValueStateMessage():this.closeValueStateMessage(),this._updatePickerValueStateContentText(),this._updatePickerValueStateContentStyles(),this):this)},B.prototype.setValueStateText=function(e){var t=this.getValueStateTextInvisibleText();return this.setProperty("valueStateText",e),t&&t.setText(e),this.getDomRefForValueState()&&(this._updatePickerValueStateContentText(),this._updatePickerValueStateContentStyles()),this._isFocused()&&this._announceValueStateText(),this},B.prototype.getItemAt=function(e){return this.getItems()[+e]||null},B.prototype.getSelectedItem=function(){var t=this.getAssociation("selectedItem");return null===t?null:e.registry.get(t)||null},B.prototype.getFirstItem=function(){return this.getItems()[0]||null},B.prototype.getLastItem=function(){var e=this.getItems();return e[e.length-1]||null},B.prototype.getEnabledItems=function(e){var t=this.getList();return t?t.getEnabledItems(e):[]},B.prototype.getItemByKey=function(e){var t=this.getList();return t?t.getItemByKey(e):null},B.prototype.removeItem=function(e){var t;return e=this.removeAggregation("items",e),0===this.getItems().length?this.clearSelection():this.isItemSelected(e)&&(t=this.findFirstEnabledItem())&&this.setSelection(t),this.setValue(this._getSelectedItemText()),e&&e.detachEvent("_change",this.onItemChange,this),e},B.prototype.removeAllItems=function(){var e=this.removeAllAggregation("items");this.setValue(""),this._isShadowListRequired()&&this.$().find(".sapMSelectListItemBase").remove();for(var t=0;t<e.length;t++)e[t].detachEvent("_change",this.onItemChange,this);return e},B.prototype.destroyItems=function(){return this.destroyAggregation("items"),this.setValue(""),this._isShadowListRequired()&&this.$().find(".sapMSelectListItemBase").remove(),this},B.prototype.isOpen=function(){var e=this.getAggregation("picker");return!(!e||!e.isOpen())},B.prototype.close=function(){var e=this.getAggregation("picker");return e&&e.close(),this},B.prototype.getDomRefForValueState=function(){return this.getFocusDomRef()},B.prototype._isRequired=function(){return this.getRequired()||a.isRequired(this)},B.prototype.getAccessibilityInfo=function(){var e,t=[],i=V.getResourceBundleFor("sap.m"),s=this._isIconOnly(),o={role:this.getRenderer().getAriaRole(this),focusable:this.getEnabled(),enabled:this.getEnabled(),readonly:s?void 0:this.getEnabled()&&!this.getEditable()};if(s){var n=this.getTooltip_AsString();if(!n){var r=c.getIconInfo(this.getIcon());n=r&&r.text?r.text:""}o.type=i.getText("ACC_CTR_TYPE_BUTTON"),t.push(n)}else"Default"===this.getType()&&(o.type=i.getText("SELECT_ROLE_DESCRIPTION"),t.push(this._getSelectedItemText()));return this._isRequired()&&t.push(i.getText("SELECT_REQUIRED")),(e=t.join(" ").trim())&&(o.description=e),o},B.prototype._getToolbarInteractive=function(){return!0},B.prototype.hasLabelableHTMLElement=function(){return this.getId()+"-hiddenSelect"},B}));