/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/suite/ui/commons/library","./ElementBase","./ElementAttribute","sap/ui/core/IconPool","sap/ui/Device","sap/base/security/encodeXML","sap/base/security/sanitizeHTML","sap/m/CheckBox","sap/m/Text","./NodeRenderer","sap/ui/core/Core","sap/ui/core/Lib"],function(jQuery,t,e,i,s,r,o,n,a,h,l,d,p){"use strict";var u=t.networkgraph.NodeShape,c=t.networkgraph.ActionButtonPosition,g=t.networkgraph.HeaderCheckboxState;var _=32,f=5,C=160,S=4;var m={Circle:{WIDTH:96,HEIGHT:64},Box:{WIDTH:160,HEIGHT:32},Attributes:{LINE:16,OFFSET:8},ActionButtons:{RADIUS:13,MARGIN:8,OFFSET:4},Title:{LINESIZE:15,OFFSET:8,ICON_SIZE:16,INFO_BOX_SIZE:20,ICON_X_OFFSET:6,IMAGE_OFFSET_Y:6},Description:{LINESIZE:15},Image:{Box:16,Circle:32}};var y={EXPANDED:"Expanded",COLLAPSED:"Collapsed",PARTIAL:"Partial"};var T={EXPAND:"sys-add",COLLAPSE:"sys-minus",PARTIAL:"overlay"};var v=s.getIconInfo(T.EXPAND),I=s.getIconInfo(T.COLLAPSE),x=s.getIconInfo(T.PARTIAL);v=v&&v.content;I=I&&I.content;x=x&&x.content;var N=p.getResourceBundleFor("sap.suite.ui.commons");var b=e.extend("sap.suite.ui.commons.networkgraph.Node",{metadata:{library:"sap.suite.ui.commons",properties:{headerCheckBoxState:{type:"sap.suite.ui.commons.networkgraph.HeaderCheckboxState",group:"Misc",defaultValue:g.Hidden},collapsed:{type:"boolean",group:"Misc",defaultValue:false},selected:{type:"boolean",group:"Misc",defaultValue:false},group:{type:"string",group:"Misc",defaultValue:null},key:{type:"string",group:"Misc",defaultValue:null},shape:{type:"sap.suite.ui.commons.networkgraph.NodeShape",groups:"Behavior",defaultValue:u.Circle},icon:{type:"string",group:"Appearance",defaultValue:null},statusIcon:{type:"string",group:"Appearance",defaultValue:null},width:{type:"int",group:"Misc",defaultValue:undefined},height:{type:"int",group:"Misc",defaultValue:undefined},maxWidth:{type:"int",group:"Misc",defaultValue:undefined},x:{type:"float",group:"Misc",defaultValue:0},y:{type:"float",group:"Misc",defaultValue:0},showExpandButton:{type:"boolean",defaultValue:true},showActionLinksButton:{type:"boolean",defaultValue:true},showDetailButton:{type:"boolean",defaultValue:true},titleLineSize:{type:"int",defaultValue:1},descriptionLineSize:{type:"int",defaultValue:-1},iconSize:{type:"int",group:"Appearance",defaultValue:undefined},coreNodeSize:{type:"int",group:"Appearance",defaultValue:0},visible:{type:"boolean",group:"Appearance",defaultValue:true},altText:{type:"string",group:"Appearance",defaultValue:null}},aggregations:{actionLinks:{type:"sap.ui.core.Control",multiple:true,singularName:"actionLink"},actionButtons:{type:"sap.suite.ui.commons.networkgraph.ActionButton",multiple:true,singularName:"actionButton"},image:{type:"sap.suite.ui.commons.networkgraph.NodeImage",multiple:false,singularName:"nodeImage"},content:{type:"sap.ui.core.Control",multiple:false},_checkBox:{type:"sap.m.CheckBox",multiple:false,visibility:"hidden"}},events:{headerCheckBoxPress:{parameters:{checked:"boolean"}},press:{},hover:{},collapseExpand:{}}},onAfterRendering:function(){this._afterRenderingBase()}});b.prototype.aProcessRequiredProperties=["key","group"];b.prototype.init=function(t){this._bThemeApplied=true;if(!d.isInitialized()){this._bThemeApplied=false;d.attachInit(this._handleCoreInitialized.bind(this))}else{this._handleCoreInitialized()}this._oExpandState=y.EXPANDED;this._oGroup=null;this._iWidth=0;this._iHeight=0;this._iLabelAttrWidth=0;this._iValueAttrWidth=0;this._aTitleLines=[[]];this._aDescriptionLines=[[]];this._bIsHidden=false;this._bActionButtonsRendered=false;this._iCircleSize=0;this._iGroupIndex=-1;this._clearChildren()};b.prototype._handleCoreInitialized=function(){this._bThemeApplied=d.isThemeApplied();d.attachThemeChanged(this._handleThemeApplied,this)};b.prototype._handleThemeApplied=function(){this._bThemeApplied=true;this.invalidate()};b.prototype._clearChildren=function(){this.aChildren=[];this.aParents=[];this.aLines=[];this.aParentLines=[]};b.prototype._afterRendering=function(){var t=this.$();if(this._isInCollapsedGroup()){return}this._correctTitle("sapSuiteUiCommonsNetworkNodeTitle");this._setupEvents();if(this._bIsHidden){t.hide()}if(!this.getVisible()||this._oGroup&&!this._oGroup.getVisible()){t.hide()}if(this._oExpandState===y.COLLAPSED){t.addClass("sapSuiteUiCommonsNetworkNodeCollapsed")}if(this._oExpandState===y.PARTIAL){t.addClass("sapSuiteUiCommonsNetworkNodePartialCollapsed")}this.$(this.getId()+"actionbuttons").detach();this._bActionButtonsRendered=false;this._removeFromInvalidatedControls();if(this._isHtml()&&!b.hasNativeLineClamp){this._setTextHeight(t.find(".sapSuiteUiCommonsNetworkGraphDivNodeTitle"),this.getTitleLineSize());this._setTextHeight(t.find(".sapSuiteUiCommonsNetworkGraphDivNodeDescription"),this.getDescriptionLineSize())}if(this.getSelected()){this.showActionButtons(true)}if(this._isInteractiveNode()){this.addStyleClass("sapMPointer")}else{this.removeStyleClass("sapMPointer")}};b.prototype._isInteractiveNode=function(){var t=this.getShowExpandButton()&&this._hasVisibleChildren(),e=this.getShowDetailButton()&&(this._hasDetailData()||this.getTitle()),i=this.getShowActionLinksButton()&&this._hasActionLinks(),s=this.getActionButtons(),r=s&&s.length>0,o=this.mEventRegistry.press;return t||e||i||r||o};b.prototype._render=function(t){var e=this.getParent(),i=e&&e._isUseNodeHtml();if(this._isIgnored()){return""}t=t||{};if(t.mapRender){if(this._oGroup&&!this._oGroup.getVisible()||!this.getVisible()){return""}}return i?this._renderHtml(t):this._renderSvg(t)};b.prototype._renderHtmlInfoIcon=function(t,e){t=t||{};e=e||{};var i=this.getStatusIcon(),s=this._convertToStyle(t,undefined,true),r=e.renderManager;r.openStart("div");r.attr("id",this._getElementId(e.idSufix)+"-statusiconwrapper");r.attr("title",N.getText("NETWORK_GRAPH_COLLAPSED"));this.applyStyles(r,this.getStyleObject(s));r.class("sapSuiteUiCommonsNetworkNodeDivInfoWrapper").class("sapSuiteUiCommonsNetworkNodeInfoWrapper");r.openEnd();r.openStart("div").class("sapSuiteUiCommonsNetworkNodeDivInfoIcon").class("sapSuiteUiCommonsNetworkGraphDivNodeIcon").openEnd();this._renderHtmlIcon(i||"sap-icon://hint",null,null,null,null,r);r.close("div");r.close("div")};b.prototype._renderHtmlText=function(t,e,i,s,r){this._renderHtmlElement("div",{"-webkit-line-clamp":e===0?"":e,color:s},{class:"sapSuiteUiCommonsNetworkGraphDivNodeText "+(i||"")+(e===1?" sapSuiteUiCommonsNetworkGraphDivTextBreakAll ":"")},r);r.text(t);r.close("div")};b.prototype._renderHtmlTitle=function(t,e){var i=this.getTitle();var s=i?i:this.getAltText();if(s){this._renderHtmlText(s,this.getTitleLineSize(),"sapSuiteUiCommonsNetworkGraphDivNodeTitleText sapSuiteUiCommonsNetworkGraphDivNodeTitle",t,e);e.openStart("div").style("clear","both").openEnd().close("div")}};b.prototype._renderHtmlDescription=function(t,e){var i=this.getDescriptionLineSize(),s=this.getDescription();if(s&&i!=-1){this._renderHtmlText(s,i,"sapSuiteUiCommonsNetworkGraphDivNodeDescription",t,e)}};b.prototype._renderHtmlTitleAndDescription=function(t){this._renderHtmlTitle(null,t);this._renderHtmlDescription(null,t)};b.prototype._renderHtmlAttributes=function(t){var e=this.getVisibleAttributes();if(!t.renderManager){return}if(e.length>0){t.renderManager.openStart("div").class("sapSuiteUiCommonsNetworkGraphDivNodeAttributes").openEnd();e.forEach(function(e){this._renderClonedControl(t,e)}.bind(this));t.renderManager.close("div")}};b.prototype._showDivActionButtons=function(t){var e=this,i=this.$("rightdivbuttons"),s=this.$("leftdivbuttons");if(t&&!this._bActionButtonsRendered){i.html("");s.html("");var r=0,o=0;if(this.getShowExpandButton()){this._appendActionButton({class:"sapSuiteUiCommonsNetworkNodeActionCollapseIcon",icon:this._getExpandIcon(true),enable:this._hasVisibleChildren(),title:N.getText("NETWORK_GRAPH_EXPAND_COLLAPSE"),id:this._getDomId("actionCollapse"),click:this._expandClick.bind(this)},i);r++}if(this.getShowDetailButton()){var n=this.getTitle();this._appendActionButton({icon:"sap-icon://menu2",enable:this._hasDetailData()||(n?n:this.getAltText()),id:this._getDomId("actionDetail"),title:N.getText("NETWORK_GRAPH_NODE_DETAILS"),click:function(t){this._detailClick(t.target)}.bind(this)},i);if(document.getElementById(this._getDomId("actionDetail"))){document.getElementById(this._getDomId("actionDetail")).setAttribute("aria-haspopup","dialog")}r++}if(this.getShowActionLinksButton()){this._appendActionButton({icon:"sap-icon://chain-link",enable:this._hasActionLinks(),title:N.getText("NETWORK_GRAPH_NODE_LINKS"),id:this._getDomId("actionLinks"),click:function(t){this._linksClick(t.target)}.bind(this)},i);if(document.getElementById(this._getDomId("actionLinks"))){document.getElementById(this._getDomId("actionLinks")).setAttribute("aria-haspopup","dialog")}r++}for(var a=0;r+o<S*2&&a<this.getActionButtons().length;a++){(function(t){var n=t.getPosition(),a=n===c.Right?r:o;if(a>=S){n=n===c.Left?c.Right:c.Left}var h=n===c.Right?i:s;e._appendActionButton({icon:t.getIcon(),enable:t.getEnabled(),title:t.getTitle(),id:t.getId(),click:function(e){t.firePress({buttonElement:e.target})}},h)})(this.getActionButtons()[a])}this._bActionButtonsRendered=true}var h=t?"addClass":"removeClass";this.$().find(".sapSuiteUiCommonsNetworkGraphDivActionButtons")[h](this.VISIBLE_ACTIONS_BUTTONS_CLASS)};b.prototype._getCorrectWidth=function(){var t=this._iWidth||this.getWidth()||"auto",e="";if(this.getMaxWidth()){e=this.getMaxWidth()+"px"}if(t!==""&&t!=="auto"){t+="px"}return{width:t,maxWidth:e}};b.prototype._renderHtml=function(t){var e=this._getElementId(t.idSufix),i=this._isCircle(),s=this._getCorrectWidth();this._renderHtmlElement("div",{width:i?s.width:"","max-width":i?s.maxWidth:"",top:!this._bMainRender&&this.getY()?this.getY()+"px":"",left:!this._bMainRender&&this.getX()?this.getX()+"px":"","min-width":C+"px"},{id:e,"data-sap-ui":e,class:this._getNodeClass()},t.renderManager);this.renderContent(t);t.renderManager.close("div")};b.prototype._renderHtmlContent=function(t){t=t||{};var i=this._getElementId(t.idSufix),s=this._iHeight||this.getHeight()||m.Circle.HEIGHT,r=this._isCircle();var o=function(){var e=this.getContent();if(e){t.renderManager.openStart("div",this.getId()+"-contentwrapper");t.renderManager.openEnd();this._renderClonedControl(t,e);t.renderManager.close("div")}else{this.renderItemContent(t)}}.bind(this);var n=this._getStatusStyle({"border-color":e.ColorType.Focus},false);if(r){this._iCircleSize=this._iCircleSize||s;var a=this._convertToStyle({width:this._iCircleSize+"px",height:this._iCircleSize+"px"},this._getStatusStyle({"border-color":e.ColorType.Border}),true);var h=this._getStatusStyle({"border-color":e.ColorType.Background},false);var l=this._getStatusStyle({"border-color":e.ColorType.Border,"background-color":this.getSelected()?e.ColorType.SelectedBackground:"","border-width":e.ColorType.BorderWidth,"border-style":e.ColorType.BorderStyle},false);t.renderManager.openStart("div",i+"-wrapperwithbuttons");t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivInnerWrapper");this.applyStyles(t.renderManager,this.getStyleObject(a));t.renderManager.openEnd();this.renderHtmlActionButtons(t);t.renderManager.openStart("div",i+"-wrapper");this.applyStyles(t.renderManager,this.getStyleObject(l));t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivInner");t.renderManager.openEnd();t.renderManager.openStart("div");t.renderManager.class("sapSuiteUiCommonsNetworkDivCircleWrapper");t.renderManager.openEnd();this._renderHtmlInfoIcon({},t);t.renderManager.openStart("div",i+"-focus");this.applyStyles(t.renderManager,this.getStyleObject(n));t.renderManager.class("sapSuiteUiCommonsNetworkDivFocus");t.renderManager.openEnd();t.renderManager.openStart("div",i+"-status");this.applyStyles(t.renderManager,this.getStyleObject(h));t.renderManager.class("sapSuiteUiCommonsNetworkDivCircleStatus");t.renderManager.openEnd();this.renderItemContent(t);t.renderManager.close("div");t.renderManager.close("div");t.renderManager.close("div");t.renderManager.close("div");t.renderManager.close("div");this._renderHtmlTitleAndDescription(t.renderManager)}else{var d=this._getCorrectWidth();var a=this._convertToStyle({width:d.width,"max-width":d.maxWidth?d.maxWidth:"inherit","min-width":C+"px"},this._getStatusStyle({"border-color":e.ColorType.Border,"background-color":this.getSelected()?e.ColorType.SelectedBackground:"","border-width":e.ColorType.BorderWidth,"border-style":e.ColorType.BorderStyle}),true);this.renderHtmlActionButtons(t);t.renderManager.openStart("div",i+"-wrapper");this.applyStyles(t.renderManager,this.getStyleObject(a));t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivInner").openEnd();t.renderManager.openStart("div",i+"-focus");this.applyStyles(t.renderManager,this.getStyleObject(n));t.renderManager.class("sapSuiteUiCommonsNetworkDivFocus").openEnd();t.renderManager.close("div");var h=this._getStatusStyle({"background-color":e.ColorType.Background},false);var p=this._getColor(this.getSelected()?e.ColorType.Content:e.ColorType.HeaderContent);t.renderManager.openStart("div",i+"-header");this.applyStyles(t.renderManager,this.getStyleObject(h));t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivHeader");if(this._hasHeaderContent()){t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivHeaderColor")}if(!this._hasAdditionalContent()){t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivHeaderOnly")}t.renderManager.openEnd();if(this._showHeaderCheckBox()){this._renderClonedControl(t,this._getHeaderCheckbox())}this._renderHtmlTitleIcon("sapSuiteUiCommonsNetworkGraphDivNodeIconTitle",t.renderManager);this._renderHtmlTitle(p,t.renderManager);t.renderManager.close("div");o();t.renderManager.close("div");this._renderHtmlInfoIcon({},t)}};b.prototype._getHeaderCheckbox=function(){var t=this.getAggregation("_checkBox"),e=this;if(!t){t=new a(this.getId()+"-checkbox").addStyleClass("sapSuiteUiCommonsNetworkGraphHeaderCheckboxInner");t.addEventDelegate({onAfterRendering:function(){t.$().on("mousedown",function(i){var s=!t.getSelected();t.setSelected(s);e.fireHeaderCheckBoxPress({checked:s});i.stopPropagation()})}});this.setAggregation("_checkBox",t,true)}return t};b.prototype._renderHtmlTitleIcon=function(t,i){var s=this.getIcon(),r=this.getImage(),o=this.getIconSize()?'style="font-size:'+this.getIconSize()+'px"':"",n,a;t=(t||"")+" sapSuiteUiCommonsNetworkGraphDivNodeTitleText sapSuiteUiCommonsNetworkGraphDivNodeIcon";n=this._getStatusStyle({color:this._isBox()?e.ColorType.HeaderContent:e.ColorType.Content},false);if(r){a=this._getImageSize();this._renderHtmlElement("img",{width:a.width+"px",height:a.height+"px"},{src:r.getSrc(),class:"sapSuiteUiCommonsNetworkGraphDivNodeImage"},i)}else if(s){i.openStart("div");this.applyStyles(i,this.getStyleObject(n));t.split(" ").forEach(function(t){if(t){i.class(t)}});i.openEnd();this._renderHtmlIcon(s,null,null,o,null,i);i.close("div")}};b.prototype._renderHtmlBoxContent=function(t){var i=this._hasAdditionalContent(),s=this._getElementId(t.idSufix);if(i){t.renderManager.openStart("div",s+"-additionalwarpper");t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivAdditionalContent").openEnd();var r=this._getColor(e.ColorType.Content);this._renderHtmlDescription(r,t.renderManager);this._renderHtmlAttributes(t);t.renderManager.close("div")}};b.prototype._renderHtmlCircleContent=function(t){this._renderHtmlTitleIcon("sapSuiteUiCommonsNetworkGraphDivNodeCircleIcon",t.renderManager)};b.prototype._renderSvg=function(t){t=t||{};var e=t.renderManager;var i=this._getElementId(t.idSufix);if(!e){var s=this._renderControl("g",{id:i,"data-sap-ui":i,nodeid:o(this.getKey()),class:this._getNodeClass()},false);s+=this._renderControl("g",{id:i+"-wrapper",class:"sapSuiteUiCommonsNetworkNodeShape"},false);s+=this._renderContent(t);s+="</g>";s+="</g>";return s}this._renderControl("g",{id:i,"data-sap-ui":i,nodeid:o(this.getKey()),class:this._getNodeClass()},false,e);this._renderControl("g",{id:i+"-wrapper",class:"sapSuiteUiCommonsNetworkNodeShape"},false,e);var r=this._renderContent(t);e.close("g");e.close("g");if(r&&typeof r==="string"){return r}};b.prototype._renderSvgContent=function(t){t=t||{};var e=t.renderManager;var i=this.getParent()._bIsRtl,s,r;if(this._isCircle()){var o=this._iCircleSize/8,n=this._iCircleSize/5.3;s=i?this._getCirclePosition().x+this._iCircleSize-o:this._getCirclePosition().x+o;r=this.getY()+n}else{s=this.getX();r=this.getY()}if(!e){var a=this._isBox()?this._renderBox(t):this._renderCircle(t);a+=this.renderStatusIcon({x:s-this.getX(),y:r-this.getY()});return a}var h=this._isBox()?this._renderBox(t):this._renderCircle(t);this.renderStatusIcon({x:s-this.getX(),y:r-this.getY(),renderManager:e});if(h&&typeof h==="string"){return h}};b.prototype._renderContent=function(t){return this.renderContent(t)};b.prototype._renderCircleContent=function(t){var i=this._iCircleSize,s=this.getParent()._bIsRtl,r=this.getImage(),o,a=this.getX(),h=this.getY();var l,d,p,u,c,g,_,f;t=t||{};var C=t.renderManager;d=this.getTitle();p=d?d:this.getAltText();if(this._displayImage(r)){o=this._getImageSize();l={"xlink:href":r.getSrc(),x:a+this._iWidth/2-o.width/2,y:h+i/2-o.height/2,width:o.width,height:o.height}}else if(this.getIcon()){u={attributes:{class:"sapSuiteUiCommonsNetworkGraphIcon sapSuiteUiCommonsNetworkCircleNodeIcon sapSuiteUiCommonsNetworkStatusText",style:(this.getIconSize()?"font-size:"+this.getIconSize()+"px;":"")+this._getStatusStyle({fill:e.ColorType.Content}),x:a+this._iWidth/2,y:h+i/2},icon:this.getIcon(),height:this.getIconSize()?this.getIconSize()-2:22}}if(p){if(!this._aTitleLines||this._aTitleLines.length===1){c={class:"sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeText",x:a+this._iWidth/2,y:h+i+m.Title.OFFSET,title:n(p),maxWidth:this._iWidth-5};g={id:this.getId()+"-title-clip",x:a,y:h+i+m.Title.OFFSET-10,height:m.Title.LINESIZE*2}}else{_={x:a+this._iWidth/2,y:h+i+m.Title.OFFSET*2}}}if(this._displayDescription()){f={x:s?a+this._iWidth-m.Title.OFFSET:a+m.Title.OFFSET,y:h+this._getTitleHeight()+i+m.Title.OFFSET*2+m.Title.OFFSET/2}}if(!C){var S="";if(this._displayImage(r)){S+=this._renderControl("image",l)}else if(this.getIcon()){S+=this._renderIcon(u)}if(p){if(!this._aTitleLines||this._aTitleLines.length===1){S+=this._renderClipPath(g);S+=this._renderTitle(c)}else{S+=this._renderMultilineTitle(_)}}if(this._displayDescription()){S+=this._renderDescription(f)}return S}if(this._displayImage(r)){this._renderControl("image",l,null,C)}else if(this.getIcon()){u.renderManager=C;this._renderIcon(u)}if(p){if(!this._aTitleLines||this._aTitleLines.length===1){g.renderManager=C;c.renderManager=C;this._renderClipPath(g);this._renderTitle(c)}else{_.renderManager=C;this._renderMultilineTitle(_)}}if(this._displayDescription()){f.renderManager=C;this._renderDescription(f)}};b.prototype._renderCircle=function(t){var i=this.getX(),s=this.getY(),r=6,o=2,n=this._iCircleSize;t=t||{};var a=t.renderManager;var h={id:this.getId()+"-innerBox",cx:i+this._iWidth/2,cy:s+n/2,style:this._getStatusStyle({stroke:e.ColorType.Border}),r:n/2,class:"sapSuiteUiCommonsNetworkInnerCircle"};var l={id:this.getId()+"-statusCircle",cx:i+this._iWidth/2,cy:s+n/2,style:this._getStatusStyle({stroke:e.ColorType.Background}),r:n/2-r,class:"sapSuiteUiCommonsNetworkInnerCircleStatus"};var d={id:this.getId()+"-focusCircle",cx:i+this._iWidth/2,cy:s+n/2,style:this._getStatusStyle({stroke:e.ColorType.Focus}),r:n/2-o,class:"sapSuiteUiCommonsNetworkCircleFocus"};if(!a){var p="";p+=this._renderControl("circle",h);p+=this._renderControl("circle",l);p+=this._renderControl("circle",d);p+=this.renderItemContent();return p}this._renderControl("circle",h,null,a);this._renderControl("circle",l,null,a);this._renderControl("circle",d,null,a);return this.renderItemContent({renderManager:a})};b.prototype._renderBoxContent=function(t){var i=_/2,s=m.Title.ICON_X_OFFSET,r=this.getParent()._bIsRtl,o=this.getImage(),a=this.getY(),h=this.getX(),l,d=this._getImageSize();var p,u,c,g,C,S;t=t||{};var y=t.renderManager;var T=this.getTitle();var v=T?T:this.getAltText();if(this._displayImage(o)){d=this._getImageSize();p={"xlink:href":o.getSrc(),x:r?h+this._iWidth-m.Title.ICON_X_OFFSET-d.width:h+m.Title.ICON_X_OFFSET,y:a+m.Title.IMAGE_OFFSET_Y,width:d.width,height:d.height};s+=d.width+m.Title.ICON_X_OFFSET}else if(this.getIcon()){u={attributes:{style:this._getStatusStyle({fill:e.ColorType.Content}),class:"sapSuiteUiCommonsNetworkGraphIcon sapSuiteUiCommonsNetworkNodeTitleIcon sapSuiteUiCommonsNetworkStatusText",x:r?h+this._iWidth-m.Title.ICON_X_OFFSET:h+m.Title.ICON_X_OFFSET,y:a+i},icon:this.getIcon(),height:m.Title.LINESIZE};s+=m.Title.ICON_SIZE+m.Title.ICON_X_OFFSET}if(v){l=this._iWidth-s-f;if(l>0){if(!this._aTitleLines||this._aTitleLines.length===1){c={id:this.getId()+"-title-clip",x:h,y:a,height:_};g={class:"sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeText sapSuiteUiCommonsNetworkStatusText",style:this._getStatusStyle({fill:e.ColorType.Content}),x:r?h+this._iWidth-s:h+s,y:a+i,maxWidth:l,title:n(v)}}else{C={x:r?h+this._iWidth-s:h+s,y:a+m.Title.OFFSET*2}}}}if(this._displayDescription()){S={x:r?h+this._iWidth-m.Title.OFFSET:h+m.Title.OFFSET-m.Title.OFFSET/3,y:a+this._getTitleHeight()+(this._hasMultiLineTitle()?m.Title.OFFSET*2+m.Title.OFFSET/2:m.Title.OFFSET*4)}}if(!y){var I="";if(this._displayImage(o)){d=this._getImageSize();I+=this._renderControl("image",p)}else if(this.getIcon()){I+=this._renderIcon(u)}if(v){if(l>0){if(!this._aTitleLines||this._aTitleLines.length===1){I+=this._renderClipPath(c);I+=this._renderTitle(g)}else{I+=this._renderMultilineTitle(C)}}}if(this._displayDescription()){I+=this._renderDescription(S)}if(this._displayAttributes()){I+=t.sizeDetermination?this._renderAttributesForSize():this._renderAttributes({y:this.getY()+this._getDescriptionHeight()+this._getTitleHeight()+m.Title.OFFSET+(!this._hasMultiLineTitle()?m.Attributes.OFFSET:0)})}return I}if(this._displayImage(o)){this._renderControl("image",p,null,y)}else if(this.getIcon()){u.renderManager=y;this._renderIcon(u)}if(v){if(l>0){if(!this._aTitleLines||this._aTitleLines.length===1){c.renderManager=y;g.renderManager=y;this._renderClipPath(c);this._renderTitle(g)}else{C.renderManager=y;this._renderMultilineTitle(C)}}}if(this._displayDescription()){S.renderManager=y;this._renderDescription(S)}if(this._displayAttributes()){t.sizeDetermination?this._renderAttributesForSize({renderManager:y}):this._renderAttributes({y:this.getY()+this._getDescriptionHeight()+this._getTitleHeight()+m.Title.OFFSET+(!this._hasMultiLineTitle()?m.Attributes.OFFSET:0),renderManager:y})}};b.prototype._renderBox=function(t){var i=6,s=4,r=(this._iTitleHeight||this._getTitleHeight())+i,o=3;var n=this.getY(),a=this.getX();var h=this._iHeight===_;t=t||{};var l=t.renderManager;var d={id:this.getId()+"-innerBox",x:a,y:n,style:this._getStatusStyle({stroke:e.ColorType.Border}),class:"sapSuiteUiCommonsNetworkInnerRect",rx:o,ry:o,width:this._iWidth,height:this._iHeight,"pointer-events":"fill"};var p={id:this.getId()+"-innerStatusBox",x:a,y:n,style:this._getStatusStyle({fill:e.ColorType.Background}),class:"sapSuiteUiCommonsNetworkNodeBoxStatus",topRight:o,topLeft:o,bottomRight:h?o:0,bottomLeft:h?o:0,width:this._iWidth,height:Math.max(r,_),"pointer-events":"fill"};var u={id:this.getId()+"-focusCircle",x:a+s,y:n+s,class:"sapSuiteUiCommonsNetworkBoxFocus",style:this._getStatusStyle({stroke:e.ColorType.Focus}),rx:5,ry:5,width:this._iWidth-s*2,height:this._iHeight-s*2};if(!l){var c=this._renderControl("rect",d);c+=this._renderRoundRect(p);c+=this._renderControl("rect",u);c+=this.renderItemContent(t);return c}this._renderControl("rect",d,null,l);p.renderManager=l;this._renderRoundRect(p);this._renderControl("rect",u,null,l);var g=this.renderItemContent(t);if(g&&typeof g==="string"){return g}};b.prototype._renderInfoIcon=function(t,e,i,s,r){var o=this.getStatusIcon(),n=o?"sapSuiteUiCommonsNetworkNodeInfoWrapperCustomIcon":"";var a={class:"sapSuiteUiCommonsNetworkNodeInfoBox",cx:t,cy:e,r:i||m.Title.INFO_BOX_SIZE/2};var h={attributes:{id:this.getId()+"-statusicon",class:"sapSuiteUiCommonsNetworkNodeInfoIcon sapSuiteUiCommonsNetworkGraphIcon",x:t+m.Title.INFO_BOX_SIZE/2-10,y:e,style:s?"font-size:"+s:""},icon:o||"sap-icon://hint",height:m.Title.INFO_BOX_SIZE/2+2.5};if(!r){var l='<g id="'+this.getId()+"-statusiconwrapper"+'" class="sapSuiteUiCommonsNetworkNodeInfoWrapper '+n+'">';l+=this._renderControl("circle",a,false);l+="<title>"+N.getText("NETWORK_GRAPH_COLLAPSED")+"</title>";l+="</circle>";l+=this._renderIcon(h);l+="</g>";return l}r.openStart("g",this.getId()+"-statusiconwrapper");r.class("sapSuiteUiCommonsNetworkNodeInfoWrapper");r.class(n);r.openEnd();this._renderControl("circle",a,false,r);r.openStart("title");r.openEnd();r.text(N.getText("NETWORK_GRAPH_COLLAPSED"));r.close("title");r.close("circle");h.renderManager=r;this._renderIcon(h);r.close("g")};b.prototype._getNodeClass=function(){var t=this.getSelected()?this.SELECT_CLASS:"",e=this._hasCustomStatus()?" sapSuiteUiCommonsNetworkNodeCustomStatus ":"",i="";if(this.aCustomStyleClasses){i=this.aCustomStyleClasses.join(" ")}return(this.getParent()._isUseNodeHtml()?"sapSuiteUiCommonsNetworkGraphDivNode ":"sapSuiteUiCommonsNetworkNode ")+t+e+(this._isBox()?" sapSuiteUiCommonsNetworkBox ":" sapSuiteUiCommonsNetworkNodeCircle ")+this._getStatusClass()+i};b.prototype._renderAttributesForSize=function(t){t=t||{};var e=t.renderManager;if(!e){var i="",s="";this.getVisibleAttributes().forEach(function(t){i+=this._renderText({attributes:{class:"sapSuiteUiCommonsNetworkGraphAttribute",x:this.getX(),y:this.getY()},text:t.getLabel()});s+=this._renderText({attributes:{class:"sapSuiteUiCommonsNetworkGraphAttribute",x:this.getX(),y:this.getY()},text:t.getValue()})},this);i='<g id="'+this.getId()+'-attrLabel">'+i+"</g>";s='<g id="'+this.getId()+'-attrValue">'+s+"</g>";return i+s}e.openStart("g",this.getId()+"-attrLabel");e.openEnd();this.getVisibleAttributes().forEach(function(t){this._renderText({attributes:{class:"sapSuiteUiCommonsNetworkGraphAttribute",x:this.getX(),y:this.getY()},text:t.getLabel(),renderManager:e})},this);e.close("g");e.openStart("g",this.getId()+"-attrValue");e.openEnd();this.getVisibleAttributes().forEach(function(t){this._renderText({attributes:{class:"sapSuiteUiCommonsNetworkGraphAttribute",x:this.getX(),y:this.getY()},text:t.getValue(),renderManager:e})},this);e.close("g")};b.prototype._getAttributeColor=function(t,e,i){var s=e+"Status",r=t["get"+s]()||this.getStatus();return this._getColor(i,r)};b.prototype._getAttributeColorString=function(t,e,i){var s=this._getAttributeColor(t,e,i);return s?"fill:"+s:""};b.prototype._renderAttributes=function(t){t=t||{};var s=t.renderManager;var r=2,o=6,n=12;var a=this.getParent()._bIsRtl,h=a?this.getX()+this._iWidth-o:this.getX()+o,l=this._iLabelAttrWidth?this._iLabelAttrWidth:this._iWidth/2-n,d=a?h-l-n:h+l+n,p=a?d-this.getX()-o:this.getX()+this._iWidth-d-o;var u=t.y;if(!s){var c=this._renderControl("g",{"clip-path":"url(#"+this.getId()+"-clip-attr-value)",id:this.getId()+"-attrValue"},false),g=this._renderControl("g",{"clip-path":"url(#"+this.getId()+"-clip-attr-label)",id:this.getId()+"-attrLabel"},false),_=this._renderClipPath({id:this.getId()+"-clip-attr-label",x:a?h-l-o+r:h-r,y:u,width:r*2+(a?l+o:l)});_+=this._renderClipPath({id:this.getId()+"-clip-attr-value",x:a?this.getX()+o+r:d-r,y:u,width:r*2+(a?p+o:p)});this.getVisibleAttributes().forEach(function(t,s){var r=u+m.Attributes.LINE*(s+1);g+=this._renderText({attributes:{style:this._getAttributeColorString(t,i.Type.Label,e.ColorType.Content),class:"sapSuiteUiCommonsNetworkGraphAttribute sapSuiteUiCommonsNetworkStatusText",x:h,id:t.getId()+"-label",y:r},text:t.getLabel()});c+=this._renderText({attributes:{style:this._getAttributeColorString(t,i.Type.Value,e.ColorType.Content),class:"sapSuiteUiCommonsNetworkGraphAttribute sapSuiteUiCommonsNetworkGraphAttributeValue sapSuiteUiCommonsNetworkStatusText",x:d,y:r,id:t.getId()+"-value"},text:t.getValue()})},this);c+="</g>";g+="</g>";return _+g+c}this._renderClipPath({id:this.getId()+"-clip-attr-label",x:a?h-l-o+r:h-r,y:u,width:r*2+(a?l+o:l),renderManager:s});this._renderClipPath({id:this.getId()+"-clip-attr-value",x:a?this.getX()+o+r:d-r,y:u,width:r*2+(a?p+o:p),renderManager:s});this._renderControl("g",{"clip-path":"url(#"+this.getId()+"-clip-attr-label)",id:this.getId()+"-attrLabel"},false,s);this.getVisibleAttributes().forEach(function(t,r){var o=u+m.Attributes.LINE*(r+1);this._renderText({attributes:{style:this._getAttributeColorString(t,i.Type.Label,e.ColorType.Content),class:"sapSuiteUiCommonsNetworkGraphAttribute sapSuiteUiCommonsNetworkStatusText",x:h,id:t.getId()+"-label",y:o},text:t.getLabel(),renderManager:s})},this);s.close("g");this._renderControl("g",{"clip-path":"url(#"+this.getId()+"-clip-attr-value)",id:this.getId()+"-attrValue"},false,s);this.getVisibleAttributes().forEach(function(t,r){var o=u+m.Attributes.LINE*(r+1);this._renderText({attributes:{style:this._getAttributeColorString(t,i.Type.Value,e.ColorType.Content),class:"sapSuiteUiCommonsNetworkGraphAttribute sapSuiteUiCommonsNetworkGraphAttributeValue sapSuiteUiCommonsNetworkStatusText",x:d,y:o,id:t.getId()+"-value"},text:t.getValue(),renderManager:s})},this);s.close("g")};b.prototype._detailClick=function(t){t=t||this;t.useClientRect=true;this.getParent()._tooltip.openDetail({item:this,opener:t})};b.prototype._linksClick=function(t){t=t||this;this.getParent()._tooltip.openLink({item:this,opener:t})};b.prototype._expandClick=function(){var t=this.fireEvent("collapseExpand",{},true);if(t){this.setCollapsed(this._oExpandState!==y.COLLAPSED)}};b.prototype._setupMaxWidth=function(){var t=this.getMaxWidth();if(t){this._iWidth=t}};b.prototype._setTextHeight=function(t,e){if(t[0]&&e>0){var i=this.$().find(".sapSuiteUiCommonsNetworkGraphDivNodeIcon.sapSuiteUiCommonsNetworkGraphDivNodeIconTitle");i.hide();var s=t.height();t.css("white-space","nowrap");var r=t.height();if(r!==0&&s!==0){t.height(Math.min(s,e*r))}t.css("white-space","");i.show()}};b.prototype._applyMaxWidth=function(){var t=30,e=10;var i,s,r,o=0,n=0,a=0,h,l=this.getMaxWidth();if(this._oGroup&&this._oGroup.getCollapsed()){return}if(!this.getWidth()&&this.getMaxWidth()){s=this.$("attrLabel");r=this.$("attrValue");if(s[0]){n=s[0].getBBox().width}if(r[0]){o=r[0].getBBox().width}a=o+n+t;i=Math.max(this.$()[0].getBBox().width+e,a);this._iWidth=Math.max(Math.min(i,l),80);if(o&&n){h=Math.max(n,o);if(h*2+t/2<this._iWidth){return}if(a>this._iWidth){if(o<l/2){this._iLabelAttrWidth=this._iWidth-o-t}if(n<this._iWidth/2){this._iLabelAttrWidth=n+t/4}}else{this._iLabelAttrWidth=this._iWidth-o-t}}}};b.prototype._resetDimensions=function(){this._iWidth=0;this._iHeight=0;this._iCircleSize=0;this._iTitleHeight=0};b.prototype._setupDivDimensions=function(){var t=this.$();this._iWidth=t.width();this._iHeight=t.height()};b.prototype._setupWidthAndHeight=function(t){var e=this._isBox()?"Box":"Circle",i=this._getTitleHeight(),s=this.getTitle()||this._hasDetailData()?m.Title.LINESIZE:0,r=this._getDescriptionHeight();r=r?r+5:0;var o=function(){var t=this._iHeight||this.getHeight();if(this._isBox()&&!t){t=r+(this._hasMultiLineTitle()?i+m.Title.OFFSET:Math.max(i+s,m.Box.HEIGHT));if(this._displayAttributes()){t+=this.getVisibleAttributes().length*m.Attributes.LINE+m.Attributes.OFFSET}}if(this._isCircle()&&!this._iHeight){t=t?t:m[e].HEIGHT;this._iCircleSize=t;t+=i+r}return Math.max(t,30)}.bind(this);var n=function(){var t=Math.max(this._iWidth||this.getWidth()||m[e].WIDTH,30);if(this._isCircle()&&t<this._iCircleSize){t=this._iCircleSize}return t}.bind(this);this._iHeight=o();this._iWidth=n()};b.prototype._getTitleHeight=function(){var t=0,e=this._getImageSize();if(this._hasMultiLineTitle()){t=(this.getTitleLineSize()>0?Math.min(this._aTitleLines.length,this.getTitleLineSize()):this._aTitleLines.length)*m.Title.LINESIZE}else{t=this._isBox()||this.getTitle()?m.Title.LINESIZE:0}return Math.max(e.height,t)};b.prototype._getDescriptionHeight=function(){var t=this.getDescriptionLineSize();if(t===-1||!this._aDescriptionLines||!this.getDescription()){return 0}return(t>0?Math.min(t,this._aDescriptionLines.length):this._aDescriptionLines.length)*m.Description.LINESIZE};b.prototype._setupEvents=function(){var t=this.$("wrapper");t.off("mouseover");t.off("mouseout");t.off("click");t.on("mouseover",function(t){this._mouseOver()}.bind(this));t.on("mouseout",function(t){this._mouseOut()}.bind(this));t.on("click",function(t){if(t.which===1){this._onClick(t.ctrlKey)}t.preventDefault()}.bind(this))};b.prototype._mouseOut=function(){this.$().removeClass(this.HIGHLIGHT_CLASS);if(!this.getSelected()){this._setStatusColors("")}};b.prototype._mouseOver=function(){var t=this.fireEvent("hover",{},true);if(t){if(!this.getSelected()){this._setStatusColors("Hover")}this.$().addClass(this.HIGHLIGHT_CLASS)}};b.prototype._onClick=function(t){var e=this.fireEvent("press",{},true);this.getParent()._selectNode({element:this,forceFocus:true,renderActionButtons:e&&!this.getSelected(),preventDeselect:t});if(!this.getSelected()){this.$().addClass(this.HIGHLIGHT_CLASS);this._setStatusColors("Hover")}};b.prototype._deselect=function(){var t=this.$("innerBox");t.css("stroke",this._getColor(e.ColorType.Border));t.css("fill",this._getColor(e.ColorType.Background))};b.prototype._getExpandIcon=function(t){switch(this._oExpandState){case y.PARTIAL:return t?T.PARTIAL:x;case y.EXPANDED:return t?T.COLLAPSE:I;case y.COLLAPSED:return t?T.EXPAND:v;default:return t?T.EXPAND:v}};b.prototype._createLineText=function(t,e,i,s){var r=[[]],o=0,n,a,h,l,d,p,u=this._createElement("tspan");if(!t||e<0){return r}l=t.split(/\s+/).reverse();i.appendChild(u);while(l.length>0){a=l.pop();if(a){h=r[o];h.push(a);u.textContent=r[o].join(" ");if(u.getComputedTextLength()>e){if(h.length>1&&s!==1){l.push(h.pop())}if(h.length===1){p=this._createText(i,{text:h[0],width:e,dots:false});if(p){d=u.textContent;h.pop();h.push(d);n=a.substring(d.length);l.push(n)}}o++;if(s>0&&o>=s){break}r[o]=[]}}}if(s>0&&l.length>0){r[r.length-1].push("...")}if(r.length>0){p=this._createText(i,{text:r[r.length-1].join(" "),width:e,dots:true});if(p){r[s-1]=[u.textContent]}}return r};b.prototype._createDescription=function(){var t,e=this._iWidth-m.Title.OFFSET,i=this.$();if(this._displayDescription()&&i[0]){t=this._createElement("text");t.setAttribute("class","sapSuiteUiCommonsNetworkNodeDescription");i[0].appendChild(t);this._aDescriptionLines=this._createLineText(this.getDescription(),e,t,this.getDescriptionLineSize())}};b.prototype._createMultilineTitle=function(){var t=function(){if(this._isBox()){if(this._displayImage()){return this._iWidth-this._getImageSize().width-m.Title.ICON_X_OFFSET*2}if(this.getIcon()){return this._iWidth-m.Title.ICON_SIZE-m.Title.ICON_X_OFFSET*2}return this._iWidth-m.Title.OFFSET*2}return this._iWidth}.bind(this);var e,i=t(),s=this.$();if(this.getTitleLineSize()!==1&&s[0]&&i>0){e=this._createElement("text");e.setAttribute("class","sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeMultipleLineTitle");s[0].appendChild(e);this._aTitleLines=this._createLineText(this.getTitle(),i,e,this.getTitleLineSize())}};b.prototype.getFocusDomRef=function(){return this.getDomRef("wrapper")};b.prototype._renderMultilineText=function(t){var i=this._isBox()&&t.useCustomstyle;t=t||{};var s=t.renderManager;if(!t.lines){return""}if(!s){var r="";for(var o=0;o<t.lines.length;o++){r+=this._renderText({attributes:{style:i?this._getStatusStyle({fill:e.ColorType.Content}):"",class:t.class+(i?" sapSuiteUiCommonsNetworkStatusText ":""),x:t.x,y:t.y+o*t.lineSize},close:false});r+=t.lines[o].join(" ");r+="</text>"}return r}for(var n=0;n<t.lines.length;n++){this._renderText({attributes:{style:i?this._getStatusStyle({fill:e.ColorType.Content}):"",class:t.class+(i?" sapSuiteUiCommonsNetworkStatusText ":""),x:t.x,y:t.y+n*t.lineSize},close:false,renderManager:s});s.text(t.lines[n].join(" "));s.close("text")}};b.prototype._renderDescription=function(t){t=t||{};t.class=" sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeMultipleLineTitle";var e=t.renderManager;var i={lines:this._aDescriptionLines,maxLineSize:this.getDescriptionLineSize(),lineSize:m.Description.LINESIZE,class:" sapSuiteUiCommonsNetworkNodeDescription ",x:t.x,y:t.y};if(!e){return this._renderMultilineText(i)}i.renderManager=e;this._renderMultilineText(i)};b.prototype._sanitizeTitleLines=function(t){for(var e=0;e<t.length;e++){t[e]=[n(t[e])]}return t};b.prototype._renderMultilineTitle=function(t){t=t||{};var e=t.renderManager;var i=this._sanitizeTitleLines(this._aTitleLines);var s={useCustomStyle:true,lines:i,maxLineSize:this.getTitleLineSize(),lineSize:m.Title.LINESIZE,class:" sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeMultipleLineTitle",x:t.x,y:t.y,trim:this._aTitleLines.length>this.getTitleLineSize()&&this.getTitleLineSize()!==0};if(!e){return this._renderMultilineText(s)}s.renderManager=e;this._renderMultilineText(s)};b.prototype._processHideShowParents=function(t,e,i){var s=this._oGroup&&this._oGroup.getCollapsed();var r=function(t){if(t._bIsHidden){return}var i=false,s;if(t.getKey()!==e){if(t.aChildren.length>0){s=t.aChildren[0]._bIsHidden;t.aChildren.forEach(function(t){if(s!==t._bIsHidden){i=true}});t._oExpandState=i?y.PARTIAL:s?y.COLLAPSED:y.EXPANDED;if(t._oExpandState===y.COLLAPSED){t.$().addClass("sapSuiteUiCommonsNetworkNodeCollapsed")}else{t.$().removeClass("sapSuiteUiCommonsNetworkNodeCollapsed")}if(t._oExpandState===y.PARTIAL){t.$().addClass("sapSuiteUiCommonsNetworkNodePartialCollapsed")}else{t.$().removeClass("sapSuiteUiCommonsNetworkNodePartialCollapsed")}}}};r(this);this.aParents.forEach(function(t){if(!i[t.getKey()]){r(t)}});if(s){if(this._oGroup._bNeedParentProcessing){this._oGroup.aNodes.forEach(function(t){t.aParents.forEach(function(t){if(!i[t.getKey()]){r(t)}})});this._oGroup._bNeedParentProcessing=false}}};b.prototype._getAllChildren=function(t,e,i){var s=function(t){if(!i[t]){i[t]=this;return true}return false}.bind(this);if(e===this.getKey()){return}if(this._bIsHidden===t){return}if(!s(this.getKey())){return}if(this._oGroup&&this._oGroup.getCollapsed()){this._oGroup.aNodes.forEach(function(s){s._getAllChildren(t,e,i)})}if(this._oExpandState!==y.COLLAPSED){this.aChildren.forEach(function(s){s._getAllChildren(t,e,i)})}};b.prototype._hideShow=function(t){var e=t?"hide":"show",i;this._bIsHidden=t;this.aLines.forEach(function(e){e._hideShow(t)});this.aParentLines.forEach(function(e){e._hideShow(t)});if(this._oGroup&&!this._oGroup._bIsSwimLane){if(this._oGroup.getCollapsed()){this._oGroup._hideShow(t)}else{i=this._oGroup._hasVisibleNodes();if(i&&!t||!i&&t){this._oGroup._hideShow(t)}}}if(this._isInCollapsedGroup()&&this._isHtml()){return}if(this.$()){this.$()[e]()}};b.prototype._setActionButtonFocus=function(t,e){this.$().removeClass(this.FOCUS_CLASS);this.$().find("."+this.FOCUS_CLASS).removeClass(this.FOCUS_CLASS);var i=e?"addClass":"removeClass";jQuery(t)[i](this.FOCUS_CLASS)};b.prototype._getActionButtonTitle=function(t){if(this.getParent().getRenderType()==="Html"){var e=jQuery(t).attr("title");return N.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+(e?" "+e:"")}else{var i=jQuery(t).find("title")[0];return N.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+(i?" "+i.textContent:"")}};b.prototype._getAccessibilityLabel=function(){var t=this.getTitle();var e=t?t:this.getAltText();var i=N.getText("NETWORK_GRAPH_NODE")+" "+e;if(this._isBox()){this.getVisibleAttributes().forEach(function(t){i+=" "+t.getLabel()+" "+t.getValue()})}if(this.getStatus()&&this.getStatus()!=""){var s=this.getParent();var r=this.getStatus();if(s._oStatuses[r]){i+=" "+N.getText("PF_ARIA_STATUS")+" "+s._oStatuses[r].getTitle()}else{i+=" "+N.getText("PF_ARIA_STATUS")+" "+this.getStatus()}}if(this.getSelected()){i+=" "+N.getText("NETWORK_GRAPH_SELECTED_NODE")}return i};b.prototype._setStatusColors=function(t){var i=function(i,o){if(o&&i){var n=this._getColor(e.ColorType[t+"Content"],o),a=s?"color":"fill";jQuery(i).css(a,n||r)}}.bind(this);var s=this.getParent()&&this.getParent()._isUseNodeHtml();if(this._hasCustomStatus()){var r=this._getColor(e.ColorType[t+"Content"]),o=this._getColor(e.ColorType[t+"Background"]),n=this._getColor(e.ColorType[t+"Border"]);var a=t==="Selected"||t==="Hover";if(!s){var h=this.$("innerBox"),l=d?this.$("statusCircle"):this.$("innerStatusBox"),d=this._isCircle();l.css(d?"stroke":"fill",a?"none":o);h.css("fill",a?o:"");h.css("stroke",n);this.$().find(".sapSuiteUiCommonsNetworkStatusText").css("fill",r);this.$("focusCircle").css("stroke",this._getColor(e.ColorType[t+"Focus"]))}else{var p=this.$("wrapper"),u=this.$().find(".sapSuiteUiCommonsNetworkGraphDivNodeTitleText");p.css("border-color",n);this.$("focus").css("border-color",this._getColor(e.ColorType[t+"Focus"]));if(this._isBox()){this.$().find(".sapSuiteUiCommonsNetworkGraphDivNodeText").css("color",r);this.$("header").css("background-color",a&&!o?"":o);u.css("color",a?r:this._getColor(e.ColorType.HeaderContent));p.css("background-color",a&&o?o:"")}else{this.$("status").css("border-color",o);p.css("background-color",a&&o?o:"");this.$().find(".sapSuiteUiCommonsNetworkGraphDivNodeCircleIcon").css("color",r)}}}this.getAttributes().forEach(function(t){if(t&&t.getVisible()){var e=t.getLabelStatus(),s=t.getValueStatus();if(e){i(t.$("icon"),e);i(t.$("label"),e)}if(s){i(t.$("value"),s)}}})};b.prototype._setNodeOpacity=function(t){if(this._isCircle()){this.$("wrapper").css("opacity",t?.3:"");this.$().find(".sapSuiteUiCommonsNetworkGraphDivNodeTitleText").css("opacity",t?.3:"");if(t){this.$("wrapperwithbuttons").append(jQuery("<div></div>",{class:"sapSuiteUiCommonsNetworkGraphDivInnerCloned sapSuiteUiCommonsNetworkGraphDivInner"}))}else{this.$("wrapperwithbuttons").find(".sapSuiteUiCommonsNetworkGraphDivInnerCloned").detach()}return}this.$().css("opacity",t?.3:"")};b.prototype._getContentRect=function(){var t=this._getCirclePosition(),e=this._isCircle();var i=e?t.x:this.getX(),s=e?t.y:this.getY(),r=e?this._iCircleSize:this._iHeight,o=e?this._iCircleSize:this._iWidth;return{p1:{x:i,y:s},p2:{x:i+o,y:s+r}}};b.prototype._setFocus=function(t){e.prototype._setFocus.apply(this,arguments);var i=t?"Selected":"";this.$("focus").css("border-color",this._getColor(e.ColorType[i+"Focus"]))};b.prototype.getHeaderCheckbox=function(){return this._getHeaderCheckbox()};b.prototype.computeTextDimensions=function(t){var e=this.getDomRef(),i,s,r;if(e){i=this._createElement("text",t.attributes);e.appendChild(i);try{s=this._createLineText(t.text,t.width,i,t.maxLines);r=i.getBBox().height}catch(t){}jQuery(i).detach();return{text:s,lineHeight:r}}};b.prototype.renderText=function(t){var e=16;var i=t.lines;if(!i){if(t.text){i=[t.text.split(" ")]}else{return""}}if(t&&t.renderManager){var s=t.renderManager;for(var r=0;r<i.length;r++){this._renderText({attributes:Object.assign({x:t.x+this.getX(),y:this.getY()+t.y+r*(t.lineSize||e)},t.attributes),close:false,renderManager:s});s.text(i[r].join(" "));s.close("text")}}else{var o="";for(var n=0;n<i.length;n++){o+=this._renderText({attributes:Object.assign({x:t.x+this.getX(),y:this.getY()+t.y+n*(t.lineSize||e)},t.attributes),close:false});o+=i[n].join(" ");o+="</text>"}return o}};b.prototype.renderIcon=function(t){t.attributes=t.attributes||{};Object.assign(t.attributes,{"font-family":"SAP-icons"});t.attributes.x=this.getX()+(t.x||0);t.attributes.y=this.getY()+(t.y||0);if(t&&t.renderManager){return this._renderIcon({attributes:t.attributes,icon:t.icon,renderManager:t.renderManager})}return this._renderIcon({attributes:t.attributes,icon:t.icon})};b.prototype.renderHtmlIcon=function(t,e){if(e&&e.renderManager){this._renderHtmlIcon(t,"sapSuiteUiCommonsNetworkGraphDivNodeIcon",null,null,null,e.renderManager)}else{return this._renderHtmlIcon(t,"sapSuiteUiCommonsNetworkGraphDivNodeIcon")}};b.prototype.renderHtmlActionButtons=function(t){t=t||{};var e=this._getElementId(t.idSufix)+"-rightdivbuttons",i=this._getElementId(t.idSufix)+"-leftdivbuttons",s=t.renderManager;s.openStart("div").attr("id",i).class("sapSuiteUiCommonsNetworkGraphDivActionButtons").class("sapSuiteUiCommonsNetworkGraphDivActionButtonsLeft").openEnd().close("div");s.openStart("div").attr("id",e).class("sapSuiteUiCommonsNetworkGraphDivActionButtons").class("sapSuiteUiCommonsNetworkGraphDivActionButtonsRight").openEnd().close("div")};b.prototype.renderHtmlInfoIcon=function(t,e){return this._renderHtmlInfoIcon(t,e)};b.prototype.renderContent=function(t){return this._isHtml()?this._renderHtmlContent(t):this._renderSvgContent(t)};b.prototype.renderItemContent=function(t){if(this._isHtml()){return this._isBox()?this._renderHtmlBoxContent(t):this._renderHtmlCircleContent(t)}return this._isBox()?this._renderBoxContent(t):this._renderCircleContent(t)};b.prototype.calculateSizes=function(){this._setupMaxWidth();this._createMultilineTitle();this._createDescription();this._resetDimensions();this._applyMaxWidth()};b.prototype.renderElement=function(t,e,i){if(e&&e.renderManager){return this._renderControl(t,e,i,e.renderManager)}return this._renderControl(t,e,i)};b.prototype.renderStatusIcon=function(t){if(t&&t.renderManager){return this._renderInfoIcon(this.getX()+t.x,this.getY()+t.y,t.size,t.iconSize,t.renderManager)}return this._renderInfoIcon(this.getX()+t.x,this.getY()+t.y,t.size,t.iconSize)};b.prototype.setSize=function(t){if(t){if(t.width){this._iWidth=t.width}if(t.height){this._iHeight=t.height}if(t.titleHeight){this._iTitleHeight=t.titleHeight}}};b.prototype.hasVisibleActionButtons=function(){return this.$("actionButtons").hasClass(this.VISIBLE_ACTIONS_BUTTONS_CLASS)||this.$().find(".sapSuiteUiCommonsNetworkGraphDivActionButtons").hasClass(this.VISIBLE_ACTIONS_BUTTONS_CLASS)};b.prototype.getEnabledActionButtons=function(){return this.$().find(".sapSuiteUiCommonsNetworkNodeActionButton, .sapSuiteUiCommonsNetworkGraphDivActionButton:not(.sapSuiteUiCommonsNetworkGraphDivActionButtonDisabled)").parent().toArray()};b.prototype.showActionButtons=function(t){if(!this.getParent()){return}var e,i,s=this,r=0,o=0,n=this.getParent()._bIsRtl,a,h,l,d,p,u,g;if(this._isHtml()){this._showDivActionButtons(t);return}var _=function(){var t=this.getParent()._bIsRtl?-m.ActionButtons.RADIUS-m.ActionButtons.MARGIN:m.ActionButtons.RADIUS+m.ActionButtons.MARGIN,i=m.ActionButtons.RADIUS,s=[[t,i]];for(var r=1;r<e;r++){s.push([t,i+m.ActionButtons.RADIUS*2*r+m.ActionButtons.OFFSET*r])}return s}.bind(this);var f=function(){var t=this.getActionButtons().length;if(this.getShowExpandButton()){t++}if(this.getShowDetailButton()){t++}if(this.getShowActionLinksButton()){t++}return t}.bind(this);var C=function(t){var e=13,i=2,s=t.position&&t.position===c.Left,h=s&&!n||!s&&n;t.x=t.x+(h?d:l);var p={cx:t.x,cy:t.y,id:t.id+"-circle",class:"sapSuiteUiCommonsNetworkNodeActionButton",r:m.ActionButtons.RADIUS},u={class:"sapSuiteUiCommonsNetworkGraphIcon sapSuiteUiCommonsNetworkNodeActionIcon "+(t.class?t.class:""),x:t.x,y:t.y},g,_,f,C,S,y;if(!t.enable){p.class="sapSuiteUiCommonsNetworkNodeActionButtonDisabledBackground";a.appendChild(this._createElement("circle",p));p.class="sapSuiteUiCommonsNetworkNodeActionButtonDisabled";u.class+=" sapSuiteUiCommonsNetworkNodeActionButtonDisabled"}S=this._createElement("g",{id:t.id});g=this._createElement("circle",{id:t.id+"-circle",cx:t.x,cy:t.y,r:m.ActionButtons.RADIUS-i,class:"sapSuiteUiCommonsNetworkActionButtonFocusCircle"});f=this._createElement("circle",p);C=this._createIcon(u,t.icon,e);if(t.title){_=this._createElement("title");_.textContent=t.title;f.appendChild(_)}S.appendChild(f);S.appendChild(C);S.appendChild(g);a.appendChild(S);y=jQuery(f);if(t.enable){y.on("click",function(){this._setActionButtonFocus(S,true);this._setFocus(false);if(this.getParent()){this.getParent().setFocus({item:this,button:S})}}.bind(this));jQuery(f).on("click",t.click)}s?o++:r++;return{icon:C,wrapper:f}}.bind(this);e=f();i=_();if(e===0){return}if(t&&!this._bActionButtonsRendered){p=this.getY();if(this._isCircle()){l=this.getX()+(this._iWidth/2+this._iCircleSize/2);d=this.getX()+(this._iWidth/2-this._iCircleSize/2)}else{l=this.getX()+this._iWidth;d=this.getX()}var a=this.$("actionButtons")[0];if(!a){a=this._createElement("g",{class:"sapSuiteUiCommonsNetworkNodeActionButtonWrapper",id:this._getDomId("actionButtons")})}else{jQuery(a).children().remove()}if(this.getParent()._isUseNodeHtml()){this.getParent().$("actiionbuttons")[0].appendChild(a)}else{this.$()[0].appendChild(a)}if(this.getShowExpandButton()){h=C({x:i[r][0],y:p+i[r][1],icon:this._getExpandIcon(true),class:"sapSuiteUiCommonsNetworkNodeActionCollapseIcon",enable:this._hasVisibleChildren(),title:N.getText("NETWORK_GRAPH_EXPAND_COLLAPSE"),id:this._getDomId("actionCollapse"),click:this._expandClick.bind(this)});this._expandIcon=h.icon}if(this.getShowDetailButton()){var y=this.getTitle();u=C({x:i[r][0],y:p+i[r][1],icon:"sap-icon://menu2",enable:this._hasDetailData()||(y?y:this.getAltText()),id:this._getDomId("actionDetail"),title:N.getText("NETWORK_GRAPH_NODE_DETAILS"),click:function(){this._detailClick(u.wrapper)}.bind(this)})}if(this.getShowActionLinksButton()){g=C({x:i[r][0],y:p+i[r][1],icon:"sap-icon://chain-link",enable:this._hasActionLinks(),title:N.getText("NETWORK_GRAPH_NODE_LINKS"),id:this._getDomId("actionLinks"),click:function(){this._linksClick(g.wrapper)}.bind(this)})}for(var T=0;r+o<S*2&&T<this.getActionButtons().length;T++){(function(t){var e=t.getPosition(),s=e===c.Right?r:o;if(s>=S){e=e===c.Left?c.Right:c.Left;s=e===c.Right?r:o}var n=C({x:i[s][0],y:p+i[s][1],icon:t.getIcon(),title:t.getTitle(),id:t.getId(),click:function(e){t.firePress({buttonElement:n.wrapper})},enable:t.getEnabled(),position:e})})(this.getActionButtons()[T])}this._bActionButtonsRendered=true}else if(this._expandIcon){this._expandIcon.textContent=s._getExpandIcon();this.$().find("."+this.FOCUS_CLASS).removeClass(this.FOCUS_CLASS)}var v=t?"addClass":"removeClass";this.$("actionButtons")[v](this.VISIBLE_ACTIONS_BUTTONS_CLASS)};b.prototype.getChildNodes=function(){this._checkForProcessData();return this.aChildren};b.prototype.getChildLines=function(){this._checkForProcessData();return this.aLines};b.prototype.getParentNodes=function(){this._checkForProcessData();return this.aParents};b.prototype.getParentLines=function(){this._checkForProcessData();return this.aParentLines};b.prototype.isHidden=function(){return this._bIsHidden};b.prototype.setHidden=function(t){var e=this;var i=function(i){i.forEach(function(i){var s=i.getFromNode()===e?i.getToNode():i.getFromNode();i.setHidden(t||s.isHidden())})};i(this.getChildLines());i(this.getParentLines());this.$()[t?"hide":"show"]();this._bIsHidden=t;if(this._oGroup){this._oGroup.setHidden(!this._oGroup._hasVisibleNodes())}};b.prototype.getCenterPosition=function(){var t,e;if(this._isBox()){return{x:this.getX()+this._iWidth/2,y:this.getY()+this._iHeight/2}}t=this._getCirclePosition();e=this._getCircleSize()/2;return{x:t.x+e,y:t.y+e}};b.prototype.setHeaderCheckBoxState=function(t){this._setHeaderCheckBoxState(t);return this};b.prototype.setX=function(t){this.setProperty("x",t,true);return this};b.prototype.setY=function(t){this.setProperty("y",t,true);return this};b.prototype.setSelected=function(t){var e=this.getParent(),i=t?"addClass":"removeClass",s=this.getKey();this.setProperty("selected",t,true);if(e){this._setStatusColors(t?"Selected":"");this.$()[i](this.SELECT_CLASS);if(t){e._mSelectedNodes[s]=this}else{delete e._mSelectedNodes[s]}}return this};b.prototype.setCollapsed=function(t){var e={},i,s,r=t?"addClass":"removeClass",o=this.$().find(".sapSuiteUiCommonsNetworkGraphDivActionButtons, .sapSuiteUiCommonsNetworkNodeActionButtonWrapper").find(".sapSuiteUiCommonsNetworkNodeActionCollapseIcon");this.setProperty("collapsed",t,true);this._oExpandState=t?y.COLLAPSED:y.EXPANDED;this.aChildren.forEach(function(i){i._getAllChildren(t,this.getKey(),e)},this);i=Object.keys(e);i.forEach(function(i){e[i]._hideShow(t,this.getKey())},this);i.forEach(function(i){e[i]._processHideShowParents(t,this.getKey(),e)},this);this.aLines.forEach(function(e){e._hideShow(t)});if(o[0]){o[0].textContent=this._getExpandIcon()}this.$().removeClass("sapSuiteUiCommonsNetworkNodePartialCollapsed");this.$()[r]("sapSuiteUiCommonsNetworkNodeCollapsed");s=this.getParent();if(s){s._setupKeyboardNavigation();if(t&&!(s.getFocus()&&s.getFocus().item===this)){s.setFocus({item:this})}}return this};b.prototype.setGroup=function(t){this.setProperty("group",t,true);this._invalidateParent();return this};b.prototype.setShape=function(t){this.setProperty("shape",t,true);this._invalidateParent();return this};b.prototype.setWidth=function(t){this.setProperty("width",t,true);if(this.getParent()&&this.getParent()._bPreventInvalidation){this._iWidth=t}else{this._iWidth=0}this._invalidateParent();return this};b.prototype.setHeight=function(t){this.setProperty("height",t,true);if(this.getParent()&&this.getParent()._bPreventInvalidation){this._iHeight=t}else{this._iHeight=0}this._invalidateParent();return this};b.prototype.setMaxWidth=function(t){this.setProperty("maxWidth",t,true);this._invalidateParent();return this};b.prototype.setTitleLineSize=function(t){this.setProperty("titleLineSize",t,true);this._invalidateParent();return this};b.prototype.addAttribute=function(){e.prototype.addAttribute.apply(this,arguments);this._invalidateParent();return this};b.prototype.insertAttribute=function(){e.prototype.insertAttribute.apply(this,arguments);this._invalidateParent();return this};b.prototype.removeAllAttributes=function(){e.prototype.removeAllAttributes.apply(this,arguments);this._invalidateParent();return this};b.prototype.removeAttribute=function(){e.prototype.removeAttribute.apply(this,arguments);this._invalidateParent();return this};b.prototype.addAttribute=function(){e.prototype.addAttribute.apply(this,arguments);this._invalidateParent();return this};b.prototype.insertAttribute=function(){e.prototype.insertAttribute.apply(this,arguments);this._invalidateParent();return this};b.prototype.removeAllAttributes=function(){e.prototype.removeAllAttributes.apply(this,arguments);this._invalidateParent()};b.prototype.removeAttribute=function(){e.prototype.removeAttribute.apply(this,arguments);this._invalidateParent()};b.prototype.getHeaderCheckBoxState=function(){if(this.getProperty("headerCheckBoxState")===g.Hidden){return g.Hidden}return this.getHeaderCheckbox().getSelected()?g.Checked:g.Unchecked};b.prototype._hasAdditionalContent=function(){return this._displayAttributes()||this._displayDescription()||this.getContent()};b.prototype._hasHeaderContent=function(){return this.getIcon()||this.getTitle()||this.getImage()};b.hasNativeLineClamp=typeof document.documentElement.style.webkitLineClamp!="undefined"&&r.browser.chrome;b.prototype._invalidateParent=function(){var t=this.getParent();if(t){t.invalidate()}};b.prototype._isIgnored=function(){var t=this.getParent(),e=t&&t._isSwimLane(),i=this._isInCollapsedGroup();if(e&&this._isHtml()){i=false}return i||this._isInIgnoredGroup()||!this._useInLayout()};b.prototype._getImageSize=function(){var t=function(t,e){return{width:t?parseInt(t,10):0,height:e?parseInt(e,10):0}};var e=this._isBox()?"Box":"Circle",i=this.getImage();if(!this._displayImage(i)){return t()}return t(i.getWidth()?i.getWidth():m.Image[e],i.getHeight()?i.getHeight():m.Image[e])};b.prototype._displayImage=function(t){t=t||this.getImage();return t&&t.getSrc()};b.prototype._isHtml=function(){return this.getParent()&&this.getParent()._isUseNodeHtml()};b.prototype._isInCollapsedGroup=function(){return this._oGroup&&this._oGroup._isCollapsed()};b.prototype._isInIgnoredGroup=function(){return this._oGroup&&this._oGroup._isIgnored()};b.prototype._displayAttributes=function(){return this.getVisibleAttributes().length!==0&&this._isBox()};b.prototype._displayDescription=function(){return this.getDescriptionLineSize()!==-1&&this.getDescription()};b.prototype._hasTitle=function(){return this.getTitle()||this.getIcon()};b.prototype._isBox=function(){return this.getShape()===u.Box&&this.getParent()._isLayered()};b.prototype._isCircle=function(){return this.getShape()===u.Circle};b.prototype._isCustom=function(){return this.getShape()===u.Custom};b.prototype._hasChildren=function(){return this.aChildren.length>0};b.prototype._showHeaderCheckBox=function(){return this.getHeaderCheckBoxState()!==g.Hidden&&this._isBox()};b.prototype._hasVisibleChildren=function(){return this.aChildren.some(function(t){return!(t._oGroup&&!t._oGroup.getVisible())&&t.getVisible()})};b.prototype._hasDetailData=function(){return this.getDescription()||this.getAttributes().length>0};b.prototype._hasActionLinks=function(){return this.getActionLinks().some(function(t){return t.getVisible()})};b.prototype._useAutomaticSize=function(){return!this.getWidth()&&this.getMaxWidth()>0};b.prototype._getShapeSize=function(t){if(this._isCircle()){return this._getCircleSize()}var e=this._isCustom()?this.getCoreNodeSize():0;return e||(t?this._iWidth:this._iHeight)};b.prototype._getCircleSize=function(){return this._isBox()?undefined:this._iCircleSize};b.prototype._hasMultiLineTitle=function(){return this._aTitleLines&&this._aTitleLines.length>1};b.prototype._getCirclePosition=function(){return this._isBox()?undefined:{x:this.getX()+(this._iWidth-this._getCircleSize())/2,y:this.getY()}};b.prototype._isOnScreen=function(t,i,s,r){var o=this.getX(),n=this.getY();return e._isRectOnScreen(o,o+this._iWidth,n,n+this._iHeight,t,i,s,r)};b.prototype.getFocusDomRef=function(){return this.getDomRef("wrapper")};b.prototype.setVisible=function(t){this.setProperty("visible",t);var e=this.getParent();if(e&&e._bIsLayedOut){this.getParentNodes().forEach(function(t){t._bActionButtonsRendered=false})}return this};b.prototype.setStatusIcon=function(t){var e=this.$("statusicon")[0],i=s.getIconInfo(t),r=i&&i.content;this.$("statusiconwrapper")[t?"addClass":"removeClass"]("sapSuiteUiCommonsNetworkNodeInfoWrapperCustomIcon");e&&(e.textContent=r);this.setProperty("statusIcon",t,true);return this};return b});
//# sourceMappingURL=Node.js.map