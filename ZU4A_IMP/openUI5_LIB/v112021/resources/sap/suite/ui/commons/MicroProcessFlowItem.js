sap.ui.define(["sap/ui/thirdparty/jquery","./library","sap/ui/core/library","sap/ui/core/Control","sap/suite/ui/commons/MicroProcessFlow","sap/ui/core/Lib"],(function(jQuery,e,t,s,o,i){"use strict";var r=i.getResourceBundleFor("sap.suite.ui.commons"),a={Error:"sap-icon://message-error",None:null,Success:"sap-icon://message-success",Warning:"sap-icon://message-warning",Information:"sap-icon://message-information"},n=t.ValueState,c=s.extend("sap.suite.ui.commons.MicroProcessFlowItem",{metadata:{library:"sap.suite.ui.commons",properties:{key:{type:"string",group:"Misc",defaultValue:null},icon:{type:"string",group:"Appearance",defaultValue:null},title:{type:"string",group:"Misc",defaultValue:null},state:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:n.Standard},showIntermediary:{type:"boolean",group:"Appearance",defaultValue:!1},stepWidth:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:null},showSeparator:{type:"boolean",group:"Appearance",defaultValue:!0}},aggregations:{customControl:{type:"sap.ui.core.Control",multiple:!1,singularName:"customControl"},intermediary:{type:"sap.ui.core.Control",multiple:!1,singularName:"intermediary"}},events:{press:{allowPreventDefault:!0,parameters:{item:"object"}}}},onBeforeRendering:function(){this.$("item").off("touchstart click")},onAfterRendering:function(){this._setupEvents(),this._setAccessibility()},renderer:{apiVersion:2,render:function(e,t){var s=function(){var s=t.getIntermediary();e.openStart("div"),e.class("sapSuiteUiCommonsMicroProcessFlowItemIntermediary"),e.openEnd(),s?e.renderControl(s):(e.openStart("div"),e.class("sapSuiteUiCommonsMicroProcessFlowItemOnHoldElement"),e.openEnd(),e.close("div")),e.close("div")},o=t.getIcon()||t._getIconByState(),i=t.getParent()._isLastItem(t),r=t.getId(),a=t.getShowIntermediary(),n=t.getCustomControl(),c=t.getTitle();e.openStart("div",t),e.class("sapSuiteUiCommonsMicroProcessFlowItemWrapper"),e.openEnd(),e.openStart("div"),e.attr("id",r+"-item"),c&&e.attr("title",c),e.class("sapSuiteUiCommonsMicroProcessFlowItemContent"),e.openEnd(),n?e.renderControl(n):(e.openStart("div"),e.attr("id",r+"-itemContent"),e.attr("tabindex","0"),e.class("sapSuiteUiCommonsMicroProcessFlowItem").class("sapSuiteUiCommonsMicroProcessFlowItem"+t.getState()),e.attr("aria-label",t._getAriaText()),e.attr("role","option"),e.attr("aria-selected","false"),e.openEnd(),o&&e.renderControl(new sap.ui.core.Icon({tooltip:t.getTitle(),src:o}).addStyleClass("sapSuiteUiCommonsMicroProcessFlowItemIcon")),e.close("div")),e.close("div"),i&&!a||(e.openStart("div"),e.attr("id",t.getId()+"-separator"),e.class("sapSuiteUiCommonsMicroProcessFlowItemSeparatorWrapper"),e.style("width",t._getStepWidth()),e.openEnd(),e.openStart("div"),e.class("sapSuiteUiCommonsMicroProcessFlowItemSeparator"),t.getShowSeparator()&&!i||e.class("sapSuiteUiCommonsMicroProcessFlowItemHiddenSeparator"),e.openEnd(),e.close("div"),a&&s(),e.close("div")),e.close("div")}}});return c.prototype.getFocusDomRef=function(){var e=this.getCustomControl();return e?e.getFocusDomRef():this.getDomRef("itemContent")},c.prototype._setAccessibility=function(){var e=this._getAccessibleItem(),t=this._getAriaText();"0"!==e.attr("tabindex")&&e.attr("tabindex",0),e.attr("aria-label",t),e.attr("role","option"),e.attr("aria-posinset",this._iIndex),e.attr("aria-setsize",this._iItemsCount)},c.prototype._getAccessibleItem=function(){var e=jQuery(this.getFocusDomRef());return"0"===e.attr("tabindex")?e:this.$("item")},c.prototype._setupEvents=function(){var e=this.$("item"),t=this.hasListeners("press");e.on("touchstart click",this._click.bind(this)),t&&(e.on("mousedown",(function(e){jQuery(this).addClass("sapSuiteUiCommonsMicroProcessFlowItemPressed")})),e.on("mouseup",(function(e){jQuery(this).removeClass("sapSuiteUiCommonsMicroProcessFlowItemPressed")}))),t&&(e.css("cursor","pointer"),e.attr("role","button"),e.attr("aria-hidden","true"))},c.prototype._getAriaText=function(){var e=r.getText("MICRO_PROCESS_FLOW_ITEM");switch(this.getState()){case n.Error:e+=" - "+r.getText("MICRO_PROCESS_FLOW_ERROR");break;case n.Warning:e+=" - "+r.getText("MICRO_PROCESS_FLOW_WARNING");break;case n.Success:e+=" - "+r.getText("MICRO_PROCESS_FLOW_SUCCESS");break;case n.Information:e+=" - "+r.getText("MICRO_PROCESS_FLOW_INFORMATION")}return this.getTitle()&&(e+=" - "+this.getTitle()),e},c.prototype._isCompact=function(){return jQuery("body").hasClass("sapUiSizeCompact")||this.$().is(".sapUiSizeCompact")||this.$().closest(".sapUiSizeCompact").length>0},c.prototype._getStepWidth=function(){var e=this.getStepWidth();return e||(e=this._isCompact()?"1rem":"1.5rem"),e},c.prototype._setAccessibilityData=function(e,t){this._iIndex=e,this._iItemsCount=t},c.prototype._click=function(e){var t=this.getParent();t&&(t._bKeyBoard=!1),this._firePress(e)},c.prototype._firePress=function(e){this.hasListeners("press")&&(this.firePress({item:this.getFocusDomRef()}),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation());var t=document.getElementsByClassName("sapSuiteMicroProcessFlowItemSelected")[0],s=this._getAccessibleItem()[0];t&&(t.setAttribute("aria-selected",!1),t.classList.remove("sapSuiteMicroProcessFlowItemSelected")),"0"==s.tabIndex&&(s.setAttribute("aria-selected",!0),s.classList.add("sapSuiteMicroProcessFlowItemSelected"))},c.prototype._getIconByState=function(){return a[this.getState()]},c}));