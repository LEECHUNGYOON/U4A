sap.ui.define(["sap/base/util/ObjectPath","sap/ushell/ui/footerbar/AddBookmarkButton","sap/suite/ui/commons/collaboration/ServiceContainer","sap/ui/core/CustomData","sap/ui/performance/trace/FESRHelper","sap/ui/core/Component","sap/ui/core/Lib","sap/suite/ui/generic/template/lib/AdaptiveCardHelper"],function(e,t,r,a,i,n,s,o){"use strict";var u={};var l;var p;function c(){if(s.isLoaded("sap.ushell")){var e=sap.ui.require("sap/ushell/Container");return e?new Promise(function(t){e.getFLPUrlAsync(true).done(function(e){t(e)})}):Promise.resolve(document.URL)}return Promise.resolve(document.URL)}u.getCurrentUrl=c;u.setStaticShareData=function(t,r){var a=sap.ui.getCore().getLibraryResourceBundle("sap.m");r.setProperty("/emailButtonText",a.getText("SEMANTIC_CONTROL_SEND_EMAIL"));r.setProperty("/jamButtonText",a.getText("SEMANTIC_CONTROL_SHARE_IN_JAM"));var i=e.get("sap.ushell.Container.getUser");r.setProperty("/jamVisible",!!i&&i().isJamActive())};u.openJamShareDialog=function(e){c().then(function(t){n.create({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:t,share:e}}}).then(function(e){e.open()})})};u.openSharePopup=function(e,n,s,o){var c;s.onCancelPressed=function(){c.close()};if(o){p=o}e.getDialogFragmentAsync("sap.suite.ui.generic.template.fragments.ShareSheet",s,"share",u.setStaticShareData,true).then(function(e){c=e;var o=c.getModel("share");s.getModelData().then(function(e){o.setData(e,true);var s=2;if(!o.getProperty("/jamVisible")){s=1}r.getServiceAsync().then(function(e){var r={isShareAsCardEnabled:o.getProperty("/bEnableCollaborationShareAsCard")};var u=e.getOptions(r);if(u.length>0){u.forEach(function(e){if(e.subOptions&&e.subOptions.length>1){var t=[];e.subOptions.forEach(function(e){var r=new sap.m.MenuItem({text:e.text,icon:e.icon,press:this.menuItemPress});r.addCustomData(new a({key:"data",value:e}));i.setSemanticStepname(r,"press",e.fesrStepName);t.push(r)}.bind(this));c.insertItem(new sap.m.MenuItem({text:e.text,icon:e.icon,items:t}),s)}else{var r=new sap.m.MenuItem({text:e.text,icon:e.icon,press:this.menuItemPress});r.addCustomData(new a({key:"data",value:e}));i.setSemanticStepname(r,"press",e.fesrStepName);c.insertItem(r,s)}s++}.bind(this))}l=new t;l.setCustomUrl(o.getProperty("/customUrl"));l.setServiceUrl(o.getProperty("/serviceUrl"));l.setTitle(o.getProperty("/title"));l.setSubtitle(o.getProperty("/subtitle"));l.setTileIcon(o.getProperty("/icon"));l.setDataSource({type:"OData",settings:{odataVersion:"2.0"}});o.setProperty("/tileVisible",l.getEnabled());o.setProperty("/tileIcon",l.getIcon());o.setProperty("/tileText",l.getText());c.openBy(n)}.bind(this))}.bind(this))}.bind(this))};u.menuItemPress=function(){r.getServiceAsync().then(function(e){var t=this.getModel("share");var r="",a="";if(t.getProperty("/subtitle")!==undefined){r=t.getProperty("/appTitle");a=t.getProperty("/title")+(t.getProperty("/subtitle").length>0?" - "+t.getProperty("/subtitle"):"")}else{r=t.getProperty("/title")}var i={url:t.getProperty("/currentUrl"),appTitle:r,subTitle:a,minifyUrlForChat:true,appId:t.getProperty("/appId"),cardId:"",cardManifest:{}};if(this.getCustomData()[0].getValue().key==="COLLABORATION_MSTEAMS_CARD"){if(e.isFeatureFlagEnabled()){var n=p.getOwnerComponent();var s=o.createAdaptiveCard("HeaderInfo",{appTitle:t.getProperty("/objectShellTitle"),objectTitle:t.getProperty("/title"),objectSubtitle:t.getProperty("/subtitle"),url:t.getProperty("/currentUrl"),controller:p,component:n});i.cardManifest=s;var u=new sap.ushell.services.URLParsing;if(u){var l=u.parseShellHash(i.url.substring(i.url.indexOf("#")));i.cardId=l.semanticObject+"_"+l.action}}}e.share(this.getCustomData()[0].getValue(),i)}.bind(this))};u.fireBookMarkPress=function(){l.firePress()};u.getCustomUrl=function(){if(!window.hasher){sap.ui.require("sap/ui/thirdparty/hasher")}var e=window.hasher.getHash();return e?"#"+e:window.location.href};return u});
//# sourceMappingURL=ShareUtils.js.map