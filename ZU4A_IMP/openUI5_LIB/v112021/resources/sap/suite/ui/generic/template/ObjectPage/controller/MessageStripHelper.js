sap.ui.define(["sap/ui/base/Object","sap/base/util/extend","sap/ui/model/Filter","sap/suite/ui/generic/template/lib/MessageStripHelper","sap/suite/ui/generic/template/lib/MessageUtils"],function(e,t,r,i,n){"use strict";function a(e,t,r,a){var s=Object.create(null);var l=t.getOwnerComponent().getModel("ui");l.bindProperty("/editable").attachChange(d);a.registerExternalListener(d);function m(e){var t=s[e];if(!t){t={maxBackendSeverity:-1,customSeverity:-2,waiting:[]};s[e]=t}return t}function g(e,t){var r=m(t);var i=r.implementingHelper.getCurrentCustomMessage();var a=r.technicalMessage;r.technicalMessage=e;if(i&&e){var s=a&&a.message===i.message;var l=n.getSeverityAsNumber(e);var g=n.getSeverityAsNumber(i);var u=s?l<g:l<=g;if(u){return}}var o="";r.implementingHelper.setCustomMessage(e,o)}function u(e,t,r,i){var n=m(t);if(n.implementingHelper){n.customSeverity=-2;if(!e&&n.technicalMessage){e=n.technicalMessage}n.implementingHelper.setCustomMessage(e,r,i)}else{n.waiting.push({message:e,tabKey:r,onClose:i})}}function o(n,a){var s=n.getId();var l=m(s);var g=e.getKeyToPresentationControlHandler(n);var u=!!g;if(!u){g={"":function(){return r.oServices.oPresentationControlHandlerFactory.getPresentationControlHandler(n)}}}l.implementingHelper=new i(g,t,r);if(u){var o=a;e.getInitializationPromise(o).then(function(){l.implementingHelper.setCurrentTab(e.getSelectedKey(o));e.registerKeyChange(n,l.implementingHelper.setCurrentTab)})}else{l.implementingHelper.setCurrentTab("")}l.waiting.forEach(function(e){l.implementingHelper.setCustomMessage(e.message,e.tabKey,e.onClose)});delete l.waiting}function c(e){var t=e.getSource();var r=t.getId();var i=s[r];if(i){i.implementingHelper.onBeforeRebindControl(e)}}function p(e){if(e.maxBackendSeverity!==-1){e.refreshTriggered=true;setTimeout(function(){if(e.refreshTriggered){e.refreshTriggered=false;var t=e.implementingHelper.getCurrentCustomMessage();e.customSeverity=t?n.getSeverityAsNumber(t):-2;e.implementingHelper.refresh()}},0)}}function v(e,t){var r=t.getId();var i=s[r];if(i.refreshTriggered){return false}if(l.getProperty("/editable")){var a=i.implementingHelper.getCurrentCustomMessage();var m=e===a;var g=!m&&e.persistent;if(g){return false}if(!a){return true}var u=n.getSeverityAsNumber(e);if(m){var o=u!==i.customSeverity;if(o){p(i)}return u>=i.maxBackendSeverity}else{if(i.maxBackendSeverity>i.customSeverity){i.maxBackendSeverity=Math.max(i.maxBackendSeverity,u);return true}if(u<=i.customSeverity){i.maxBackendSeverity=Math.max(i.maxBackendSeverity,u);return false}p(i);i.maxBackendSeverity=u;return true}}else{return i.implementingHelper.dataStateFilter(e,t)}}function f(e){if(e.implementingHelper){e.maxBackendSeverity=-1;var t=e.implementingHelper.getCurrentCustomMessage();e.customSeverity=t?n.getSeverityAsNumber(t):-2;e.refreshTriggered=false;e.implementingHelper.refresh()}}function d(){for(var e in s){var t=s[e];f(t)}}function S(e){for(var t in s){var r=s[t];if(r.implementingHelper&&r.implementingHelper.isCustomMessage(e)){return true}}return false}function y(e){var t=e.getSource();var r=t.getParent();var i=r.getId();var n=s[i];n.implementingHelper.onClose()}return{setCustomMessage:u,initSmartTable:o,onBeforeRebindControl:c,dataStateFilter:v,isCustomMessage:S,onClose:y,setTechnicalMessage:g}}return e.extend("sap.suite.ui.generic.template.listTemplates.controller.MessageStripHelper",{constructor:function(e,r,i,n){t(this,a(e,r,i,n))}})});
//# sourceMappingURL=MessageStripHelper.js.map