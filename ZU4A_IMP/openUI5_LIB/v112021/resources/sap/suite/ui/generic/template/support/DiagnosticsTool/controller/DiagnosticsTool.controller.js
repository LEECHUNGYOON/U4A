sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/m/MessageBox","sap/suite/ui/generic/template/genericUtilities/FeLogger","sap/suite/ui/generic/template/support/lib/Documentation","sap/suite/ui/generic/template/genericUtilities/polyFill"],function(e,t,o,r,a){"use strict";var i=new r("support.DiagnosticsTool.controller.DiagnosticsTool").getLogger();var n=window.diagnosticToolSpace;function s(){this.getView().attachAfterRendering(function(){g()})}function l(){var e=this.getView().getModel("data");if(e.getProperty("/status")==="Loading"){t.show("Application is still loading");return}var o=(new Date).toLocaleTimeString([],{hour12:false,hour:"2-digit",minute:"2-digit",second:"2-digit"});e.setData({properties:null,retrieval:o,copyEnabled:false});e.updateBindings();this.getView().getViewData().plugin.onRefresh()}function c(){var e="\r\n";var r="- ";var i=this.getView().getModel("data").getProperty();if(!(i&&i.properties&&i.url)){o.error("Could not copy data to your clipboard! No data collected",{title:"Error"});return}var n=i.properties;var s="*************+Extracted by SAP Fiori Elements Diagnostics Plugin [FEDiagnostic]+*************"+e;s+=r+"Extracted on "+(new Date).toUTCString()+e;s+=r+"Host: "+i.origin+e;s+=r+"Application status: "+i.status+e;if(i.statusMessage){s+=r+"Notice: "+i.statusMessage+e}s+=r+"Documentation: "+a.getDocuURL()+e;s+=e;s+="APP DATA"+e;for(var l=0,c=n.length;l<c;l++){if(n[l].type==="string"){s+=r+n[l].name+": "+n[l].value+e}else if(n[l].type==="link"){s+=r+n[l].name+": "+n[l].target+e}else if(n[l].type==="group"){s+="Group: "+n[l].name+e}}s+=e;s+="**************************"+e;s+=e;s+=e;s+="PROVIDE"+e;s+=r+"User/Password: <user>/<password>"+e;s+=r+"Steps to recreate the issue: <maybe also provide master data, pictures or video…>"+e;var u=this.getView().byId("CopyDataTextArea").getId();var p=document.getElementById(u);p.style.display="block";p.value=s;p.select();try{var d=document.execCommand("copy");if(d){t.show("Ticket relevant information copied to clip board")}else{o.error("Could not copy data to your clipboard! You can copy it manually from here: "+e+e+s,{title:"Error"})}}catch(t){o.error("Could not copy data to your clipboard! You can copy it manually from here: "+e+e+s,{title:"Error"})}finally{p.style.display="none"}}function u(){var e="<br>",r="</span>"+e,i="<span>",n=i+"- ",s=this.getView().getModel("data").getProperty();if(!(s&&s.properties&&s.url)){o.error("Could not copy data to your clipboard! No data collected",{title:"Error"});return}var l=s.properties,u=document.getElementById(this.getView().byId("CopyDataHTML").getId());var p=i+"*************+Extracted by SAP Fiori Elements Diagnostics Plugin [FEDiagnostic]+*************"+r;p+=n+"Extracted on "+(new Date).toUTCString()+r;p+=n+'Host: <a href="'+s.url+'" rel="noopener noreferrer">'+s.origin+"</a>"+r;p+=n+"Application status: "+s.status+r;if(s.statusMessage){p+=n+"Notice: "+s.statusMessage+r}p+=n+"Documentation: "+'<a href="'+a.getDocuURL()+'" rel="noopener noreferrer">'+a.getDocuURL()+"</a>"+r;p+=e;p+=i+"APP DATA"+r;for(var d=0,g=l.length;d<g;d++){if(l[d].type==="string"){p+=n+l[d].name+": "+l[d].value+r}else if(l[d].type==="link"){p+=n+l[d].name+': <a href="'+l[d].target+'" rel="noopener noreferrer">'+l[d].value+"</a>"+r}else if(l[d].type==="group"){p+=i+"Group: "+l[d].name+r}}p+=i+"**************************"+r;p+=e;p+=i+"PROVIDE"+r;p+=i+"User/Password: &lt;user&gt;/&lt;password&gt;"+r;p+=i+"Steps to recreate the issue: &lt;maybe also provide master data, pictures or video…&gt;"+r;function m(){try{document.getSelection().removeAllRanges()}catch(e){Function.prototype()}}u.innerHTML="";u.insertAdjacentHTML("beforeend",p);try{var f=document.createRange();m();f.selectNode(u);document.getSelection().addRange(f);document.execCommand("copy");m();t.show("Ticket relevant information copied to clip board with HTML format")}catch(e){m();c()}finally{u.innerHTML=""}}function p(){a.openDocumentation()}function d(e){e.parentNode.removeChild(e)}function g(){var e=document.querySelectorAll(".diagnosticPropertiesGroupHeaderContent");if(e.length===0){i.debug("No headers found which should be customized");return}var t,o;for(var r=0;r<e.length;r++){t=e[r];o=t.closest("td");o.classList.add("diagnosticPropertiesGroupHeader");o.colSpan=2;d(o.nextElementSibling)}}function m(e,t){var o=this.getView().getModel("data");o.setData({timeLeft:e,status:t})}function f(){if(n.fioriElementsPluginID){var e=document.getElementById(n.fioriElementsPluginID);if(e&&e.parentElement&&!e.parentElement.classList.contains("sapUiSupportHidden")){t.show("Data refreshed")}}}return e.extend("sap.suite.ui.generic.template.support.DiagnosticsTool.controller.DiagnosticsTool",{onInit:s,onRefreshData:l,onCopyDataPlain:c,onCopyDataHTML:u,onShowDocumentation:p,updateStatus:m,showDataRefreshed:f})});
//# sourceMappingURL=DiagnosticsTool.controller.js.map