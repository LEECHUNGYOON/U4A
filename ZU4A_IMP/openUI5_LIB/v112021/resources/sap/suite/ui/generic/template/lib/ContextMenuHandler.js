sap.ui.define(["sap/ui/base/Object","sap/base/util/extend","sap/suite/ui/generic/template/genericUtilities/controlHelper"],function(e,t,n){"use strict";function r(e,t,r,o){var i=e.getView();var a=i.getModel("_templPriv");var l="/generic/controlProperties/"+i.getLocalId(r.getId());if(!a.getProperty(l)){a.setProperty(l,{})}var u=l+"/contextMenu";var s=u+"/items";a.setProperty(u,{items:[]});var c=t.oServices.oPresentationControlHandlerFactory.getPresentationControlHandler(r);var f=t.oComponentUtils.canNavigateToSubEntitySet(r.getEntitySet());var p;var v=0;function g(e,t,n,r,o,i){v++;var l="ContextMenuKey"+v;if(i){var u=t.length;i.then(function(t){if(t){p[l]=t;a.setProperty(e+"/"+u+"/enabled",true)}})}o=o&&t.length>0;t.push({text:n,icon:r,key:l,enabled:false,startsSection:o})}var d=g.bind(null,s);function b(e,n,i){var a=function(t){return t&&o.executeAction.bind(null,e,n,i)};var l=t.oCommonUtils.getToolbarActionEnablementInfo(n,e.applicableContexts,r);if(l.enabledPromise){return l.enabledPromise.then(a)}return Promise.resolve(a(l.enabled))}function m(e,t,n,r,o,a){var l=i.getLocalId(o.getId());var u=n.find(function(e){return e.ID===l});var s=u?b(t,u,o):null;if(s){g(e,r,o.getText(),o.getIcon(),a,s);return true}return false}function x(e,o){var i=t.oCommonUtils.getToolbarCustomData(r);var a=r.getToolbar();var l=a.getContent();var u=true;l.forEach(function(t){if(!(t.getVisible&&t.getVisible())){return}if(n.isButton(t)){u=!m(s,e,i,o,t,u)&&u}})}function C(e,t){}function E(e){var n={};if(!f||e.applicableContexts.length!==1){return n}var r=e.applicableContexts[0];n.openForEdit=o.getOpenForEdit&&o.getOpenForEdit(r);if(n.openForEdit){return n}n.open=C.bind(null,r,0);var i=t.oServices.oApplication.getDraftInfoForContext(r);n.openExpad=!i.bIsDraft&&C.bind(null,r);return n}function P(e){var n=c.getFocusInfoForContextMenuEvent(e);p=Object.create(null);var r=[];x(n,r);var o=E(n);if(o.openExpad1){d(r,t.oCommonUtils.getText("ST_OPEN_NEW_TAB"),null,true,Promise.resolve(o.openExpad.bind(null,1)));d(r,t.oCommonUtils.getText("ST_OPEN_NEW_WINDOW"),null,false,Promise.resolve(o.openExpad.bind(null,2)))}return r}function y(e){var t=P(e);a.setProperty(u+"/items",t);if(t.length===0){e.preventDefault()}}function I(e){var t=e.getSource().getKey();var n=p[t];n()}return{beforeOpenContextMenu:y,onContextMenu:I}}return e.extend("sap.suite.ui.generic.template.lib.ContextMenuHandler",{constructor:function(e,n,o,i){t(this,r(e,n,o,i))}})});
//# sourceMappingURL=ContextMenuHandler.js.map