/*
 * ! SAPUI5

(c) Copyright 2009-2020 SAP SE. All rights reserved
 */
sap.ui.define(["sap/ui/core/library","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/ui/core/syncStyleClass","sap/ui/core/Fragment","sap/ui/core/Messaging"],function(e,t,r,s,a,n){"use strict";var o=e.ValueState;var i={badRequest:"400",unauthorized:"401",forbidden:"403",notFound:"404",methodNotAllowed:"405",preconditionFailed:"428",internalServerError:"500",notImplemented:"501",badGateway:"502",serviceUnavailable:"503",gatewayTimeout:"504",httpVersionNotSupported:"505"};var u={callAction:"callAction",addEntry:"addEntry",saveEntity:"saveEntity",deleteEntity:"deleteEntity",editEntity:"editEntity",modifyEntity:"modifyEntity",activateDraftEntity:"activateDraftEntity",saveAndPrepareDraftEntity:"saveAndPrepareDraftEntity",getCollection:"getCollection"};var c;function l(e){var t=[],r;var s=n.getMessageModel().getData();var a=[];for(var o=0;o<s.length;o++){r=s[o];var i=r.technicalDetails&&r.technicalDetails.statusCode==="404"&&r.type==="Error";if(r.persistent){if(i){a.push(r)}else{t.push(r)}}}return e?t.concat(a):t}function g(e,t){var r;r=function(r,n){var o;var i={onMessageDialogClose:function(){n.onMessageDialogClose();o.destroy()},onActionButtonPressed:function(){n.onActionButtonPressed();o.destroy()}};return a.load({name:r,controller:i}).then(function(r){if(t){s(t,e,r)}e.addDependent(e);return r})};return r}function p(e,s,a){var n=l();var i=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app");if(n.length===0){return Promise.resolve()}f();var u=o.None;for(var c=0;c<n.length&&u!==o.Error;c++){var p=n[c];switch(p.type){case sap.ui.core.MessageType.Error:u=o.Error;break;case sap.ui.core.MessageType.Warning:u=o.Warning;break;case sap.ui.core.MessageType.Success:if(u===sap.ui.core.ValueState.None){u=o.Success}break;default:break}}if(n.length===1&&(u===o.Success||u===o.None)){r.show(n[0].message);return Promise.resolve()}var v=typeof e==="function"?e:g(e.owner,e.contentDensityClass);var d,y,m;var T=function(){d.close();m.setProperty("/backButtonVisible",false);m.setProperty("/messages",[]);m.setProperty("/messageToGroupName",Object.create(null));y.navigateBack();m.getProperty("/resolve")()};var E={onMessageDialogClose:function(){T(m)},onActionButtonPressed:function(){m.getProperty("/actionButtonCallback")();T(m)},onBackButtonPress:function(){m.setProperty("/backButtonVisible",false);y.navigateBack()},onMessageSelect:function(){m.setProperty("/backButtonVisible",true)}};return v("sap.ui.generic.app.fragments.MessageDialog",E).then(function(e){d=e;y=d.getContent()[0];var r=d.getModel();var o=r&&r.getMetaModel();var c=false;var l=!!(a&&a.action);var g=Object.create(null);if(o){n.forEach(function(e){var t=e.getTargets()[0];if(!t){return}if(t.lastIndexOf("/")>0){t=t.substring(0,t.lastIndexOf("/"))}var s=t.substring(1,t.indexOf("("));var a=s&&o.getODataEntitySet(s);var n=a&&o.getODataEntityType(a.entityType);var i=n&&n["com.sap.vocabularies.UI.v1.HeaderInfo"];var u=i&&i.Title&&i.Title.Value&&i.Title.Value.Path;var l=r.getProperty(t);var p=l&&l[u];if(p){g[e.getId()]=p;c=true}})}m=d.getModel("settings");if(!m){m=new t({genericGroupName:i.getText("GENERAL_TITLE"),backButtonVisible:false,cancelButtonText:i.getText("DIALOG_CANCEL"),closeButtonText:i.getText("DIALOG_CLOSE")});d.setModel(m,"settings")}m.setProperty("/showActionButton",l);if(l){m.setProperty("/actionButtonText",a.actionLabel);m.setProperty("/actionButtonCallback",a.action)}m.setSizeLimit(9999);m.setProperty("/title",s||i.getText("DIALOG_TITLE"));m.setProperty("/messages",n);m.setProperty("/grouping",c);m.setProperty("/state",u);m.setProperty("/resolve",function(){return Promise.resolve()});m.setProperty("/messageToGroupName",g);d.open();return null})}function f(){var e=l(true);if(e.length>0){n.removeMessages(e)}}function v(e,t,r){var s=new sap.ui.core.message.Message({message:e,description:t,type:sap.ui.core.MessageType.Error,processor:r,target:"",persistent:true});n.addMessages(s)}function d(e){var t;c=e&&e.url;if(c){c="/"+c.substring(0,c.indexOf(")")+1)}var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app").getText("ERROR_UNKNOWN");var s;if(e instanceof Error){if(e.message){r=e.message}}else if(e.response){if(e.response.message){r=e.response.message}var a=e.response.statusCode;s=!Number.isInteger(a)?Number(a):a;if(e.response.headers){for(var n in e.response.headers){if(n.toLowerCase()==="content-type"){var o=e.response.headers[n];if(o.toLowerCase().indexOf("application/json")===0){if(e.response.responseText){var i=JSON.parse(e.response.responseText);if(i&&i.error&&i.error.message&&i.error.message.value){r=i.error.message.value}}}else if(e.message){r=e.message}break}}}}var u=l();t={httpStatusCode:s,messageText:r,description:null,containsTransientMessage:u.length===0?false:true};return t}return{operations:u,httpStatusCodes:i,handleTransientMessages:p,removeTransientMessages:f,addTransientErrorMessage:v,parseErrorResponse:d,getTransientMessages:l}},true);
//# sourceMappingURL=MessageUtil.js.map