/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){function e(e,t,r){if(r){return t?t(e):e}if(!e||!e.then){e=Promise.resolve(e)}return t?e.then(t):e}function t(e,t){try{var r=e()}catch(e){return t(e)}if(r&&r.then){return r.then(void 0,t)}return r}sap.ui.define(["../error/ErrorHandler","sap/ui/Device","./JsSearchFactory","sap/base/Log","../error/errors","../SearchModel"],function(r,n,i,o,a,u){function l(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}function s(e){"@babel/helpers - typeof";return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}function h(e,t,r){if(t)f(e.prototype,t);if(r)f(e,r);Object.defineProperty(e,"prototype",{writable:false});return e}function p(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}
/*!
   * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	
   */var b=l(r);var g=l(i);var y=a["AppSearchError"];var v=a["ESHUIError"];var d=l(u);var m=function(){function r(){c(this,r);p(this,"logger",o.getLogger("sap.esh.search.ui.appsearch.catalogsearch"));this.errorHandler=new b({model:d.getModelSingleton({},"flp")});this.initPromise=this.initAsync()}h(r,[{key:"initAsync",value:function r(){try{const r=this;if(r.initPromise){return e(r.initPromise)}return e(t(function(){return e(window.sap.ushell.Container.getServiceAsync("SearchableContent"),function(t){return e(t.getApps(),function(e){var t=r.formatApps(e);r.logger.debug("Adding ".concat(t.length," flp apps to the search index"));var i=true;var o=n&&n.browser&&n.browser.msie||false;if(!String.prototype.normalize||o){i=false}r.searchEngine=g.createJsSearch({objects:t,fields:["title","subtitle","keywords"],shouldNormalize:i,algorithm:{id:"contains-ranked",options:[50,49,40,39,5,4,51]}})})})},function(e){var t=new v("FLP SearchableContent Service Failed - App Search won't be available.");t.previous=e;throw t}))}catch(e){return Promise.reject(e)}}},{key:"formatApps",value:function e(t){var r=[];t.forEach(function(e){e.visualizations.forEach(function(e){var t=e.title;if(e.subtitle){t=t+" - "+e.subtitle}r.push({title:e.title||"",subtitle:e.subtitle||"",keywords:e.keywords?e.keywords.join(" "):"",icon:e.icon||"",label:t,visualization:e,url:e.targetURL})})});return r}},{key:"prefetch",value:function e(){}},{key:"search",value:function r(n){try{const r=this;return e(t(function(){return e(r.initAsync(),function(){var e=r.searchEngine.search({searchFor:n.searchTerm,top:n.top,skip:n.skip});var t=[];for(var i=0;i<e.results.length;++i){var o=e.results[i];var a=Object.assign({},o.object);var u=a.title;var l=false;if(s(o.highlighted)==="object"&&o.highlighted){if("title"in o.highlighted&&typeof o.highlighted.title==="string"){u=o.highlighted.title}if("subtitle"in o.highlighted&&typeof o.highlighted.subtitle==="string"){u=u+" - "+o.highlighted.subtitle;l=true}}if(!l&&a.subtitle){u=u+" - "+a.subtitle}a.label=u;t.push(a)}return{totalCount:e.totalCount,tiles:t}})},function(e){var t=new y(e);t.previous=e;r.errorHandler.onError(t);return{totalCount:0,tiles:[]}}))}catch(e){return Promise.reject(e)}}}]);return r}();return m})})();
//# sourceMappingURL=CatalogSearch.js.map