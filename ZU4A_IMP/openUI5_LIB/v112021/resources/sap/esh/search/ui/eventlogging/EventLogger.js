/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){function e(e,n,t){if(t){return n?n(e):e}if(!e||!e.then){e=Promise.resolve(e)}return n?e.then(n):e}function n(){}function t(e){var t=e();if(t&&t.then){return t.then(n)}}function r(e,n){try{var t=e()}catch(e){return n(e)}if(t&&t.then){return t.then(void 0,n)}return t}function i(e){if(e&&e.then){return e.then(n)}}function o(e,n){return e&&e.then?e.then(n):n(e)}sap.ui.define(["sap/base/Log","sap/esh/search/ui/eventlogging/UsageAnalyticsConsumerSina","sap/esh/search/ui/flp/UsageAnalyticsConsumerFlp"],function(n,u,a){function s(e,n){var t=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=c(e))||n&&e&&typeof e.length==="number"){if(t)e=t;var r=0;var i=function(){};return{s:i,n:function(){if(r>=e.length)return{done:true};return{done:false,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o=true,u=false,a;return{s:function(){t=t.call(e)},n:function(){var e=t.next();o=e.done;return e},e:function(e){u=true;a=e},f:function(){try{if(!o&&t.return!=null)t.return()}finally{if(u)throw a}}}}function c(e,n){if(!e)return;if(typeof e==="string")return f(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor)t=e.constructor.name;if(t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return f(e,n)}function f(e,n){if(n==null||n>e.length)n=e.length;for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function l(e,n){if(!(e instanceof n)){throw new TypeError("Cannot call a class as a function")}}function h(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}function v(e,n,t){if(n)h(e.prototype,n);if(t)h(e,t);Object.defineProperty(e,"prototype",{writable:false});return e}function g(e,n,t){if(n in e){Object.defineProperty(e,n,{value:t,enumerable:true,configurable:true,writable:true})}else{e[n]=t}return e}var d=function(){function c(e){l(this,c);g(this,"consumers",[]);g(this,"log",n.getLogger("sap.esh.search.ui.eventlogging.EventLogger"));this.searchModel=e.searchModel;this.sinaNext=e.sinaNext;var t=s(e.eventConsumers),r;try{for(t.s();!(r=t.n()).done;){var i=r.value;this.addConsumer(i)}}catch(e){t.e(e)}finally{t.f()}}v(c,[{key:"initAsync",value:function n(){try{const n=this;return e(o(r(function(){return t(function(){if(n.searchModel.config.isUshell){var t=new a;return e(t.initAsync(),function(){n.addConsumer(t)})}})},function(e){n.log.debug("Couldn't initialize flp user event consumer",e)}),function(){return i(r(function(){var t=new u(n.sinaNext);return e(t.initAsync(),function(){n.addConsumer(t)})},function(e){n.log.debug("Couldn't initialize sina user event consumer",e)}))}))}catch(e){return Promise.reject(e)}}},{key:"addConsumer",value:function e(n){this.consumers.push(n);this.log.debug("[".concat(n.label,"] Event consumer added"))}},{key:"setConsumers",value:function e(n){var t=s(n),r;try{for(t.s();!(r=t.n()).done;){var i=r.value;this.addConsumer(i)}}catch(e){t.e(e)}finally{t.f()}}},{key:"logEvent",value:function e(n){var t;n.sessionId=c.sessionId;n.timeStamp=(t=n.timeStamp)!==null&&t!==void 0?t:(new Date).getTime().toString();n.eventNumber=c.eventNumber++;for(var r=0;r<this.consumers.length;++r){var i=this.consumers[r];try{i.logEvent(n);this.log.debug("[".concat(i.label,"] Logged user event ").concat(n.type))}catch(e){this.log.debug("[".concat(i.label,"] Error while logging user event ").concat(n.type),e.stack||e)}}}}]);return c}();g(d,"eventNumber",0);g(d,"sessionId",(new Date).getTime().toString());return d})})();
//# sourceMappingURL=EventLogger.js.map