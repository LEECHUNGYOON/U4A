/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["../../sina/SearchResultSetItemAttribute","../../sina/SuggestionCalculationMode"],function(e,t){function r(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||false;a.configurable=true;if("value"in a)a.writable=true;Object.defineProperty(e,a.key,a)}}function i(e,t,r){if(t)a(e.prototype,t);if(r)a(e,r);Object.defineProperty(e,"prototype",{writable:false});return e}
/*!
   * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	
   */var s=e["SearchResultSetItemAttribute"];var n=t["SuggestionCalculationMode"];var u=function(){function e(t,a){r(this,e);this.provider=t;this.sina=t.sina;this.itemParser=a}i(e,[{key:"parseObjectSuggestions",value:function e(t,r){if(!r.d.ObjectSuggestions||!r.d.ObjectSuggestions.SearchResults||!r.d.ObjectSuggestions.SearchResults.results){return[]}var a=[];var i=r.d.ObjectSuggestions.SearchResults.results;for(var s=0;s<i.length;++s){var n=i[s];a.push(this.parseObjectSuggestion(n))}return Promise.all(a)}},{key:"parseObjectSuggestion",value:function e(t){return this.itemParser.parseItem(t).then(function(e){this.fillValueHighlighted(e);var t=e.titleAttributes.filter(function(e){return e instanceof s}).map(function(e){return e.valueFormatted}).join(" ");return this.sina._createObjectSuggestion({calculationMode:n.Data,label:t,object:e})}.bind(this))}},{key:"fillValueHighlighted",value:function e(t){var r=function e(t){if(!t){return}for(var r=0;r<t.length;++r){var a=t[r];if(!a.valueHighlighted){a.valueHighlighted=a.valueFormatted}}};r(t.detailAttributes);r(t.titleAttributes)}},{key:"parseRegularSuggestions",value:function e(t,r){var a=[];var i;var s;var n=[];var u;var c;if(!r.d.Suggestions||!r.d.Suggestions.results){return[]}var o=r.d.Suggestions.results;for(var l=0;l<o.length;l++){i=null;u=o[l];switch(u.Type){case"H":i=this.parseSearchTermSuggestion(t,u);break;case"A":i=this.parseSearchTermAndDataSourceSuggestion(t,u);i.cell=u;break;case"M":i=this.parseDataSourceSuggestion(t,u);break}if(i){if(i.type===this.sina.SuggestionType.SearchTermAndDataSource){if(n[i.searchTerm]===undefined){c=this._getParentCell(i.cell);s=this.parseSearchTermSuggestion(t,c);n[i.searchTerm]=s}delete i.cell;n[i.searchTerm].childSuggestions.push(i)}else{a.push(i)}}}Object.keys(n).forEach(function(e){a.push(n[e])});return a}},{key:"parseDataSourceSuggestion",value:function e(t,r){var a=n.Data;var i=this.sina.getDataSource(r.FromDataSource);if(!i){return null}var s=t.filter.clone();s.setDataSource(i);return this.sina._createDataSourceSuggestion({calculationMode:a,dataSource:i,label:r.SearchTermsHighlighted})}},{key:"parseSearchTermSuggestion",value:function e(t,r){var a=this.parseCalculationMode(r.Type);var i=t.filter.clone();i.setSearchTerm(r.SearchTerms);return this.sina._createSearchTermSuggestion({searchTerm:r.SearchTerms,calculationMode:a,filter:i,label:r.SearchTermsHighlighted})}},{key:"parseSearchTermAndDataSourceSuggestion",value:function e(t,r){var a=this.parseCalculationMode(r.Type);var i=t.filter.clone();i.setSearchTerm(r.SearchTerms);var s=this.sina.getDataSource(r.FromDataSource);if(!s){return null}i.setDataSource(s);return this.sina._createSearchTermAndDataSourceSuggestion({searchTerm:r.SearchTerms,dataSource:s,calculationMode:a,filter:i,label:r.SearchTermsHighlighted})}},{key:"parseCalculationMode",value:function e(t){switch(t){case"H":return n.History;case"A":case"M":return n.Data}}},{key:"_getParentCell",value:function e(t){var r=t;r.FromDataSource="<All>";r.FromDataSourceAttribute="";r.Type="A";return r}}]);return e}();var c={__esModule:true};c.SuggestionParser=u;return c})})();
//# sourceMappingURL=suggestionParser.js.map