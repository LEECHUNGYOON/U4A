/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){function e(){}function t(t,r){if(!r){return t&&t.then?t.then(e):Promise.resolve()}}function r(e,t,r){if(r){return t?t(e):e}if(!e||!e.then){e=Promise.resolve(e)}return t?e.then(t):e}function a(e,t){var r=e();if(r&&r.then){return r.then(t)}return t(r)}sap.ui.define(["./SearchHierarchyStaticFacet"],function(e){function i(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function u(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||false;a.configurable=true;if("value"in a)a.writable=true;Object.defineProperty(e,a.key,a)}}function o(e,t,r){if(t)u(e.prototype,t);if(r)u(e,r);Object.defineProperty(e,"prototype",{writable:false});return e}var c=i(e);var f=function(){function e(t){n(this,e);this.model=t;this.facetMap={}}o(e,[{key:"getFacetAttributes",value:function e(t){var r=t.query.filter.dataSource.attributesMetadata;var a=[];for(var i=0;i<r.length;++i){var n=r[i];if(!n.isHierarchy){continue}if(n.hierarchyDisplayType!==t.sina.HierarchyDisplayType.StaticHierarchyFacet){continue}var u=t.sina.getHierarchyDataSource(n.hierarchyName);if(!u){continue}a.push({attributeId:n.id,dataSource:u})}return a}},{key:"getFacet",value:function e(i,n,u,o){try{const e=this;var f=e.facetMap[u.attributeId];return r(a(function(){if(!f){var r=i.query.filter.dataSource.getAttributeMetadata(u.attributeId);f=new c({model:n,attributeId:u.attributeId,dataSource:u.dataSource,filter:n.getProperty("/uiFilter"),title:r.label});e.facetMap[u.attributeId]=f;return t(f.initAsync())}},function(){f.position=o;f.filter=n.getProperty("/uiFilter");f.updateNodesFromHierarchyNodePaths(i.hierarchyNodePaths);return r(f.mixinFilterNodes(),function(){return f})}))}catch(e){return Promise.reject(e)}}},{key:"getFacets",value:function e(t){if(!this.model.config.FF_staticHierarchyFacets){return Promise.resolve([])}var r=this.getFacetAttributes(t);var a=[];for(var i=0;i<r.length;++i){var n=r[i];var u=this.getFacet(t,this.model,n,100+i);a.push(u)}return Promise.all(a)}},{key:"destroy",value:function e(){for(var t in this.facetMap){var r=this.facetMap[t];r["delete"]()}this.facetMap={}}},{key:"handleDataSourceChanged",value:function e(){this.destroy()}}]);return e}();return f})})();
//# sourceMappingURL=SearchHierarchyStaticFacetsFormatter.js.map