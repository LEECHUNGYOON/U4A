sap.ui.define("u4a.util.SessionWorker",["sap/ui/core/Control"],function(a){"use strict";var b=a.extend("u4a.util.SessionWorker",{metadata:{library:"u4a.util",properties:{minute:{type:"int",defaultValue:0},activeWorker:{type:"boolean",defaultValue:!0}},events:{finished:{allowPreventDefault:!0}}},_oWorker:null,_maxMinute:120,init:function(){window.Worker||this._dumpAndThrow("[SessionWorker] This browser does not support Web Worker.")},renderer:function(a,b){a.write("<div"),a.writeControlData(b),a.addStyle("display","none"),a.writeStyles(),a.write("></div>")},_dumpAndThrow:function(a){throw console.error(a),"undefined"!=typeof oU4AErroHandle&&"function"==typeof oU4AErroHandle.seterroHTML&&oU4AErroHandle.seterroHTML(a),new Error(a)},_terminateWorker:function(){if(this._oWorker){try{this._oWorker.terminate()}catch(a){console.warn("[SessionWorker] Worker terminate failed:",a)}this._oWorker=null,console.info("[SessionWorker] Worker terminated.")}},createWorker:function(){var a=this.getMinute();try{this._oWorker=new Worker("/zu4a_imp/publish/CommonJS/workers/SessionWorker.js")}catch(a){this._terminateWorker(),this._dumpAndThrow("[SessionWorker] Worker creation failed: "+a.message)}this._oWorker.onerror=function(a){this._terminateWorker(),this._dumpAndThrow("[SessionWorker] Worker runtime error: "+a.message+" ("+a.filename+":"+a.lineno+")")}.bind(this);try{this._oWorker.postMessage({keeptime:a})}catch(a){this._terminateWorker(),this._dumpAndThrow("[SessionWorker] Failed to post message to Worker: "+a.message)}this._oWorker.onmessage=function(a){"X"===a.data&&this.fireFinished()}.bind(this),console.info("[SessionWorker] Worker started ("+a+" min)")},onAfterRendering:function(){var a=this.getActiveWorker(),b=this.getMinute();return a?(0>b&&(this._terminateWorker(),this._dumpAndThrow("The 'minute' property of the 'SessionWorker' must not be negative.")),0===b)?(this._terminateWorker(),void console.info("[SessionWorker] minute = 0 \u2192 Worker not started.")):void(b>this._maxMinute&&(this._terminateWorker(),this._dumpAndThrow("The 'minute' property of the 'SessionWorker' cannot exceed 120 minutes.")),this._oWorker instanceof Worker||this.createWorker()):void this._terminateWorker()},exit:function(){this._terminateWorker()}});return b});