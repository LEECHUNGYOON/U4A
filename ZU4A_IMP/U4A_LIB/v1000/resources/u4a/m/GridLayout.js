sap.ui.define(["sap/ui/core/Control","u4a/m/GridLayoutRenderer","sap/ui/core/ResizeHandler"],function(a,b,c){"use strict";const d={XL:"XL",L:"L",M:"M",S:"S"};var e=a.extend("u4a.m.GridLayout",{metadata:{library:"u4a.m",properties:{cellPadding:{type:"int",defaultValue:0},cellSpacing:{type:"int",defaultValue:0},colCountS:{type:"int",defaultValue:1},colCountM:{type:"int",defaultValue:1},colCountL:{type:"int",defaultValue:1},colCountXL:{type:"int",defaultValue:1},stretchedHorizontally:{type:"boolean",defaultValue:!1},stretchedVertically:{type:"boolean",defaultValue:!1},flexibleLayout:{type:"boolean",defaultValue:!0},breakpointXL:{type:"int",defaultValue:1440},breakpointL:{type:"int",defaultValue:1024},breakpointM:{type:"int",defaultValue:600},width:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize"}},defaultAggregation:"content",aggregations:{content:{type:"sap.ui.core.Control",multiple:!0,singularName:"content"}}},init:function(){this._resizeHandler=null},exit:function(){this._resizeHandler&&(c.deregister(this._resizeHandler),this._resizeHandler=null)},renderer:b,onAfterRendering:function(){this._resizeHandler&&c.deregister(this._resizeHandler),this._resizeHandler=c.register(this,this._setGridTemplateColumns.bind(this)),this._setGridTemplateColumns()},_setGridTemplateColumns:function(){var a=this.getDomRef("content");if(a){var b=this._calcColumnInfo(),c=this._calculateGridPositions(b),d=this._getGridTemplateColumns(b,c);a.style.gridTemplateColumns=d,this._setContentSpan(b,c)}},_getGridTemplateColumns:function(a,b){var c=`repeat(${a.colCount}, minmax(min-content, max-content))`,d=this.getDomRef();if(!d)return c;var e="minmax(min-content, max-content)";!0===this.getStretchedHorizontally()&&(e="auto");const f=[];for(let c=0;c<a.colCount;c++)f.push({size:e,calcSize:0});const g=d.clientWidth,h=parseFloat(getComputedStyle(document?.documentElement)?.fontSize)||16,i=window.innerWidth,j=window.innerHeight;for(let c=0,d=b.length;c<d;c++){var k=b[c];const a=k.oUi?.getLayoutData?.();if(!a)continue;var l=a?.getWidth?.();if(!l)continue;if(l=(l+"").toLowerCase(),"auto"===l||"inherit"===l)continue;var m=f[k.colPos];let d=l.replace(/[0-9.-]/g,"");var n=+l.replace(/[^0-9.-]/g,"")||0;switch(d){case"rem":n*=h;break;case"em":n*=h;break;case"vw":n=n*i/100;break;case"vh":n=n*j/100;break;case"pt":n*=1.3333;break;case"cm":n*=37.8;break;case"mm":n*=3.78;break;case"in":n*=96;break;case"px":n=n;break;case"%":n=g*(n/100);break;default:}n>m.calcSize&&(m.size=l,m.calcSize=n)}var o=[];for(let c=0,d=f.length;c<d;c++){var p=f[c],q=p.size;if(q===e){o.push(q);continue}q=`minmax(min-content, ${p.size})`,o.push(q)}return 0<o.length&&(c=o.join(" ")),c},_calcColumnInfo:function(){var a={colCount:Math.max(this.getColCountXL(),1),currentBreakPoint:d.XL},b=this.getDomRef()||void 0;if("undefined"==typeof b)return a;if(!0!==this.getFlexibleLayout())return a;var c=b.clientWidth;return c<=this.getBreakpointM()?(a.colCount=Math.max(this.getColCountS(),1),a.currentBreakPoint=d.S,a):c<=this.getBreakpointL()?(a.colCount=Math.max(this.getColCountM(),1),a.currentBreakPoint=d.M,a):c<=this.getBreakpointXL()?(a.colCount=Math.max(this.getColCountL(),1),a.currentBreakPoint=d.L,a):a},_ensureRowExists:function(a){for(;a.gridMap.length<=a.rowIndx;)a.gridMap.push(Array(a.colCount).fill(!1))},_isBlockFree:function(a){for(let c=0;c<a.rowSpan;c++){var b={...a};b.rowIndx+=c,this._ensureRowExists(b);for(let c=0;c<a.colSpan;c++)if(a.gridMap[b.rowIndx][a.colIndx+c])return!1}return!0},_occupyBlock:function(a){for(let c=0;c<a.rowSpan;c++){var b={...a};b.rowIndx+=c,this._ensureRowExists(b);for(let c=0;c<a.colSpan;c++)a.gridMap[b.rowIndx][a.colIndx+c]=!0}},_calculateGridPositions:function(a){const b=[];if(!a.currentBreakPoint)return b;var c={gridMap:[],colCount:a.colCount},d=this.getContent();if(0===d.length)return b;for(const g of d){const d=g.getLayoutData?.();var e=`getColSpan${a.currentBreakPoint}`,f=`getRowSpan${a.currentBreakPoint}`;c.colSpan=d?.[e]?.()||1,c.colSpan=Math.max(c.colSpan,1),c.rowSpan=d?.[f]?.()||1,c.rowSpan=Math.max(c.rowSpan,1),c.colSpan=Math.min(c.colSpan,a.colCount);let h=!1;for(let d=0;!h;d++){c.rowIndx=d,this._ensureRowExists(c);for(let e=0,f=a.colCount-c.colSpan;e<=f;e++)if(c.colIndx=e,!!this._isBlockFree(c)){this._occupyBlock(c),b.push({oUi:g,rowPos:d,colPos:e,colSpan:c.colSpan,rowSpan:c.rowSpan}),h=!0;break}}}return b},_setContentSpan:function(a,b){if(0!==b.length&&a.currentBreakPoint)for(let j=0,k=b.length;j<k;j++){var c=b[j],d=c?.oUi?.getLayoutData?.();if(d){var e=d.getDomRef();if(e){var f=`getColSpan${a.currentBreakPoint}`,g=`getRowSpan${a.currentBreakPoint}`,h=d?.[f]?.()||1;h>a.colCount&&(h=a.colCount);var i=d?.[g]?.()||1;h=`span ${h}`,e.style.gridColumn!==h&&(e.style.gridColumn=h),i=`span ${i}`,e.style.gridRow!==i&&(e.style.gridRow=i)}}}}});return e});