sap.ui.define("u4a.m.Dialog",["sap/ui/core/Control","sap/m/Dialog","sap/m/DialogRenderer"],function(t,a,i){"use strict";return a.extend("u4a.m.Dialog",{metadata:{library:"u4a.m",properties:{fullSizePopup:{type:"boolean",defaultValue:!1},enableOffset:{type:"boolean",defaultValue:!1},rememberPosition:{type:"boolean",defaultValue:!1},offsetX:{type:"int",defaultValue:null},offsetY:{type:"int",defaultValue:null},showHeader:{type:"boolean",group:"Appearance",defaultValue:!0,deprecated:!0},stretch:{type:"boolean",group:"Appearance",defaultValue:!1,deprecated:!0},escapeHandler:{type:"any",group:"Behavior",defaultValue:null,deprecated:!0},closeOnNavigation:{type:"boolean",group:"Behavior",defaultValue:!0,deprecated:!0}},aggregations:{customHeader:{type:"sap.m.IBar",multiple:!1,deprecated:!0}},events:{dialogClose:{allowPreventDefault:!0}}},init:function(){a.prototype.init.apply(this,arguments),this.addStyleClass("u4aMDialog");var t="u4aMDialogCssArea";document.getElementById(t)||$("<style id='"+t+"'></style>").appendTo("head").html(".u4aMDialogOffsetOpen {transform: scale(1) !important;-webkit-transform: scale(1) translateZ(0px) !important;}.u4aMDialogStretchFull {transform: none !important;-webkit-transform: scale(1) translateZ(0px) !important; top: 0%!important;bottom: 0%!important;left: 0%!important;right: 0%!important;max-height: none!important;max-width: none!important;height: auto!important;width: auto!important;min-width: 0!important;min-height: 0!important;}.u4aMDialogStretchFullContent .sapMDialogSection {height: 100% !important;}.u4aMDialog {}.u4aMDialog .sapMDialogScroll {height: 100%;}")},onBeforeRendering:function(){a.prototype.onBeforeRendering.apply(this,arguments),this._setHeaderSetting()},renderer:function(t,e){i.render(t,e)},onAfterRendering:function(){a.prototype.onAfterRendering.apply(this,arguments),this._dialogDefaultSetting(),this.setFullSizePopup(this.getFullSizePopup()),this._setEnableOffset()},setTitle:function(t){this.setProperty("title",t),this._title&&this._title.setText(t)},setIcon:function(t){this.setProperty("icon",t),this._icon&&""!=t&&this._icon.setSrc(t)},setTitleAlignment:function(t){if(this.setProperty("titleAlignment",t),this._toolbar){var e=this._toolbar,i=e.getContent()[0];switch(t){case sap.m.TitleAlignment.Auto:case sap.m.TitleAlignment.Start:if(!(i instanceof sap.m.ToolbarSpacer))return;e.removeContent(i);break;case sap.m.TitleAlignment.Center:if(i instanceof sap.m.ToolbarSpacer)return;e.insertContent(new sap.m.ToolbarSpacer,0)}}},setFullSizePopup:function(t){this.setProperty("fullSizePopup",t,!0),this._setToolbarBtnVisible(t),this.$().length&&(t?this._setDialogFullSize():this._setDialogBeforeSize())},open:function(){a.prototype.open.apply(this,arguments);var t=this.$(),e=this.getId()+"-cont",i=(document.getElementById(e),window.innerWidth),s=window.innerHeight,o={width:t.width(),height:t.height(),position:{x:t.offset().left,y:t.offset().top}},n={x:o.position.x,y:o.position.y};t.css({left:Math.min(Math.max(0,n.x),i-o.width),top:Math.min(Math.max(0,n.y),s-o.height),width:o.width,height:o.height,transform:""}),t.addClass("sapMDialogTouched"),t.addClass("sapDialogDisableTransition"),this.getRememberPosition()&&this._setDialogBeforeSize(),this._oManuallySetSize=this._oBeforePosition,this._setEnableOffset()},_registerPopUpPosition:function(){var t=this.$(),e=this.getId()+"-cont",i=document.getElementById(e);i&&(this._oBeforePosition={left:t.css("left"),top:t.css("top"),width:t.css("width"),height:t.css("height"),contentHeight:$(i).css("height")})},setOffsetX:function(t){this.setProperty("offsetX",t,!0),this._setEnableOffset()},setOffsetY:function(t){this.setProperty("offsetY",t,!0),this._setEnableOffset()},setEnableOffset:function(t){this.setProperty("enableOffset",t),(this._bDisableRepositioning=t)&&this._setEnableOffset()},setRememberPosition:function(t){this.setProperty("rememberPosition",t),this._oBeforePos_tmp&&(this._oBeforePosition=this._oBeforePos_tmp,delete this._oBeforePos_tmp),t||(this._oBeforePos_tmp=this._oBeforePosition,delete this._oBeforePosition)},_setEnableOffset:function(){if(this.$().length&&this.getEnableOffset()&&!this.getRememberPosition()){var t=this.$(),e=this.getOffsetX()+"px",i=this.getOffsetY()+"px";t.css("width"),t.css("height");return t.addClass("u4aMDialogOffsetOpen"),t.addClass("sapDialogDisableTransition"),t.addClass("sapMDialogTouched"),t.css("top",i),t.css("left",e),this._oBeforePosition&&this.getRememberPosition()?(t.css("top",this._oBeforePosition.top),void t.css("left",this._oBeforePosition.left)):void 0}},close:function(){a.prototype.close.apply(this,arguments),this.fireDialogClose()},_dialogDefaultSetting:function(){this.oPopup.setModal(!1),this.oPopup.setShadow(!1),this.setTitle(this.getTitle()),this.setIcon(this.getIcon()),this.setTitleAlignment(this.getTitleAlignment())},_setHeaderSetting:function(){var e=this,t=(new sap.m.Toolbar).addStyleClass("sapMBarTitleStart"),i=new sap.m.ToolbarSpacer,s=new sap.m.Title,o=(new sap.ui.core.Icon).addStyleClass("sapMDialogIcon"),n=new sap.m.Button({icon:"sap-icon://exit-full-screen"}),a=new sap.m.Button({icon:"sap-icon://full-screen"}),l=new sap.m.Button({icon:"sap-icon://decline"});t.addContent(o),t.addContent(s),t.addContent(i),t.addContent(n),t.addContent(a),t.addContent(l),this._toolbar=t,this._minSizeBtn=n,this._fullSizeBtn=a,this._closeBtn=l,this._title=s,this._icon=o,this._setToolbarBtnVisible(this.getFullSizePopup()),this.setCustomHeader(t),n.attachEvent("press",this._dialogSizeBtnPressEvent.bind(this,!1)),a.attachEvent("press",this._dialogSizeBtnPressEvent.bind(this,!0)),l.attachEvent("press",function(t){delete e._oBeforePosition,e.getRememberPosition()?(e._registerPopUpPosition(),e.getFullSizePopup()&&(delete e._oBeforeFullSizeOffset,e._oBeforeFullSizeOffset=e._oBeforePosition)):(delete e._oBeforePos_tmp,e.setProperty("fullSizePopup",!1,!0)),e.close()})},_setDialogBeforeSize:function(){var t=this.$();t.css("transform",""),t.css("-webkit-transform",""),t.addClass("sapMDialogTouched"),t.addClass("sapDialogDisableTransition"),this.getFullSizePopup()||(t.removeClass("u4aMDialogStretchFullContent"),t.removeClass("u4aMDialogStretchFull"));var e=this.getId()+"-cont";document.getElementById(e);this._oBeforePosition?(t.css("left",this._oBeforePosition.left),t.css("top",this._oBeforePosition.top),t.css("width",this._oBeforePosition.width),t.css("height",this._oBeforePosition.height),this.getRememberPosition()&&""!==this.getContentWidth()&&t.css("width",this.getContentWidth()),this.getRememberPosition()&&""!==this.getContentHeight()&&t.css("height",this.getContentHeight())):this.getStretch()||this._oManuallySetSize||this._bDisableRepositioning||(t.css(this._calcCenter()),t.css({width:t.css("width"),height:t.css("height")}))},_setDialogFullSize:function(){var t=this.$(),e=this.getId()+"-cont";document.getElementById(e);t.addClass("sapMDialogTouched"),t.addClass("sapDialogDisableTransition"),t.addClass("u4aMDialogStretchFull"),t.addClass("u4aMDialogStretchFullContent"),delete this._oBeforePosition},_setToolbarBtnVisible:function(t){this._minSizeBtn&&(this._minSizeBtn.setVisible(t),this._fullSizeBtn.setVisible(!t))},_calcCenter:function(){return this._calcCenterDialog()},_calcCenterDialog:function(){var t=window.innerWidth,e=window.innerHeight,i=this.$(),s=i.outerWidth(),o=i.outerHeight();return{left:Math.round((t-s)/2),top:Math.round((e-o)/2)}},_dialogSizeBtnPressEvent:function(t){this._setToolbarBtnVisible(t),this.setFullSizePopup(t)},_onResize:function(){var t;a.prototype._onResize.apply(this,arguments),this.getFullSizePopup()||(t=this.$(),this.$("cont").css("height",""),this.getStretch()||this._oManuallySetSize||this._bDisableRepositioning||t.css(this._calcCenter()))},onmouseup:function(t){$(t.target).hasClass("sapMIBar")&&sap.ui.Device.browser.msie&&this.oPopup._updateBlindLayer()},onmousedown:function(t){var e;this.getFullSizePopup()||(a.prototype.onmousedown.apply(this,arguments),$(t.target).hasClass("sapMIBar")&&((e=this.getCustomHeader().getDomRef()).setAttribute("tabindex",0),e.focus(),sap.ui.Device.browser.msie&&this.oPopup._updateBlindLayer()))},ondblclick:function(t){var e,i,s;this.getFullSizePopup()||$(t.target).hasClass("sapMIBar")&&(e=this.$(),(i=this._oBeforePosition||{}).width=e.css("width"),i.height=e.css("height"),a.prototype.ondblclick.apply(this,arguments),this.$().removeClass("u4aMDialogOffsetOpen"),e.css("width",i.width),e.css("height",i.height),this._oManuallySetSize={width:i.width,height:i.height},e.addClass("sapMDialogTouched"),e.addClass("sapDialogDisableTransition"),s=this._calcCenterDialog(),e.css("left",s.left),e.css("top",s.top))},setContentWidth:function(t){this.setProperty("contentWidth",t),delete this._oManuallySetSize},setContentHeight:function(t){this.setProperty("contentHeight",t),delete this._oManuallySetSize}})});