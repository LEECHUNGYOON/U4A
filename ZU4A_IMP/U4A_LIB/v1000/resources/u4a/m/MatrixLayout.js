sap.ui.define(["sap/ui/core/Control","u4a/m/MatrixLayoutRenderer"],function(a,b){"use strict";var c=a.extend("u4a.m.MatrixLayout",{metadata:{library:"u4a.m",properties:{stretchedHorizontally:{type:"boolean",defaultValue:!1},stretchedVertically:{type:"boolean",defaultValue:!1},width:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize"}},defaultAggregation:"content",aggregations:{content:{type:"sap.ui.core.Control",multiple:!0,singularName:"content"}}},renderer:b,onAfterRendering:function(){this._setGridTemplateColumns()},_setGridTemplateColumns:function(){var a=this.getDomRef("content");if(a){var b=this._getColCount(),c=this._calculateGridPositions(b),d=this._getGridTemplateColumns(b,c);a.style.gridTemplateColumns=d,this._setContentSpan(b,c)}},_setContentSpan:function(a,b){if(0!==b.length)for(let a=0,h=b.length;a<h;a++){var c=b[a],d=c?.oUi?.getLayoutData?.();if(d){var e=d.getDomRef();if(e){var f=d?.getLayoutType(),g=d?.getColSpan?.()||1;g=`span ${g}`,"MatrixHeadData"===f&&(g=`1 / ${g}`),e.style.gridColumn!==g&&(e.style.gridColumn=g)}}}},_getGridTemplateColumns:function(a,b){var c=`repeat(${a}, minmax(min-content, max-content))`,d=this.getDomRef();if(!d)return c;var e="minmax(min-content, max-content)";!0===this.getStretchedHorizontally()&&(e="auto");const f=[];for(let c=0;c<a;c++)f.push({size:e,calcSize:0});const g=d.clientWidth,h=parseFloat(getComputedStyle(document?.documentElement)?.fontSize)||16,i=window.innerWidth,j=window.innerHeight;for(let c=0,d=b.length;c<d;c++){var k=b[c];const a=k.oUi?.getLayoutData?.();if(!a)continue;var l=a?.getWidth?.();if(!l)continue;if(l=(l+"").toLowerCase(),"auto"===l||"inherit"===l)continue;var m=f[k.colPos];let d=l.replace(/[0-9.-]/g,"");var n=+l.replace(/[^0-9.-]/g,"")||0;switch(d){case"rem":n*=h;break;case"em":n*=h;break;case"vw":n=n*i/100;break;case"vh":n=n*j/100;break;case"pt":n*=1.3333;break;case"cm":n*=37.8;break;case"mm":n*=3.78;break;case"in":n*=96;break;case"px":n=n;break;case"%":n=g*(n/100);break;default:}n>m.calcSize&&(m.size=l,m.calcSize=n)}var o=[];for(let c=0,d=f.length;c<d;c++){var p=f[c],q=p.size;if(q===e){o.push(q);continue}q=`minmax(min-content, ${p.size})`,o.push(q)}return 0<o.length&&(c=o.join(" ")),c},_ensureRowExists:function(a){for(;a.gridMap.length<=a.rowIndx;)a.gridMap.push(Array(a.colCount).fill(!1))},_isBlockFree:function(a){for(let c=0;c<a.rowSpan;c++){var b={...a};b.rowIndx+=c,this._ensureRowExists(b);for(let c=0;c<a.colSpan;c++)if(a.gridMap[b.rowIndx][a.colIndx+c])return!1}return!0},_occupyBlock:function(a){for(let c=0;c<a.rowSpan;c++){var b={...a};b.rowIndx+=c,this._ensureRowExists(b);for(let c=0;c<a.colSpan;c++)a.gridMap[b.rowIndx][a.colIndx+c]=!0}},_calculateGridPositions:function(a){const b=[];var c={gridMap:[],colCount:a},d=this.getContent();if(0===d.length)return b;for(const e of d){const d=e.getLayoutData?.();c.colSpan=d?.getColSpan?.()||1,c.colSpan=Math.max(c.colSpan,1),c.rowSpan=d?.getRowSpan?.()||1,c.rowSpan=Math.max(c.rowSpan,1),c.colSpan=Math.min(c.colSpan,a);let f=!1;for(let d=0;!f;d++){c.rowIndx=d,this._ensureRowExists(c);for(let g=0,h=a-c.colSpan;g<=h;g++)if(c.colIndx=g,!!this._isBlockFree(c)){this._occupyBlock(c),b.push({oUi:e,rowPos:d,colPos:g,colSpan:c.colSpan,rowSpan:c.rowSpan}),f=!0;break}}}return b},_getColCount:function(){var a=1,b=this.getContent();if(0===b.length)return a;var c=0;for(let g=0;g<b.length;g++){var d=b[g],e=d.getLayoutData?.();if(!e?.isA||!e.isA("u4a.m.MatrixLayoutData")){c+=1,a=Math.max(a,c);continue}"MatrixHeadData"===e.getLayoutType()&&(c=0);var f=parseInt(e.getColSpan(),10);f=isNaN(f)||1>f?1:f,c+=f,a=Math.max(a,c)}return a}});return c});