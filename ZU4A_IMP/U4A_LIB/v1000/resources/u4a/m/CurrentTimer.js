sap.ui.define("u4a.m.CurrentTimer",["sap/ui/core/Control","sap/ui/core/library"],function(a,b){"use strict";var c=b.TextAlign,d=a.extend("u4a.m.CurrentTimer",{metadata:{library:"u4a.m",properties:{width:{type:"sap.ui.core.CSSSize",defaultValue:null},textAlign:{type:"sap.ui.core.TextAlign",defaultValue:c.Begin},fontSize:{type:"sap.ui.core.CSSSize",defaultValue:"20px"},fontColor:{type:"sap.ui.core.CSSColor",defaultValue:"#000000"},support2400:{type:"boolean",defaultValue:!1}}},renderer:function(a,b){var d=b.getWidth(),e=b.getFontSize(),f=b.getFontColor(),g=b.getTextAlign(),h=b.getSupport2400(),i=b._getFormattedCurrentTime(h);if(a.write("<span"),a.writeControlData(b),a.addStyle("display","inline-block"),d?a.addStyle("width",d):a.addStyle("max-width","100%"),a.addStyle("color",f),a.addStyle("font-size",e),g){var j=sap.ui.Device.browser.name;("ie"===j||"ed"===j)&&g===c.End?a.addStyle("text-align","right"):a.addStyle("text-align",g)}a.writeClasses(),a.writeStyles(),a.write(">"),a.writeEscaped(i),a.write("</span>")},onAfterRendering:function(){var a=this.getSupport2400();this._terminateWorker(),this._initWorker(a),document.addEventListener("visibilitychange",this._onVisibilityChangeBound=this._onVisibilityChange.bind(this))},exit:function(){this._terminateWorker(),document.removeEventListener("visibilitychange",this._onVisibilityChangeBound)},_initWorker:function(a){this._oWorker=new Worker("/zu4a_imp/publish/CommonJS/workers/CurrentTimerWorker.js");this._oWorker.postMessage({support2400:a}),this._oWorker.onmessage=function(a){this.onMessage(a)}.bind(this)},_terminateWorker:function(){this._oWorker instanceof Worker&&(this._oWorker.terminate(),this._oWorker=null)},_getFormattedCurrentTime:function(a){var b=new Date,c=b.getHours(),d=b.getMinutes(),e=b.getSeconds(),f="";a||(f="AM",12<=c&&(f="PM",12<c&&(c-=12)));var g=this._pad(c,2),h=this._pad(d,2),i=this._pad(e,2);return a?`${g}:${h}:${i}`:`${g}:${h}:${i} ${f}`},_pad:function(a,b){return a+="",a.length>=b?a:Array(b-a.length+1).join("0")+a},onMessage:function(a){var b=document.getElementById(this.getId());b&&(b.innerHTML=a.data)},_onVisibilityChange:function(){var a=this.getSupport2400(),b=document.getElementById(this.getId());"visible"===document.visibilityState?(b&&(b.innerHTML=this._getFormattedCurrentTime(a)),this._terminateWorker(),this._initWorker(a)):this._terminateWorker()}});return d});