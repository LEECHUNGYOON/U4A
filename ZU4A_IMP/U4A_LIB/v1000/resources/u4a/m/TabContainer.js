jQuery.sap.require("sap.ui.core.Control"),jQuery.sap.require("sap.m.TabContainer"),jQuery.sap.declare("u4a.m.TabContainer"),sap.m.TabContainer.extend("u4a.m.TabContainer",{metadata:{library:"u4a.m",properties:{selectedKey:{type:"string",group:"Data",defaultValue:""}}},_OldItemKeys:[],_bisRemoveCalled:!1,_iKey:null,constructor:function(a,b){var c=[];b||"object"!=typeof a||(b=a),b&&Array.isArray(b.items)&&(c=b.items,delete b.items);var d=sap.ui.core.Control;d.prototype.constructor.apply(this,arguments);var e=new sap.m.TabStrip(this.getId()+"--tabstrip",{hasSelect:!0,itemSelect:function(a){var b=a.getParameter("item"),c=this._fromTabStripItem(b);this.setSelectedItem(c,a),this.setProperty("selectedKey",c.getKey(),!0)}.bind(this),itemClose:function(a){var b=a.getParameter("item"),c=this._fromTabStripItem(b);a.preventDefault(),this.fireItemClose({item:c})&&this.removeItem(c)}.bind(this)});this.setAggregation("_tabStrip",e,!0),b&&b.showAddNewButton&&this.setShowAddNewButton(!0),c.forEach(function(a){this.addItem(a)},this)},renderer:function(a,b){"use strict";sap.m.TabContainerRenderer.render(a,b)},removeItem:function(a){var b;if("undefined"==typeof a||null===a)return null;this._bisRemoveCalled=!0;var c=this.getItems(),d=c.length;if(0==this._OldItemKeys.length)for(var e,f=0;f<d;f++)e=c[f],this._OldItemKeys.push(e.getProperty("key"));for(var f=0;f<d;f++){var e=c[f],g=e.getKey();if(this.getSelectedKey()==g){this._iKey=g;break}}return a=this.removeAggregation("items",a),b=a.getId()===this.getSelectedItem(),this._getTabStrip().removeItem(this._toTabStripItem(a)),a},_getItemIndex:function(a,b){for(var c=a.length,d=0;d<c;d++){var e=a[d],f=e.getProperty("key");if(f==b)return d}return-1},_hasDuplicateStrings:function(a){if(!Array.isArray(a))return"Invalid input: Input must be an array.";const b=new Set;for(const c of a){if("string"!=typeof c)return"Invalid input: Array elements must be strings.";if(b.has(c))return!0;b.add(c)}return!1},onBeforeRendering:function(){"use strict";try{var a=this.getItems(),b=a.length;if(0==b)return this.setAssociation("selectedItem",null),void this.setProperty("selectedKey","",!0);let i=[];for(var c=0;c<b;c++){let b=a[c],d=b.getKey();d&&i.push(d)}let j=this._hasDuplicateStrings(i);if(!0===j){throw oU4AErroHandle&&"function"==typeof oU4AErroHandle.seterroHTML&&oU4AErroHandle.seterroHTML("Duplicate keys in TabContainerItem"),console.error("Duplicate keys in TabContainerItem"),new Error("Duplicate keys in TabContainerItem")}var d=this.getSelectedKey();if(""==d)return this.setProperty("selectedKey",a[0].getKey(),!0),void this.setSelectedItem(a[0]);if(!1==this._bisRemoveCalled){for(var c=0;c<b;c++){var e=a[c],f=e.getKey();if(""==f)return;if(d==f&&e.getId()!=this.getSelectedItem()){this.setSelectedItem(e);break}}return}var g=this._getItemIndex(a,d);if(-1==g){for(var h=this._OldItemKeys.length,c=0;c<h&&this._OldItemKeys[c]!=this._iKey;c++);for(var l=c;l<h;l++)for(var m,n=0;n<b;n++)if(m=a[n],this._OldItemKeys[l]==m.getProperty("key"))return this.setSelectedItem(m),void this.setProperty("selectedKey",this._OldItemKeys[l],!0);return this.setSelectedItem(a[b-1]),void this.setProperty("selectedKey",a[b-1].getProperty("key"),!0)}this.setProperty("selectedKey",a[g].getProperty("key"),!0),this.setAssociation("selectedItem",a[g],!0)}catch(a){}finally{this._bisRemoveCalled=!1,this._OldItemKeys=[],this._iKey=null}}});