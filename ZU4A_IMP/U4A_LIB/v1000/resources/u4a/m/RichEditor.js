sap.ui.define("u4a.m.RichEditor",["sap/ui/core/Control"],function(t){"use strict";return t.extend("u4a.m.RichEditor",{metadata:{library:"u4a.m",properties:{width:{type:"string",defaultValue:"100%"},height:{type:"string",defaultValue:"100%"},value:{type:"string",defaultValue:null},editable:{type:"boolean",defaultValue:!0}}},init:function(){this._oEditorInfo={}},renderer:function(t,i){var e=i._oEditorInfo;e.editorId=i.getId(),e.editorContainerId=e.editorId+"-container",t.openStart("div",i),t.class("u4aRichEditor"),t.style("width",i.getWidth()),t.style("height",i.getHeight()),t.style("display","flex"),t.style("flex-direction","column"),t.openEnd(),t.openStart("div"),t.attr("id",e.editorContainerId),t.style("min-height","1px"),t.openEnd(),t.close("div"),t.close("div")},onAfterRendering:function(){this._loadCssTheme(),this._loadLibFiles(),this._setInitSettings()},_loadCssTheme:function(){var i="u4aRichEditor_style";document.getElementById(i)||jQuery.ajax({url:"/zu4a_imp/tools/quill/u4aRichEditor.snow.css",dataType:"text",async:!1,mimeType:"text/css",success:function(t){if(""==t)throw new Error("[U4AIDE] Load Fail to u4aRichEditor css files");t+=".sap-phone .u4aRichEditor,.sap-phone .u4aRichEditor *,.sap-ios .u4aRichEditor,.sap-ios .u4aRichEditor * {-webkit-user-select : text !important;-moz-user-select : text !important;-ms-user-select : text !important;user-select : text !important;-webkit-user-drag : none !important;}.sapUiTheme-sap_fiori_3_dark .u4aRichEditor > div,.sapUiTheme-sap_fiori_3_dark .u4aRichEditor .ql-toolbar .ql-picker.ql-expanded .ql-picker-label {border: .0625rem solid #8696a9;border-top: .0625rem solid #8696a9 !important;}.sapUiTheme-sap_fiori_3_dark .u4aRichEditor > div:hover{border-color: #91c8f6 !important;}.sapUiTheme-sap_fiori_3_dark .u4aRichEditor.u4aRichEditorDisabled > div {border-color: #546375;}.sapUiTheme-sap_fiori_3_dark .u4aRichEditor .ql-editor {background-color: #29313a !important;}.sapUiTheme-sap_fiori_3_dark .u4aRichEditor.u4aRichEditorDisabled .ql-editor {background: rgba(58,69,82,0.5) !important;}.sapUiTheme-sap_fiori_3_dark .u4aRichEditor .ql-toolbar .ql-picker-label:hover, .sapUiTheme-sap_fiori_3_dark .u4aRichEditor .ql-toolbar .ql-picker-label.ql-active,.sapUiTheme-sap_fiori_3_dark .u4aRichEditor .ql-toolbar button:hover,.sapUiTheme-sap_fiori_3_dark .u4aRichEditor .ql-toolbar .ql-picker-item:hover,.sapUiTheme-sap_fiori_3_dark .u4aRichEditor .ql-toolbar button.ql-active {color: #91c8f6;}.sapUiTheme-sap_fiori_3_dark .u4aRichEditor .ql-editor.ql-blank::before {color: rgba(146, 201, 246, 0.4);}.sapUiTheme-sap_fiori_3_dark .u4aRichEditor .ql-toolbar .ql-picker-label:hover .ql-stroke,.sapUiTheme-sap_fiori_3_dark .u4aRichEditor .ql-toolbar button.ql-active .ql-stroke, .sapUiTheme-sap_fiori_3_dark .u4aRichEditor .ql-toolbar .ql-picker-label.ql-active .ql-stroke,.sapUiTheme-sap_fiori_3_dark .u4aRichEditor .ql-toolbar button:hover .ql-stroke {stroke: #91c8f6;}.sapUiTheme-sap_fiori_3_dark .u4aRichEditor .ql-toolbar button:hover .ql-fill,.sapUiTheme-sap_fiori_3_dark .u4aRichEditor .ql-toolbar .ql-picker-label:hover .ql-fill,.sapUiTheme-sap_fiori_3_dark .u4aRichEditor .ql-toolbar button.ql-active .ql-fill {fill: #91c8f6;}",$("<style id='"+i+"'></style>").appendTo("head").html(t)},error:function(t){throw new Error("[U4AIDE] Load Fail to u4aRichEditor css files")}})},_loadLibFiles:function(){try{Quill}catch(t){jQuery.u4aJSloadAsync("/zu4a_imp/tools/quill/u4aRichEditor.min.js",function(){})}},_setInitSettings:function(){var e=this,t=this._oEditorInfo,i=(this.getId(),"#"+t.editorContainerId),o=new Quill(i,{modules:{toolbar:[[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{size:["small",!1,"large","huge"]}],["bold","italic","underline","strike"],["blockquote"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{color:[]},{background:[]}],[{align:[]}],["clean"]]},theme:"snow"}),r=this.getDomRef().firstChild,a=document.getElementById(t.editorContainerId),l=a.firstChild;a.addEventListener("focusout",function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();var i=e._oEditContent.innerHTML;e.setProperty("value",i,!0)}),a.addEventListener("focusin",function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e.getEditable()&&"sap_fiori_3_dark"==sap.ui.getCore().getConfiguration().getTheme()&&e._Quill.format("color","#ffffff")}),$(r).css("-ms-flex","0 0 auto"),this._Quill=o,this._oEditToolBar=r,this._oEditContent=l,this._setEditable(this.getEditable()),this._setValue(this.getValue()),"sap_fiori_3_dark"==sap.ui.getCore().getConfiguration().getTheme()&&this._Quill.format("color","#ffffff")},setValue:function(t){this.setProperty("value",t,!0);var i=this._oEditContent;i&&(null==t&&(t=""),i.innerHTML=t)},_setValue:function(t){null==t&&(t=""),this._oEditContent.innerHTML=t},setWidth:function(t){this.setProperty("width",t,!0);var i=this.getDomRef();i&&(i.style.width=t)},setHeight:function(t){this.setProperty("height",t,!0);var i=this.getDomRef();i&&(i.style.height=t)},setEditable:function(t){this.setProperty("editable",t,!0),this._oEditContent&&this._setEditable(t)},_setEditable:function(t){var i=this.$(),e=this._oEditContent,o=this._Quill;t?(i.removeClass("u4aRichEditorDisabled"),e.style.backgroundColor="#ffffff",o.enable(),e.setAttribute("data-placeholder","입력하세요..")):(i.addClass("u4aRichEditorDisabled"),e.style.backgroundColor="#f7f7f7",o.disable(),e.setAttribute("data-placeholder",""))}})});