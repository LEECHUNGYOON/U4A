sap.ui.define("u4a.m.RichEditor",["sap/ui/core/Control"],function(t){"use strict";return t.extend("u4a.m.RichEditor",{metadata:{library:"u4a.m",properties:{width:{type:"string",defaultValue:"100%"},height:{type:"string",defaultValue:"100%"},value:{type:"string",defaultValue:null},editable:{type:"boolean",defaultValue:!0}}},init:function(){this._oEditorInfo={}},renderer:function(t,e){var i=e._oEditorInfo;i.editorId=e.getId(),i.editorContainerId=i.editorId+"-container",t.openStart("div",e),t.class("u4aRichEditor"),t.style("width",e.getWidth()),t.style("height",e.getHeight()),t.style("display","flex"),t.style("flex-direction","column"),t.openEnd(),t.openStart("div"),t.attr("id",i.editorContainerId),t.style("min-height","1px"),t.openEnd(),t.close("div"),t.close("div")},onAfterRendering:function(){this._loadCssTheme(),this._loadLibFiles(),this._setInitSettings()},_loadCssTheme:function(){var e="u4aRichEditor_style";document.getElementById(e)||jQuery.ajax({url:"/zu4a_imp/tools/quill/u4aRichEditor.snow.css",dataType:"text",async:!1,mimeType:"text/css",success:function(t){if(""==t)throw new Error("[U4AIDE] Load Fail to u4aRichEditor css files");t+=".sap-phone .u4aRichEditor,.sap-phone .u4aRichEditor *,.sap-ios .u4aRichEditor,.sap-ios .u4aRichEditor * {-webkit-user-select : text !important;-moz-user-select : text !important;-ms-user-select : text !important;user-select : text !important;-webkit-user-drag : none !important;}",$("<style id='"+e+"'></style>").appendTo("head").html(t)},error:function(t){throw new Error("[U4AIDE] Load Fail to u4aRichEditor css files")}})},_loadLibFiles:function(){try{Quill}catch(t){jQuery.u4aJSloadAsync("/zu4a_imp/tools/quill/u4aRichEditor.min.js",function(){})}},_setInitSettings:function(){var i=this,t=this._oEditorInfo,e=(this.getId(),"#"+t.editorContainerId),o=new Quill(e,{modules:{toolbar:[[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{size:["small",!1,"large","huge"]}],["bold","italic","underline","strike"],["blockquote"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"ltr"}],[{color:[]},{background:[]}],[{align:[]}],["clean"]]},theme:"snow",placeholder:"입력하세요.."}),n=this.getDomRef().firstChild,s=document.getElementById(t.editorContainerId),r=s.firstChild;s.addEventListener("focusout",function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation();var e=i._oEditContent.innerHTML;i.setProperty("value",e,!0)}),$(n).css("-ms-flex","0 0 auto"),this._Quill=o,this._oEditToolBar=n,this._oEditContent=r,this._setEditable(this.getEditable()),this._setValue(this.getValue())},setValue:function(t){this.setProperty("value",t,!0);var e=this._oEditContent;e&&(null==t&&(t=""),e.innerHTML=t)},_setValue:function(t){null==t&&(t=""),this._oEditContent.innerHTML=t},setWidth:function(t){this.setProperty("width",t,!0);var e=this.getDomRef();e&&(e.style.width=t)},setHeight:function(t){this.setProperty("height",t,!0);var e=this.getDomRef();e&&(e.style.height=t)},setEditable:function(t){this.setProperty("editable",t,!0),this._oEditContent&&this._setEditable(t)},_setEditable:function(t){var e=this._oEditContent,i=this._Quill;t?(e.style.backgroundColor="#ffffff",i.enable()):(e.style.backgroundColor="#f7f7f7",i.disable())}})});