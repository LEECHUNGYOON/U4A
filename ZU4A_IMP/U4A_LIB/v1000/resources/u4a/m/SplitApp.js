sap.ui.define("u4a.m.SplitApp",["sap/m/SplitApp","sap/ui/thirdparty/jquery","sap/ui/Device","sap/m/Button"],function(a,l,d,t){"use strict";return a.extend("u4a.m.SplitApp",{metadata:{library:"u4a.m",properties:{showMasterPageNavButton:{type:"boolean",defaultValue:!1},showMasterPageAnimation:{type:"boolean",defaultValue:!1},masterPageNavButtonTop:{type:"sap.ui.core.CSSSize",defaultValue:"50px"},masterPageFixed:{type:"boolean",defaultValue:!1},masterPageWidth:{type:"sap.ui.core.CSSSize",defaultValue:"330px"},masterPageExpand:{type:"boolean",defaultValue:!1},rightPageWidth:{type:"sap.ui.core.CSSSize",defaultValue:"330px"},rightPageExpand:{type:"boolean",defaultValue:!1},rightPageAutoHide:{type:"boolean",defaultValue:!0}},aggregations:{rightPage:{type:"sap.m.Page",multiple:!1}}},renderer:function(t,e){sap.m.SplitAppRenderer.render(t,e),e.getRightPage()&&e._rightPageRender(t,e)},onAfterRendering:function(){a.prototype.onAfterRendering.apply(this,arguments),this._setMasterAnimation(),this._setRightAnimation(),d.system.phone?this.setMasterPageWidth("100%"):this._renderMasterNavButton(),this.getMasterPageFixed()?(this.setMode(sap.m.SplitAppMode.StretchCompressMode),this.setMasterPageExpand(!0),this.setShowMasterPageNavButton(!1),this._handleResize()):this.setMode(sap.m.SplitAppMode.HideMode);var t,e=this._oShowMasterBtn;null!=e&&null!=e.mEventRegistry.press&&(e.detachPress(e.mEventRegistry.press[0].fFunction),e.attachPress(this._attachPressMasterBtnEvent.bind(this))),this._oRightPage=document.getElementById(this.getId()+"-RightPage"),null!=this._oRightPage&&(t=this.getDomRef(),d.system.phone?(e=this.getAggregation("_navMaster").getDomRef(),this._oRightPage.style.visibility="hidden",e.appendChild(this._oRightPage)):t.appendChild(this._oRightPage),this.setRightPageExpand(this.getRightPageExpand()))},setShowMasterPageAnimation:function(t){this.setProperty("showMasterPageAnimation",t),this.removeStyleClass("u4aMSplitAppMasterAnimation"),t&&this.addStyleClass("u4aMSplitAppMasterAnimation")},setShowMasterPageNavButton:function(t){this.setProperty("showMasterPageNavButton",t),this.removeStyleClass("u4aMSplitAppMasterNavButton"),t&&this.addStyleClass("u4aMSplitAppMasterNavButton")},_renderMasterNavButton:function(){var t,e,a=this.getDomRef();a&&(this._oMasterNavBtn&&(this._oMasterNavBtn.destroy(),delete this._oMasterNavBtn),this._oMasterNavBtn=new sap.m.Button(this.getId()+"-MasterNavBtn",{visible:this.getShowMasterPageNavButton(),press:this._pressMasterNavBtn.bind(this)}).addStyleClass("u4aSplitAppMasterNavBtn"),t=sap.ui.getCore().createRenderManager(),e=this.getMasterPageExpand(),this._masterNavBtnIconChange(e),t.renderControl(this._oMasterNavBtn),t.flush(a,!1,!0))},_masterNavBtnIconChange:function(t){var e,a=this._oMasterNavBtn;null!=a&&(e="sap-icon://navigation-right-arrow",a.removeStyleClass("u4aSplitAppMasterNavBtnShow"),t&&(e="sap-icon://navigation-left-arrow",a.addStyleClass("u4aSplitAppMasterNavBtnShow")),a.setIcon(e),a.rerender())},_pressMasterNavBtn:function(t){var e=this.getMasterPageExpand();this.setMasterPageExpand(!e)},_handleResize:function(){a.prototype._handleResize.apply(this,arguments),this.getMode()==sap.m.SplitAppMode.StretchCompressMode&&this.$().hasClass("sapMSplitContainerPortrait")&&this.$().removeClass("sapMSplitContainerPortrait")},_getComputedWidth:function(t,e){if(null!=t){this._pageWidthValidCheck(e);var a,s;return l.sap.endsWith(e,"px")?(a=parseInt(e),l.sap.endsWith(t.sId,"Master")&&(a*=-1,0),s=a+"px"):(s="100%",l.sap.endsWith(t.sId,"Master")&&(a=parseInt(s),s=(a*=-1)+"%")),s}},_getMasterStyleDomId:function(){return this.getId()+"-u4aMSplitApp_masterStyle"},_getRightStyleDomId:function(){return this.getId()+"-u4aMSplitApp_rightStyle"},_setMasterAnimation:function(){var t=this._oMasterNav;if(!d.system.phone&&null!=t){var e=this.getId(),a=this.getMasterPageWidth(),s=this._getComputedWidth(t,a),i=this.getMasterPages(),p=i.length;if(0!=p){for(var r=0;r<p;r++)(l=i[r]).getVisible()||l.setVisible(!0);if(this.getShowMasterPageNavButton()){var n=t.getDomRef();if(!n)return;var o=t.getParent().getDomRef(),h=n.cloneNode();h.style.visibility="hidden",o.appendChild(h),$(h).css("width",a);a=$(h).css("width");$(h).remove(),t.removeStyleClass("sapMSplitContainerMaster"),t.removeStyleClass("sapMSplitContainerMasterHidden"),t.removeStyleClass("u4aMSplitAppMasterHide"+e),$(n).css("width",a);s=-1*parseInt(a)+10+"px";if(0==p)return;for(var l,r=0;r<p;r++)(l=i[r]).setVisible(this.getMasterPageExpand())}this._oShowMasterBtn.setVisible(!this.getShowMasterPageNavButton());h=document.getElementById(this._getMasterStyleDomId());null!=h&&$(h).remove();n=document.createElement("style");n.id=this._getMasterStyleDomId();h=".u4aMSplitAppMaster"+e+"{";h+="width : "+a+";",h+="transition : all 300ms ease 0s !important;",h+="}",h+=".u4aMSplitAppMasterShow"+e+"{",h+="transform: translate3d(0px, 0px, 0px) !important;",h+="box-shadow: rgba(0, 0, 0, 0.15) 0px 0.625rem 1.875rem 0px, rgba(0, 0, 0, 0.15) 0px 0px 0px 1px !important;",h+="visibility: visible !important;",h+="}",h+=".sapUiTheme-sap_fiori_3_dark .u4aMSplitAppMasterHide"+e+"{",h+="background-color: #43505f;",h+="}",h+=".u4aMSplitAppMasterHide"+e+"{",h+="background-color: #CCCCCC;",h+="transform: translate3d("+s+",0,0) !important;",h+="-webkit-transform: translate3d("+s+",0,0) !important;",h+="transition: all 300ms ease 0s !important;",h+="-webkit-transition: all 300ms ease 0s !important;",h+="box-shadow: rgba(255, 255, 255, 0) 0px 0rem 0rem 0px, rgba(255, 255, 255, 0) 0px 0px 0px 0px !important;",h+="}",h+=".u4aMSplitAppMasterNavButton .u4aMSplitAppMasterHide"+e+"{",h+="box-shadow: rgba(0, 0, 0, 0.15) 0px 0.625rem 1.875rem 0px, rgba(0, 0, 0, 0.15) 0px 0px 0px 1px !important;",h+="visibility: visible;",h+="}",h+=".u4aMSplitAppMasterAnimation .u4aMSplitAppMasterHide {",h+="background-image: linear-gradient(180deg, rgba(255,255,255,0) 46%, rgba(255,255,255,.8) 50%, rgba(255,255,255,.8) 52%, rgba(255,255,255,0) 56% );",h+="background-size: 3000px 3000px;",h+="animation: u4aMasterHideAnimation 3s linear infinite;",h+="}",h+="@keyframes u4aMasterHideAnimation {",h+="0% { background-position: 0px 0px; }",h+="80%, 100% { background-position: 4000px 4000px; }",h+="}",h+=".sapUiSizeCompact .u4aSplitAppMasterNavBtn,",h+=".sapUiSizeCompact.u4aSplitAppMasterNavBtn { ",h+="padding: 0px;",h+="height: 1.5rem;",h+="width: 1.5rem;",h+="}",h+=".sapUiSizeCompact .u4aSplitAppMasterNavBtn .sapMBtnInner,",h+=".sapUiSizeCompact.u4aSplitAppMasterNavBtn .sapMBtnInner { ",h+="width: 1.5rem;",h+="min-width: 1.5rem;",h+="height: 1.5rem;",h+="}",h+=".u4aSplitAppMasterNavBtn { ",h+="position: absolute;",h+="left: 0px;",h+="top: "+this.getMasterPageNavButtonTop()+";",h+="z-index: 10;",h+="transition: all 300ms;",h+="-webkit-transition: all 300ms;",h+="}",h+=".u4aSplitAppMasterNavBtn .sapMBtnInner { ",h+="border-radius: 2rem;",h+="}",h+=".sapUiSizeCompact .u4aSplitAppMasterNavBtn .sapMBtnInner { ",h+="border-radius: 1rem;",h+="}";h+=".u4aSplitAppMasterNavBtnShow { ",h+="left: "+(Math.abs(parseInt(s))+-9+"px")+";",h+="transition: all 300ms ease 0s;",h+="}",n.innerText=h,document.head.appendChild(n),t.removeStyleClass("u4aMSplitAppMaster u4aMSplitAppMaster"+e),t.removeStyleClass("u4aMSplitAppMasterShow u4aMSplitAppMasterShow"+e),t.removeStyleClass("u4aMSplitAppMasterHide u4aMSplitAppMasterHide"+e),this.getMasterPageExpand()?t.addStyleClass("u4aMSplitAppMasterShow u4aMSplitAppMasterShow"+e):t.addStyleClass("u4aMSplitAppMasterHide u4aMSplitAppMasterHide"+e),t.addStyleClass("u4aMSplitAppMaster u4aMSplitAppMaster"+e),t.addStyleClass("sapMSplitContainerMaster"),t.addStyleClass("sapMSplitContainerMasterHidden")}}},_setRightAnimation:function(){var t,e,a,s,i=this._oRightPage,p=this.getRightPage();null!=i&&(t=this.getRightPageWidth(),e=this._getComputedWidth(p,t),null!=(s=document.getElementById(this._getRightStyleDomId()))&&$(s).remove(),(a=document.createElement("style")).id=this._getRightStyleDomId(),s=".u4aMSplitAppRightPage"+(p=this.getId())+"{",s+="height: 100%;",s+="display: inline-block;",s+="position: absolute;",s+="z-index: 4;",s+="top: 0;",s+="box-sizing: border-box;",s+="width: "+t+";",s+="right: 0;",s+="border-left: #ebebeb;",s+="background-color: #ffffff;",s+="}",s+=".u4aMSplitAppRightShow"+p+"{",s+="transform: translate3d(0px, 0px, 0px);",s+="transition: all 300ms ease 0s;",s+="box-shadow: rgba(0, 0, 0, 0.15) 0px 0.625rem 1.875rem 0px, rgba(0, 0, 0, 0.15) 0px 0px 0px 1px;",s+="visibility: visible;",s+="}",s+=".u4aMSplitAppRightHide"+p+"{",s+="transform: translate3d("+e+",0,0);",s+="-webkit-transform: translate3d("+e+",0,0);",s+="transition: all 300ms;",s+="-webkit-transition: all 300ms;",s+="box-shadow: rgba(255, 255, 255, 0) 0px 0rem 0rem 0px, rgba(255, 255, 255, 0) 0px 0px 0px 0px;",s+="visibility: hidden;",s+="}",a.innerText=s,document.head.appendChild(a),(i=$(i)).removeClass("u4aMSplitAppRightPage"+p),i.removeClass("u4aMSplitAppRightShow"+p),i.removeClass("u4aMSplitAppRightHide"+p),i.addClass("u4aMSplitAppRightPage"+p),this.getRightPageExpand()?i.addClass("u4aMSplitAppRightShow"+p):i.addClass("u4aMSplitAppRightHide"+p))},_attachPressMasterBtnEvent:function(){this._bMasterPageExpand=!this._bMasterPageExpand,this.setMasterPageExpand(this._bMasterPageExpand)},setMasterPageFixed:function(t){d.system.phone&&(t=!0),this.setProperty("masterPageFixed",t),t?(this.setMode(sap.m.SplitAppMode.StretchCompressMode),this._handleResize()):this.setMode(sap.m.SplitAppMode.HideMode),this.setMasterPageExpand(t)},setMasterPageExpand:function(t){!d.system.phone&&this.getMode()!=sap.m.SplitAppMode.StretchCompressMode||t?(this.setProperty("masterPageExpand",t,!0),this._masterNavBtnIconChange(t),this._bMasterPageExpand=t,this._setMasterAnimation()):this.setProperty("masterPageExpand",t,!0)},setMasterPageWidth:function(t){this._pageWidthValidCheck(t),d.system.phone&&(t="100%"),this.setProperty("masterPageWidth",t,!0),this.setMasterPageExpand(this.getMasterPageExpand())},setRightPageWidth:function(t){this._pageWidthValidCheck(t),this.setProperty("rightPageWidth",t,!0),this.setRightPageExpand(this.getRightPageExpand())},setRightPageExpand:function(t){this.setProperty("rightPageExpand",t,!0),null!=this._oRightPage&&this._setRightAnimation()},setRightPageAutoHide:function(t){this.setProperty("rightPageAutoHide",t,!0)},_rightPageRender:function(t,e){var a=e.getId();t.write("<div"),t.addClass("u4aMSplitAppRightPage"+a),t.writeAttribute("id",a+"-RightPage"),t.writeClasses(),t.write(">"),t.renderControl(e.getRightPage()),t.write("</div>")},_pageWidthValidCheck:function(t){if(t.toLowerCase&&(t=t.toLowerCase()),!l.sap.endsWith(t,"px")&&!l.sap.endsWith(t,"%"))throw new Error("[U4AIDE] property Type Error 'rightPageWidth' : 'px' 또는 % 단위만 입력 가능합니다.")},showMaster:function(){a.prototype.showMaster.apply(this,arguments),this.setMasterPageExpand(!0)},hideMaster:function(){a.prototype.hideMaster.apply(this,arguments),this.setMasterPageExpand(!1)},ontap:function(t){var e,a,s,i,p,r,n,o,h;d.system.phone||(i=s=a=!(e=!0),h=this.getId(),p=l(t.target).closest(".sapMSplitContainerDetail, .sapMSplitContainerMaster, .u4aMSplitAppRightPage"+h),r=l(t.target).closest(".sapMPageHeader"),n=t.srcControl.getMetadata(),o=t.srcControl,o=l(o.getDomRef()).closest(".u4aSplitAppMasterNavBtn"),0<p.length&&p.hasClass("sapMSplitContainerMaster")&&(a=!0),0<o.length&&o.hasClass("u4aSplitAppMasterNavBtn")&&(a=!0),0<p.length&&p.hasClass("sapMSplitContainerDetail")&&(s=!0),0<p.length&&p.hasClass("u4aMSplitAppRightPage"+h)&&(i=!0),h=!1,s&&0<r.length&&r.hasClass("sapMPageHeader")&&(e=!(h=!0)),h&&"sap.m.Button"!=n._sClassName&&(e=!0),h&&n==sap.ui.core.Icon.getMetadata()&&t.srcControl.getParent()instanceof sap.m.Button&&(e=!1),(a||i)&&(e=!1),h&&n==sap.ui.core.Icon.getMetadata()&&t.srcControl.getParent()instanceof sap.m.Button==0&&(e=!0),this.getMode()==sap.m.SplitAppMode.StretchCompressMode&&a&&!n.getEvent("press")&&(e=!0),e&&(this.getMasterPageFixed()||this.hideMaster(),this.getRightPageAutoHide()&&this.setRightPageExpand(!1)))}})});