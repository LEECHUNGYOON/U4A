sap.ui.define("u4a.m.SplitApp",["sap/m/SplitApp","sap/ui/thirdparty/jquery","sap/ui/Device","sap/m/Button"],function(a,b,c){"use strict";var d=a.extend("u4a.m.SplitApp",{metadata:{library:"u4a.m",properties:{showMasterPageNavButton:{type:"boolean",defaultValue:!1},showMasterPageAnimation:{type:"boolean",defaultValue:!1},masterPageNavButtonTop:{type:"sap.ui.core.CSSSize",defaultValue:"50px"},masterPageFixed:{type:"boolean",defaultValue:!1},masterPageWidth:{type:"sap.ui.core.CSSSize",defaultValue:"330px"},masterPageExpand:{type:"boolean",defaultValue:!1},rightPageWidth:{type:"sap.ui.core.CSSSize",defaultValue:"330px"},rightPageExpand:{type:"boolean",defaultValue:!1},rightPageAutoHide:{type:"boolean",defaultValue:!0}},aggregations:{rightPage:{type:"sap.m.Page",multiple:!1}}},renderer:function(a,b){sap.m.SplitAppRenderer.render(a,b),b.getRightPage()&&b._rightPageRender(a,b)},init:function(){a.prototype.init&&a.prototype.init.apply(this,arguments),this.getMasterPageFixed()?this.setMode(sap.m.SplitAppMode.StretchCompressMode):this.setMode(sap.m.SplitAppMode.HideMode)},onAfterRendering:function(){a.prototype.onAfterRendering.apply(this,arguments),this._setMasterAnimation(),this._setRightAnimation(),c.system.phone?this.setMasterPageWidth("100%"):this._renderMasterNavButton(),this.getMasterPageFixed()?(this.setMode(sap.m.SplitAppMode.StretchCompressMode),this.setShowMasterPageNavButton(!1),this._handleResize()):this.setMode(sap.m.SplitAppMode.HideMode);var b=this._oShowMasterBtn;if(null!=b&&null!=b.mEventRegistry.press&&(b.detachPress(b.mEventRegistry.press[0].fFunction),b.attachPress(this._attachPressMasterBtnEvent.bind(this))),this._oRightPage=document.getElementById(this.getId()+"-RightPage"),null!=this._oRightPage){var d=this.getDomRef();if(c.system.phone){var e=this.getAggregation("_navMaster"),f=e.getDomRef();this._oRightPage.style.visibility="hidden",f.appendChild(this._oRightPage)}else d.appendChild(this._oRightPage);this.setRightPageExpand(this.getRightPageExpand())}this.setMasterPageExpand(this.getMasterPageExpand())},exit:function(){a.prototype.exit&&a.prototype.exit.apply(this,arguments),this._oMasterNavBtn&&(this._oMasterNavBtn.destroy(),delete this._oMasterNavBtn)},setShowMasterPageAnimation:function(a){this.setProperty("showMasterPageAnimation",a),this.removeStyleClass("u4aMSplitAppMasterAnimation"),a&&this.addStyleClass("u4aMSplitAppMasterAnimation")},setShowMasterPageNavButton:function(a){this.setProperty("showMasterPageNavButton",a),this.removeStyleClass("u4aMSplitAppMasterNavButton"),a&&this.addStyleClass("u4aMSplitAppMasterNavButton")},_renderMasterNavButton:function(){var a=this.getDomRef();if(a){this._oMasterNavBtn&&(this._oMasterNavBtn.destroy(),delete this._oMasterNavBtn),this._oMasterNavBtn=new sap.m.Button(this.getId()+"-MasterNavBtn",{visible:this.getShowMasterPageNavButton(),press:this._pressMasterNavBtn.bind(this)}).addStyleClass("u4aSplitAppMasterNavBtn");var b=sap.ui.getCore().createRenderManager(),c=this.getMasterPageExpand();this._masterNavBtnIconChange(c),b.renderControl(this._oMasterNavBtn),b.flush(a,!1,!0)}},_masterNavBtnIconChange:function(a){var b=this._oMasterNavBtn;if(null!=b){var c="sap-icon://navigation-right-arrow";b.removeStyleClass("u4aSplitAppMasterNavBtnShow"),a&&(c="sap-icon://navigation-left-arrow",b.addStyleClass("u4aSplitAppMasterNavBtnShow")),b.setIcon(c),b.rerender()}},_pressMasterNavBtn:function(){var a=this.getMasterPageExpand();this.setMasterPageExpand(!a)},_handleResize:function(){a.prototype._handleResize.apply(this,arguments),this.getMode()==sap.m.SplitAppMode.StretchCompressMode&&this.$().hasClass("sapMSplitContainerPortrait")&&this.$().removeClass("sapMSplitContainerPortrait")},_getComputedWidth:function(a,c){if(null!=a){this._pageWidthValidCheck(c);var d,e,f=!1;return b.sap.endsWith(c,"px")?(d=parseInt(c),b.sap.endsWith(a.sId,"Master")&&(d*=-1,f=!0),e=d+"px"):(e="100%",b.sap.endsWith(a.sId,"Master")&&(f=!0,d=parseInt(e),d*=-1,e=d+"%")),e}},_getMasterStyleDomId:function(){return this.getId()+"-u4aMSplitApp_masterStyle"},_getRightStyleDomId:function(){return this.getId()+"-u4aMSplitApp_rightStyle"},_setMasterAnimation:function(){var a=this._oMasterNav;if(!(c.system.phone||null==a)){var b=this.getId(),d=this.getMasterPageWidth(),e=this._getComputedWidth(a,d),f=this.getMasterPages(),g=f.length;if(0!=g){for(var h=0;h<g;h++){var j=f[h],k=j.getVisible();k||j.setVisible(!0)}if(this.getShowMasterPageNavButton()){var l=a.getDomRef();if(!l)return;var m=a.getParent().getDomRef(),n=l.cloneNode();n.style.visibility="hidden",m.appendChild(n),$(n).css("width",d);var d=$(n).css("width");$(n).remove(),a.removeStyleClass("sapMSplitContainerMaster"),a.removeStyleClass("sapMSplitContainerMasterHidden"),a.removeStyleClass("u4aMSplitAppMasterHide"+b),$(l).css("width",d);if(e=-1*parseInt(d)+10+"px",0==g)return;for(var j,h=0;h<g;h++)j=f[h],j.setVisible(this.getMasterPageExpand())}this._oShowMasterBtn.setVisible(!this.getShowMasterPageNavButton());var o=document.getElementById(this._getMasterStyleDomId());null!=o&&$(o).remove();var p=document.createElement("style");p.id=this._getMasterStyleDomId();var q=".u4aMSplitAppMaster"+b+"{";q+="width : "+d+";",q+="transition : all 300ms ease 0s !important;",q+="}",q+=".u4aMSplitAppMasterShow"+b+"{",q+="transform: translate3d(0px, 0px, 0px) !important;",q+="box-shadow: rgba(0, 0, 0, 0.15) 0px 0.625rem 1.875rem 0px, rgba(0, 0, 0, 0.15) 0px 0px 0px 1px !important;",q+="visibility: visible !important;",q+="}",q+=".sapUiTheme-sap_fiori_3_dark .u4aMSplitAppMasterHide"+b+"{",q+="background-color: #43505f;",q+="}",q+=".u4aMSplitAppMasterHide"+b+"{",q+="background-color: #CCCCCC;",q+="transform: translate3d("+e+",0,0) !important;",q+="-webkit-transform: translate3d("+e+",0,0) !important;",q+="transition: all 300ms ease 0s !important;",q+="-webkit-transition: all 300ms ease 0s !important;",q+="box-shadow: rgba(255, 255, 255, 0) 0px 0rem 0rem 0px, rgba(255, 255, 255, 0) 0px 0px 0px 0px !important;",q+="}",q+=".u4aMSplitAppMasterNavButton .u4aMSplitAppMasterHide"+b+"{",q+="box-shadow: rgba(0, 0, 0, 0.15) 0px 0.625rem 1.875rem 0px, rgba(0, 0, 0, 0.15) 0px 0px 0px 1px !important;",q+="visibility: visible;",q+="}",q+=".u4aMSplitAppMasterAnimation .u4aMSplitAppMasterHide {",q+="background-image: linear-gradient(180deg, rgba(255,255,255,0) 46%, rgba(255,255,255,.8) 50%, rgba(255,255,255,.8) 52%, rgba(255,255,255,0) 56% );",q+="background-size: 3000px 3000px;",q+="animation: u4aMasterHideAnimation 3s linear infinite;",q+="}",q+="@keyframes u4aMasterHideAnimation {",q+="0% { background-position: 0px 0px; }",q+="80%, 100% { background-position: 4000px 4000px; }",q+="}",q+=".sapUiSizeCompact .u4aSplitAppMasterNavBtn,",q+=".sapUiSizeCompact.u4aSplitAppMasterNavBtn { ",q+="padding: 0px;",q+="height: 1.5rem;",q+="width: 1.5rem;",q+="}",q+=".sapUiSizeCompact .u4aSplitAppMasterNavBtn .sapMBtnInner,",q+=".sapUiSizeCompact.u4aSplitAppMasterNavBtn .sapMBtnInner { ",q+="width: 1.5rem;",q+="min-width: 1.5rem;",q+="height: 1.5rem;",q+="}",q+=".u4aSplitAppMasterNavBtn { ",q+="position: absolute;",q+="left: 0px;",q+="top: "+this.getMasterPageNavButtonTop()+";",q+="z-index: 10;",q+="transition: all 300ms;",q+="-webkit-transition: all 300ms;",q+="}",q+=".u4aSplitAppMasterNavBtn .sapMBtnInner { ",q+="border-radius: 2rem;",q+="}",q+=".sapUiSizeCompact .u4aSplitAppMasterNavBtn .sapMBtnInner { ",q+="border-radius: 1rem;",q+="}";var r=Math.abs(parseInt(e))+-9+"px";q+=".u4aSplitAppMasterNavBtnShow { ",q+="left: "+r+";",q+="transition: all 300ms ease 0s;",q+="}",p.innerText=q,document.head.appendChild(p),a.removeStyleClass("u4aMSplitAppMaster u4aMSplitAppMaster"+b),a.removeStyleClass("u4aMSplitAppMasterShow u4aMSplitAppMasterShow"+b),a.removeStyleClass("u4aMSplitAppMasterHide u4aMSplitAppMasterHide"+b),this.getMasterPageExpand()||this.getMasterPageFixed()?a.addStyleClass("u4aMSplitAppMasterShow u4aMSplitAppMasterShow"+b):a.addStyleClass("u4aMSplitAppMasterHide u4aMSplitAppMasterHide"+b),a.addStyleClass("u4aMSplitAppMaster u4aMSplitAppMaster"+b),a.addStyleClass("sapMSplitContainerMaster"),a.addStyleClass("sapMSplitContainerMasterHidden")}}},_setRightAnimation:function(){var a=this._oRightPage,b=this.getRightPage();if(null!=a){var c=this.getRightPageWidth(),d=this._getComputedWidth(b,c),e=document.getElementById(this._getRightStyleDomId());null!=e&&$(e).remove();var f=document.createElement("style");f.id=this._getRightStyleDomId();var g=this.getId(),h=".u4aMSplitAppRightPage"+g+"{";h+="height: 100%;",h+="display: inline-block;",h+="position: absolute;",h+="z-index: 4;",h+="top: 0;",h+="box-sizing: border-box;",h+="width: "+c+";",h+="right: 0;",h+="border-left: #ebebeb;",h+="background-color: #ffffff;",h+="}",h+=".u4aMSplitAppRightShow"+g+"{",h+="transform: translate3d(0px, 0px, 0px);",h+="transition: all 300ms ease 0s;",h+="box-shadow: rgba(0, 0, 0, 0.15) 0px 0.625rem 1.875rem 0px, rgba(0, 0, 0, 0.15) 0px 0px 0px 1px;",h+="visibility: visible;",h+="}",h+=".u4aMSplitAppRightHide"+g+"{",h+="transform: translate3d("+d+",0,0);",h+="-webkit-transform: translate3d("+d+",0,0);",h+="transition: all 300ms;",h+="-webkit-transition: all 300ms;",h+="box-shadow: rgba(255, 255, 255, 0) 0px 0rem 0rem 0px, rgba(255, 255, 255, 0) 0px 0px 0px 0px;",h+="visibility: hidden;",h+="}",f.innerText=h,document.head.appendChild(f);var i=$(a);i.removeClass("u4aMSplitAppRightPage"+g),i.removeClass("u4aMSplitAppRightShow"+g),i.removeClass("u4aMSplitAppRightHide"+g),i.addClass("u4aMSplitAppRightPage"+g),this.getRightPageExpand()?i.addClass("u4aMSplitAppRightShow"+g):i.addClass("u4aMSplitAppRightHide"+g)}},_attachPressMasterBtnEvent:function(){this._bMasterPageExpand=!this._bMasterPageExpand,this.setMasterPageExpand(this._bMasterPageExpand)},setMasterPageFixed:function(a){c.system.phone&&(a=!0),this.setProperty("masterPageFixed",a),a?(this.setMode(sap.m.SplitAppMode.StretchCompressMode),this._handleResize()):this.setMode(sap.m.SplitAppMode.HideMode)},setMasterPageExpand:function(a){this.setProperty("masterPageExpand",a,!0),this._masterNavBtnIconChange(a),this._bMasterPageExpand=a,this._setMasterAnimation()},setMasterPageWidth:function(a){this._pageWidthValidCheck(a),c.system.phone&&(a="100%"),this.setProperty("masterPageWidth",a,!0),this.setMasterPageExpand(this.getMasterPageExpand())},setRightPageWidth:function(a){this._pageWidthValidCheck(a),this.setProperty("rightPageWidth",a,!0),this.setRightPageExpand(this.getRightPageExpand())},setRightPageExpand:function(a){this.setProperty("rightPageExpand",a,!0);null==this._oRightPage||this._setRightAnimation()},setRightPageAutoHide:function(a){this.setProperty("rightPageAutoHide",a,!0)},_rightPageRender:function(a,b){var c=b.getId();a.write("<div"),a.addClass("u4aMSplitAppRightPage"+c),a.writeAttribute("id",c+"-RightPage"),a.writeClasses(),a.write(">"),a.renderControl(b.getRightPage()),a.write("</div>")},_pageWidthValidCheck:function(a){if(a.toLowerCase&&(a=a.toLowerCase()),!b.sap.endsWith(a,"px")&&!b.sap.endsWith(a,"%"))throw new Error("[U4AIDE] property Type Error 'rightPageWidth' : 'px' \uB610\uB294 % \uB2E8\uC704\uB9CC \uC785\uB825 \uAC00\uB2A5\uD569\uB2C8\uB2E4.")},showMaster:function(){a.prototype.showMaster.apply(this,arguments),this.setMasterPageExpand(!0)},hideMaster:function(){a.prototype.hideMaster.apply(this,arguments),this.setMasterPageExpand(!1)},ontap:function(a){if(!c.system.phone){var d=!0,e=!1,f=!1,g=!1,h=this.getId(),i=b(a.target).closest(".sapMSplitContainerDetail, .sapMSplitContainerMaster, .u4aMSplitAppRightPage"+h),j=b(a.target).closest(".sapMPageHeader"),k=a.srcControl.getMetadata(),l=a.srcControl,m=b(l.getDomRef()).closest(".u4aSplitAppMasterNavBtn");0<i.length&&i.hasClass("sapMSplitContainerMaster")&&(e=!0),0<m.length&&m.hasClass("u4aSplitAppMasterNavBtn")&&(e=!0),0<i.length&&i.hasClass("sapMSplitContainerDetail")&&(f=!0),0<i.length&&i.hasClass("u4aMSplitAppRightPage"+h)&&(g=!0);var n=!1;f&&0<j.length&&j.hasClass("sapMPageHeader")&&(n=!0,d=!1),n&&"sap.m.Button"!=k._sClassName&&(d=!0),n&&k==sap.ui.core.Icon.getMetadata()&&a.srcControl.getParent()instanceof sap.m.Button&&(d=!1),(e||g)&&(d=!1),n&&k==sap.ui.core.Icon.getMetadata()&&!1==a.srcControl.getParent()instanceof sap.m.Button&&(d=!0),this.getMode()==sap.m.SplitAppMode.StretchCompressMode&&e&&!k.getEvent("press")&&(d=!0),d&&(!this.getMasterPageFixed()&&!0===this.getAutoHideMasterPage()&&this.hideMaster(),this.getRightPageAutoHide()&&this.setRightPageExpand(!1))}}});return d});