sap.ui.define("u4a.m.SplitApp",["sap/m/SplitApp","sap/ui/thirdparty/jquery","sap/ui/Device","sap/m/Button"],function(s,g,u,t){"use strict";return s.extend("u4a.m.SplitApp",{metadata:{library:"u4a.m",properties:{showMasterPageNavButton:{type:"boolean",defaultValue:!1},masterPageNavButtonTop:{type:"sap.ui.core.CSSSize",defaultValue:"50px"},masterPageFixed:{type:"boolean",defaultValue:!1},masterPageWidth:{type:"sap.ui.core.CSSSize",defaultValue:"330px"},masterPageExpand:{type:"boolean",defaultValue:!1},rightPageWidth:{type:"sap.ui.core.CSSSize",defaultValue:"330px"},rightPageExpand:{type:"boolean",defaultValue:!1},rightPageAutoHide:{type:"boolean",defaultValue:!0}},aggregations:{rightPage:{type:"sap.m.Page",multiple:!1}}},renderer:function(t,e){sap.m.SplitAppRenderer.render(t,e),e.getRightPage()&&e._rightPageRender(t,e)},onAfterRendering:function(){s.prototype.onAfterRendering.apply(this,arguments),this._setMasterAnimation(),this._setRightAnimation(),u.system.phone?this.setMasterPageWidth("100%"):this._renderMasterNavButton(),this.getMasterPageFixed()?(this.setMode(sap.m.SplitAppMode.StretchCompressMode),this.setMasterPageExpand(!0),this.setShowMasterPageNavButton(!1),this._handleResize()):this.setMode(sap.m.SplitAppMode.HideMode);var t,e,a=this._oShowMasterBtn;null!=a&&null!=a.mEventRegistry.press&&(a.detachPress(a.mEventRegistry.press[0].fFunction),a.attachPress(this._attachPressMasterBtnEvent.bind(this))),this._oRightPage=document.getElementById(this.getId()+"-RightPage"),null!=this._oRightPage&&(t=this.getDomRef(),u.system.phone?(e=this.getAggregation("_navMaster").getDomRef(),this._oRightPage.style.visibility="hidden",e.appendChild(this._oRightPage)):t.appendChild(this._oRightPage),this.setRightPageExpand(this.getRightPageExpand()))},_renderMasterNavButton:function(){var t,e,a=this.getDomRef();a&&(this._oMasterNavBtn&&delete this._oMasterNavBtn,this._oMasterNavBtn=new sap.m.Button({visible:this.getShowMasterPageNavButton(),press:this._pressMasterNavBtn.bind(this)}).addStyleClass("u4aSplitAppMasterNavBtn"),t=sap.ui.getCore().createRenderManager(),e=this.getMasterPageExpand(),this._masterNavBtnIconChange(e),t.renderControl(this._oMasterNavBtn),t.flush(a,!1,!0))},_masterNavBtnIconChange:function(t){var e,a=this._oMasterNavBtn;null!=a&&(e="sap-icon://navigation-right-arrow",a.removeStyleClass("u4aSplitAppMasterNavBtnShow"),t&&(e="sap-icon://navigation-left-arrow",a.addStyleClass("u4aSplitAppMasterNavBtnShow")),a.setIcon(e),a.rerender())},_pressMasterNavBtn:function(t){var e=this.getMasterPageExpand();this.setMasterPageExpand(!e)},_handleResize:function(){s.prototype._handleResize.apply(this,arguments),this.getMode()==sap.m.SplitAppMode.StretchCompressMode&&this.$().hasClass("sapMSplitContainerPortrait")&&this.$().removeClass("sapMSplitContainerPortrait")},_getComputedWidth:function(t,e){if(null!=t){this._pageWidthValidCheck(e);var a,s;return g.sap.endsWith(e,"px")?(a=parseInt(e),g.sap.endsWith(t.sId,"Master")&&(a*=-1,0),s=a+"px"):(s="100%",g.sap.endsWith(t.sId,"Master")&&(a=parseInt(s),s=(a*=-1)+"%")),s}},_getMasterStyleDomId:function(){return this.getId()+"-u4aMSplitApp_masterStyle"},_getRightStyleDomId:function(){return this.getId()+"-u4aMSplitApp_rightStyle"},_setMasterAnimation:function(){var t=this._oMasterNav;if(!u.system.phone&&null!=t){var e=this.getId(),a=this.getMasterPageWidth(),s=this._getComputedWidth(t,a),i=this.getMasterPages(),p=i.length;if(0!=p){for(var r=0;r<p;r++){(l=i[r]).getVisible()||l.setVisible(!0)}if(this.getShowMasterPageNavButton()){var n=t.getDomRef();if(!n)return;var o=t.getParent().getDomRef(),h=n.cloneNode();h.style.visibility="hidden",o.appendChild(h),$(h).css("width",a);a=$(h).css("width");$(h).remove(),t.removeStyleClass("sapMSplitContainerMaster"),t.removeStyleClass("sapMSplitContainerMasterHidden"),t.removeStyleClass("u4aMSplitAppMasterHide"+e),$(n).css("width",a);s=-1*parseInt(a)+30+"px";if(0==p)return;for(var l,r=0;r<p;r++){(l=i[r]).setVisible(this.getMasterPageExpand())}}this._oShowMasterBtn.setVisible(!this.getShowMasterPageNavButton());var d=document.getElementById(this._getMasterStyleDomId());null!=d&&$(d).remove();var g=document.createElement("style");g.id=this._getMasterStyleDomId();var M=".u4aMSplitAppMaster"+e+"{";M+="width : "+a+";",M+="transition : all 300ms ease 0s !important;",M+="}",M+=".u4aMSplitAppMasterShow"+e+"{",M+="transform: translate3d(0px, 0px, 0px) !important;",M+="box-shadow: rgba(0, 0, 0, 0.15) 0px 0.625rem 1.875rem 0px, rgba(0, 0, 0, 0.15) 0px 0px 0px 1px !important;",M+="visibility: visible !important;",M+="}",M+=".u4aMSplitAppMasterHide"+e+"{",M+="transform: translate3d("+s+",0,0) !important;",M+="-webkit-transform: translate3d("+s+",0,0) !important;",M+="transition: all 300ms ease 0s !important;",M+="-webkit-transition: all 300ms ease 0s !important;",M+="box-shadow: rgba(255, 255, 255, 0) 0px 0rem 0rem 0px, rgba(255, 255, 255, 0) 0px 0px 0px 0px !important;",this.getShowMasterPageNavButton()&&(M+="box-shadow: rgba(0, 0, 0, 0.15) 0px 0.625rem 1.875rem 0px, rgba(0, 0, 0, 0.15) 0px 0px 0px 1px !important;",M+="visibility: visible !important;"),M+="}",M+=".sapUiSizeCompact .u4aSplitAppMasterNavBtn,",M+=".sapUiSizeCompact.u4aSplitAppMasterNavBtn { ",M+="padding: 0px;",M+="height: 1.5rem;",M+="width: 1.5rem;",M+="}",M+=".sapUiSizeCompact .u4aSplitAppMasterNavBtn .sapMBtnInner,",M+=".sapUiSizeCompact.u4aSplitAppMasterNavBtn .sapMBtnInner { ",M+="width: 1.5rem;",M+="min-width: 1.5rem;",M+="height: 1.5rem;",M+="}",M+=".u4aSplitAppMasterNavBtn { ",M+="position: absolute;",M+="left: 12px;",M+="top: "+this.getMasterPageNavButtonTop()+";",M+="z-index: 10;",M+="transition: all 300ms;",M+="-webkit-transition: all 300ms;",M+="}",M+=".u4aSplitAppMasterNavBtn .sapMBtnInner { ",M+="border-radius: 2rem;",M+="}",M+=".sapUiSizeCompact .u4aSplitAppMasterNavBtn .sapMBtnInner { ",M+="border-radius: 1rem;",M+="}";M+=".u4aSplitAppMasterNavBtnShow { ",M+="left: "+(Math.abs(parseInt(s))+12+"px")+";",M+="transition: all 300ms ease 0s;",M+="}",g.innerText=M,document.head.appendChild(g),t.removeStyleClass("u4aMSplitAppMaster"+e),t.removeStyleClass("u4aMSplitAppMasterShow"+e),t.removeStyleClass("u4aMSplitAppMasterHide"+e),this.getMasterPageExpand()?t.addStyleClass("u4aMSplitAppMasterShow"+e):t.addStyleClass("u4aMSplitAppMasterHide"+e),t.addStyleClass("u4aMSplitAppMaster"+e),t.addStyleClass("sapMSplitContainerMaster"),t.addStyleClass("sapMSplitContainerMasterHidden")}}},_setRightAnimation:function(){var t,e,a,s,i,p,r,n=this._oRightPage,o=this.getRightPage();null!=n&&(t=this.getRightPageWidth(),e=this._getComputedWidth(o,t),null!=(a=document.getElementById(this._getRightStyleDomId()))&&$(a).remove(),(s=document.createElement("style")).id=this._getRightStyleDomId(),p=".u4aMSplitAppRightPage"+(i=this.getId())+"{",p+="height: 100%;",p+="display: inline-block;",p+="position: absolute;",p+="z-index: 4;",p+="top: 0;",p+="box-sizing: border-box;",p+="width: "+t+";",p+="right: 0;",p+="border-left: #ebebeb;",p+="background-color: #ffffff;",p+="}",p+=".u4aMSplitAppRightShow"+i+"{",p+="transform: translate3d(0px, 0px, 0px);",p+="transition: all 300ms ease 0s;",p+="box-shadow: rgba(0, 0, 0, 0.15) 0px 0.625rem 1.875rem 0px, rgba(0, 0, 0, 0.15) 0px 0px 0px 1px;",p+="visibility: visible;",p+="}",p+=".u4aMSplitAppRightHide"+i+"{",p+="transform: translate3d("+e+",0,0);",p+="-webkit-transform: translate3d("+e+",0,0);",p+="transition: all 300ms;",p+="-webkit-transition: all 300ms;",p+="box-shadow: rgba(255, 255, 255, 0) 0px 0rem 0rem 0px, rgba(255, 255, 255, 0) 0px 0px 0px 0px;",p+="visibility: hidden;",p+="}",s.innerText=p,document.head.appendChild(s),(r=$(n)).removeClass("u4aMSplitAppRightPage"+i),r.removeClass("u4aMSplitAppRightShow"+i),r.removeClass("u4aMSplitAppRightHide"+i),r.addClass("u4aMSplitAppRightPage"+i),this.getRightPageExpand()?r.addClass("u4aMSplitAppRightShow"+i):r.addClass("u4aMSplitAppRightHide"+i))},_attachPressMasterBtnEvent:function(){this._bMasterPageExpand=!this._bMasterPageExpand,this.setMasterPageExpand(this._bMasterPageExpand)},setMasterPageFixed:function(t){u.system.phone&&(t=!0),this.setProperty("masterPageFixed",t),t?(this.setMode(sap.m.SplitAppMode.StretchCompressMode),this._handleResize()):this.setMode(sap.m.SplitAppMode.HideMode),this.setMasterPageExpand(t)},setMasterPageExpand:function(t){!u.system.phone&&this.getMode()!=sap.m.SplitAppMode.StretchCompressMode||(t=!0),this.setProperty("masterPageExpand",t,!0),this._masterNavBtnIconChange(t),this._bMasterPageExpand=t,this._setMasterAnimation()},setMasterPageWidth:function(t){this._pageWidthValidCheck(t),u.system.phone&&(t="100%"),this.setProperty("masterPageWidth",t,!0),this.setMasterPageExpand(this.getMasterPageExpand())},setRightPageWidth:function(t){this._pageWidthValidCheck(t),this.setProperty("rightPageWidth",t,!0),this.setRightPageExpand(this.getRightPageExpand())},setRightPageExpand:function(t){this.setProperty("rightPageExpand",t,!0),null!=this._oRightPage&&this._setRightAnimation()},setRightPageAutoHide:function(t){this.setProperty("rightPageAutoHide",t,!0)},_rightPageRender:function(t,e){var a=e.getId();t.write("<div"),t.addClass("u4aMSplitAppRightPage"+a),t.writeAttribute("id",a+"-RightPage"),t.writeClasses(),t.write(">"),t.renderControl(e.getRightPage()),t.write("</div>")},_pageWidthValidCheck:function(t){if(t.toLowerCase&&(t=t.toLowerCase()),!g.sap.endsWith(t,"px")&&!g.sap.endsWith(t,"%"))throw new Error("[U4AIDE] property Type Error 'rightPageWidth' : 'px' 또는 % 단위만 입력 가능합니다.")},showMaster:function(){s.prototype.showMaster.apply(this,arguments),this.setMasterPageExpand(!0)},hideMaster:function(){s.prototype.hideMaster.apply(this,arguments),this.setMasterPageExpand(!1)},ontap:function(t){var e,a,s,i,p,r,n,o,h,l,d;u.system.phone||(i=s=a=!(e=!0),p=this.getId(),r=g(t.target).closest(".sapMSplitContainerDetail, .sapMSplitContainerMaster, .u4aMSplitAppRightPage"+p),n=g(t.target).closest(".sapMPageHeader"),o=t.srcControl.getMetadata(),h=t.srcControl,l=g(h.getDomRef()).closest(".u4aSplitAppMasterNavBtn"),0<r.length&&r.hasClass("sapMSplitContainerMaster")&&(a=!0),0<l.length&&l.hasClass("u4aSplitAppMasterNavBtn")&&(a=!0),0<r.length&&r.hasClass("sapMSplitContainerDetail")&&(s=!0),0<r.length&&r.hasClass("u4aMSplitAppRightPage"+p)&&(i=!0),d=!1,s&&0<n.length&&n.hasClass("sapMPageHeader")&&(e=!(d=!0)),d&&"sap.m.Button"!=o._sClassName&&(e=!0),d&&o==sap.ui.core.Icon.getMetadata()&&t.srcControl.getParent()instanceof sap.m.Button&&(e=!1),(a||i)&&(e=!1),d&&o==sap.ui.core.Icon.getMetadata()&&t.srcControl.getParent()instanceof sap.m.Button==0&&(e=!0),this.getMode()==sap.m.SplitAppMode.StretchCompressMode&&a&&!o.getEvent("press")&&(e=!0),e&&(this.getMasterPageFixed()||this.hideMaster(),this.getRightPageAutoHide()&&this.setRightPageExpand(!1)))}})});